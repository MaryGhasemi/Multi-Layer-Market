(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    100095,       2886]
NotebookOptionsPosition[     96767,       2765]
NotebookOutlinePosition[     97104,       2780]
CellTagsIndexPosition[     97061,       2777]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "First step is to define the demands based on the prices and qualities, \
which follows the \[Theta] definition. B1 has the lowest quality in the \
market and B4 has the highest quality. In this part we assum that B1buys from \
S1 & B2, B3 and B4 buy from S2. B1 and B2 Cooperate.\nm here is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and x is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "min"], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.733851894839155*^9, 3.73385192495959*^9}, 
   3.73385313437617*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d1", " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p2", "-", "p1"}], 
    RowBox[{"q2", "-", "q1"}]], "-", "m"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "m"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]]}]], "Output",
 CellChangeTimes->{3.6839130842876863`*^9, 3.6839143594438677`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d2", " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p3", "-", "p2"}], 
    RowBox[{"q3", "-", "q2"}]], "-", 
   FractionBox[
    RowBox[{"p2", "-", "p1"}], 
    RowBox[{"q2", "-", "q1"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p1"}], "+", "p2"}], 
    RowBox[{
     RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]]}]], "Output",
 CellChangeTimes->{3.6839130897852592`*^9, 3.683914408237533*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d3", " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p4", "-", "p3"}], 
    RowBox[{"q4", "-", "q3"}]], "-", 
   FractionBox[
    RowBox[{"p3", "-", "p2"}], 
    RowBox[{"q3", "-", "q2"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p2"}], "+", "p3"}], 
    RowBox[{
     RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p3"}], "+", "p4"}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]]}]], "Output",
 CellChangeTimes->{3.683913096155663*^9, 3.683914418850443*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d4", " ", "=", " ", 
  RowBox[{"x", "-", 
   FractionBox[
    RowBox[{"p4", "-", "p3"}], 
    RowBox[{"q4", "-", "q3"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p3"}], "+", "p4"}], 
    RowBox[{
     RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", "x"}]], "Output",
 CellChangeTimes->{3.6839131018148746`*^9, 3.6839144232927227`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]1", " ", "=", " ", 
  RowBox[{
   RowBox[{"d1", "*", "p1"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r1", "*", 
      FractionBox[
       RowBox[{"q1", "*", "d1"}], "Q1"]}], "+", 
     RowBox[{"c", "*", "d1", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q1", "-", "Q1"}], ")"}], "^", "2"}]}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "m"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p1"}], "+", "p2"}], 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q1", "-", "Q1"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "m"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p1"}], "+", "p2"}], 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "m"}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.6839131080820217`*^9, 3.6839144367673273`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]2", " ", "=", " ", 
  RowBox[{
   RowBox[{"d2", "*", "p2"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r2", "*", 
      FractionBox[
       RowBox[{"q2", "*", "d2"}], "Q2"]}], "+", 
     RowBox[{"c", "*", "d2", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q2", "-", "Q2"}], ")"}], "^", "2"}]}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p2"}], "+", "p3"}], 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q2", "-", "Q2"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p2"}], "+", "p3"}], 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p1"}], "+", "p2"}], 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r2"}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.683913117827693*^9, 3.683914505778261*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]3", " ", "=", " ", 
  RowBox[{
   RowBox[{"d3", "*", "p3"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r2", "*", 
      FractionBox[
       RowBox[{"q3", "*", "d3"}], "Q2"]}], "+", 
     RowBox[{"c", "*", "d3", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q3", "-", "Q2"}], ")"}], "^", "2"}]}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p3"}], "+", "p4"}], 
      RowBox[{
       RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p3"}], "+", "p4"}], 
      RowBox[{
       RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p2"}], "+", "p3"}], 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p3"}], "+", "p4"}], 
       RowBox[{
        RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}], " ", "r2"}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.683913123527906*^9, 3.683914516115055*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]4", " ", "=", " ", 
  RowBox[{
   RowBox[{"d4", "*", "p4"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r2", "*", 
      FractionBox[
       RowBox[{"q4", "*", "d4"}], "Q2"]}], "+", 
     RowBox[{"c", "*", "d4", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q4", "-", "Q2"}], ")"}], "^", "2"}]}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p3"}], "+", "p4"}], 
       RowBox[{
        RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", "x"}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p3"}], "+", "p4"}], 
       RowBox[{
        RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", "x"}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q4", " ", "r2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p3"}], "+", "p4"}], 
        RowBox[{
         RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", "x"}], ")"}]}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.6839131297057056`*^9, 3.683914530394162*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p1"], 
  RowBox[{"(", 
   RowBox[{"\[CapitalPi]1", "+", "\[CapitalPi]2"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.6839131417129383`*^9, 3.683913150114625*^9}, 
   3.6839145444163027`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "m"}], "-", 
  FractionBox["p1", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox["p2", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{"q1", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"q2", " ", "r2"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}]]}]], "Output",
 CellChangeTimes->{3.683913151474019*^9, 3.6839145550439034`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p2"], 
  RowBox[{"(", 
   RowBox[{"\[CapitalPi]1", "+", "\[CapitalPi]2"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.683913159745482*^9, 3.683913160113265*^9}, 
   3.68391456353622*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["p1", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
  RowBox[{"p2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q2", "-", "Q2"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q1", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r2"}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.683913162071562*^9, 3.6839145682160053`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p3"], "\[CapitalPi]3"}]], "Input",
 CellChangeTimes->{{3.6839131724972353`*^9, 3.6839131752170897`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p2"}], "+", "p3"}], 
    RowBox[{
     RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p3"}], "+", "p4"}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "+", 
  RowBox[{"p3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}], " ", "r2"}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.6839131770111732`*^9, 3.683914578178608*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p4"], "\[CapitalPi]4"}]], "Input",
 CellChangeTimes->{{3.6839131876338243`*^9, 3.683913189281786*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["p4", 
    RowBox[{
     RowBox[{"-", "q3"}], "+", "q4"}]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p3"}], "+", "p4"}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "+", 
  FractionBox[
   RowBox[{"q4", " ", "r2"}], 
   RowBox[{"Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]], "+", "x"}]], "Output",
 CellChangeTimes->{3.683913193451322*^9, 3.683914582133226*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"%12", "\[Equal]", "0"}], "&&", 
     RowBox[{"%11", "\[Equal]", "0"}], "&&", 
     RowBox[{"%10", "\[Equal]", "0"}], "&&", 
     RowBox[{"%9", "\[Equal]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"%9", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "p1"], 
      RowBox[{"(", 
       RowBox[{"\[CapitalPi]1", "+", "\[CapitalPi]2"}], ")"}]}]}], ",", " ", "...",
     ",", " ", 
    RowBox[{"%12", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "p4"], "\[CapitalPi]4"}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.683913197123445*^9, 3.683913233986562*^9}, {
  3.733851936919405*^9, 3.733851970600721*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["2", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}], ")"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["2", 
                   RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                 FractionBox["2", 
                  RowBox[{
                   RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}], "2"]]}], "-", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], 
                  RowBox[{
                   RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}]}], ")"}]}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "m"}], "+", 
             FractionBox[
              RowBox[{"c", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
              RowBox[{
               RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
             FractionBox[
              RowBox[{"c", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], 
              RowBox[{
               RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
             FractionBox[
              RowBox[{"q1", " ", "r1"}], 
              RowBox[{"Q1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"q2", " ", "r2"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}]]}], 
            ")"}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}]], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}], "2"]]}], "-", 
                  FractionBox[
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], 
                   RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{"c", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
                   RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                 RowBox[{"c", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"q2", "-", "Q2"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
                 FractionBox[
                  RowBox[{"q1", " ", "r1"}], 
                  RowBox[{"Q1", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "-", 
                 FractionBox[
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r2"}], 
                  "Q2"]}], ")"}]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "c"}], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
                    FractionBox[
                    RowBox[{"q3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}], " ", "r2"}], 
                    "Q2"]}], ")"}]}], 
                  RowBox[{
                   RowBox[{"-", "q3"}], "+", "q4"}]]}], "-", 
                FractionBox[
                 RowBox[{
                  FractionBox[
                   RowBox[{"c", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"]}], 
                   RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]], "+", 
                  FractionBox[
                   RowBox[{"q4", " ", "r2"}], 
                   RowBox[{"Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]], "+", "x"}], 
                 RowBox[{
                  RowBox[{"-", "q3"}], "+", "q4"}]]}], 
               RowBox[{
                RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}]}]}], ")"}], "/", 
        
        RowBox[{"(", 
         RowBox[{
          FractionBox["12", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "q3"}], "+", "q4"}], ")"}], "2"]}]], "+", 
          FractionBox["12", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "q2"}], "+", "q3"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]]}], ")"}]}], 
       ")"}]}]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"6", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "m", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
         RowBox[{"3", " ", "c", " ", 
          SuperscriptBox["q2", "3"], " ", "Q2"}], "+", 
         RowBox[{"6", " ", "c", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["Q2", "2"]}], "-", 
         RowBox[{"6", " ", "c", " ", "q2", " ", 
          SuperscriptBox["Q2", "3"]}], "+", 
         RowBox[{"2", " ", "m", " ", "q2", " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"6", " ", "c", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
         RowBox[{"m", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"2", " ", "c", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"4", " ", "m", " ", "q2", " ", "Q2", " ", "q4"}], "+", 
         RowBox[{"4", " ", "c", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4"}], "-", 
         RowBox[{"6", " ", "c", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
         RowBox[{"6", " ", "c", " ", 
          SuperscriptBox["Q2", "3"], " ", "q4"}], "-", 
         RowBox[{"4", " ", "m", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
         RowBox[{"6", " ", "c", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3", " ", "q4"}], "+", 
         RowBox[{"2", " ", "c", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
         RowBox[{"c", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q4", "2"]}], "+", 
         RowBox[{"c", " ", "Q2", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["q2", "2"], " ", "r2"}], "-", 
         RowBox[{"3", " ", "q2", " ", "q3", " ", "r2"}], "+", 
         RowBox[{"3", " ", "q2", " ", "q4", " ", "r2"}], "+", 
         RowBox[{"3", " ", "q3", " ", "q4", " ", "r2"}], "+", 
         RowBox[{"q2", " ", "Q2", " ", "q3", " ", "x"}], "-", 
         RowBox[{"Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "x"}], "-", 
         RowBox[{"q2", " ", "Q2", " ", "q4", " ", "x"}], "+", 
         RowBox[{"Q2", " ", "q3", " ", "q4", " ", "x"}]}], ")"}]}]}]}], ",", 
    RowBox[{"p3", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"3", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "c", " ", "q2", " ", 
          SuperscriptBox["Q2", "3"]}], "-", 
         RowBox[{"m", " ", "q2", " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"6", " ", "c", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
         RowBox[{"m", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"2", " ", "c", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"m", " ", "q2", " ", "Q2", " ", "q4"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4"}], "+", 
         RowBox[{"3", " ", "c", " ", 
          SuperscriptBox["Q2", "3"], " ", "q4"}], "-", 
         RowBox[{"m", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
         RowBox[{"6", " ", "c", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3", " ", "q4"}], "+", 
         RowBox[{"2", " ", "c", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
         RowBox[{"c", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q4", "2"]}], "+", 
         RowBox[{"c", " ", "Q2", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"3", " ", "q2", " ", "q3", " ", "r2"}], "+", 
         RowBox[{"3", " ", "q3", " ", "q4", " ", "r2"}], "+", 
         RowBox[{"q2", " ", "Q2", " ", "q3", " ", "x"}], "-", 
         RowBox[{"Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "x"}], "-", 
         RowBox[{"q2", " ", "Q2", " ", "q4", " ", "x"}], "+", 
         RowBox[{"Q2", " ", "q3", " ", "q4", " ", "x"}]}], ")"}]}]}]}], ",", 
    RowBox[{"p4", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"6", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q4"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", "c", " ", "q2", " ", 
          SuperscriptBox["Q2", "3"]}], "+", 
         RowBox[{"m", " ", "q2", " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"6", " ", "c", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "-", 
         RowBox[{"m", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"2", " ", "c", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"m", " ", "q2", " ", "Q2", " ", "q4"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4"}], "-", 
         RowBox[{"6", " ", "c", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q4"}], "-", 
         RowBox[{"6", " ", "c", " ", 
          SuperscriptBox["Q2", "3"], " ", "q4"}], "+", 
         RowBox[{"m", " ", "Q2", " ", "q3", " ", "q4"}], "+", 
         RowBox[{"6", " ", "c", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3", " ", "q4"}], "-", 
         RowBox[{"2", " ", "c", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
         RowBox[{"4", " ", "c", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q4", "2"]}], "+", 
         RowBox[{"6", " ", "c", " ", 
          SuperscriptBox["Q2", "2"], " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"c", " ", "Q2", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"3", " ", "c", " ", "Q2", " ", 
          SuperscriptBox["q4", "3"]}], "+", 
         RowBox[{"3", " ", "q2", " ", "q3", " ", "r2"}], "+", 
         RowBox[{"3", " ", "q2", " ", "q4", " ", "r2"}], "-", 
         RowBox[{"3", " ", "q3", " ", "q4", " ", "r2"}], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["q4", "2"], " ", "r2"}], "-", 
         RowBox[{"4", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
         RowBox[{"Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "x"}], "+", 
         RowBox[{"4", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], "+", 
         RowBox[{"2", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}], "-", 
         RowBox[{"3", " ", "Q2", " ", 
          SuperscriptBox["q4", "2"], " ", "x"}]}], ")"}]}]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.683913251866476*^9, 3.683914613088872*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U1", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"(", 
       RowBox[{"d1", "*", 
        RowBox[{"q1", "/", "Q1"}]}], ")"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"r1", "-", "k1"}], ")"}]}], "-", 
    RowBox[{"e", "*", 
     RowBox[{"Q1", "^", "2"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "\[Rule]", "%15"}], ",", 
     RowBox[{"p2", "\[Rule]", "%17"}], ",", 
     RowBox[{"p3", "\[Rule]", "%19"}], ",", 
     RowBox[{"p4", "\[Rule]", "%21"}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "e"}], " ", 
   SuperscriptBox["Q1", "2"]}], "+", 
  RowBox[{
   FractionBox["1", "Q1"], 
   RowBox[{"q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "k1"}], "+", "r1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "m"}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{"6", " ", "Q2", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", " ", "Q2", " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
               RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
            RowBox[{"c", " ", "Q2", " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q4"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", " ", 
                SuperscriptBox["q2", "2"]}], "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["Q2", "2"]}], "-", 
               RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
               RowBox[{"q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "6"}], " ", "Q2"}], "+", "q3", "-", "q4"}], 
                 ")"}]}], "+", 
               RowBox[{"q3", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], 
            "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["q2", "2"], " ", "r2"}], "+", 
            RowBox[{"3", " ", "q2", " ", "q3", " ", "r2"}], "-", 
            RowBox[{"3", " ", "q2", " ", "q4", " ", "r2"}], "-", 
            RowBox[{"3", " ", "q3", " ", "q4", " ", "r2"}], "-", 
            RowBox[{"q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
            RowBox[{"Q2", " ", 
             SuperscriptBox["q3", "2"], " ", "x"}], "+", 
            RowBox[{"q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
            RowBox[{"Q2", " ", "q3", " ", "q4", " ", "x"}]}], ")"}]}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "m"}], " ", "Q1", " ", "Q2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", "q1", " ", "q2"}], "+", 
               RowBox[{"2", " ", "q2", " ", "q3"}], "+", 
               SuperscriptBox["q3", "2"], "+", 
               RowBox[{"3", " ", "q1", " ", "q4"}], "+", 
               RowBox[{"q2", " ", "q4"}], "-", 
               RowBox[{"4", " ", "q3", " ", "q4"}]}], ")"}]}], "+", 
            RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q4"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", " ", 
                SuperscriptBox["q1", "2"]}], "-", 
               RowBox[{"6", " ", "q1", " ", "Q1"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["Q1", "2"]}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["Q2", "2"]}], "+", 
               RowBox[{"q2", " ", "q3"}], "-", 
               RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["q3", "2"]}], "-", 
               RowBox[{"q2", " ", "q4"}], "+", 
               RowBox[{"q3", " ", "q4"}]}], ")"}]}], "+", 
            RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "-", 
            RowBox[{"3", " ", "q1", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
            RowBox[{"3", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "-", 
            RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "-", 
            RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
            RowBox[{"Q1", " ", "Q2", " ", 
             SuperscriptBox["q3", "2"], " ", "x"}], "+", 
            RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
            RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.6839134254652157`*^9, 3.683914746450404*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "U1", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SuperscriptBox["Q1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "e", " ", 
     SuperscriptBox["Q1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], "+", 
    RowBox[{"q1", " ", "r1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], "+", 
       RowBox[{"c", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q1", "2"], "-", 
          RowBox[{"2", " ", "q1", " ", "Q1"}], "+", 
          SuperscriptBox["Q1", "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], ")"}], " ", "Q2"}], "+", 
       RowBox[{"q1", " ", "Q2", " ", "r1"}], "-", 
       RowBox[{"Q1", " ", "q2", " ", "r2"}]}], ")"}]}], "+", 
    RowBox[{"k1", " ", "q1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}], "+", 
       RowBox[{"c", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["q1", "2"]}], "+", 
          RowBox[{"2", " ", "q1", " ", "Q1"}], "-", 
          SuperscriptBox["Q1", "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], ")"}], " ", "Q2"}], "-", 
       RowBox[{"q1", " ", "Q2", " ", "r1"}], "+", 
       RowBox[{"Q1", " ", "q2", " ", "r2"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6839147507698307`*^9, 3.6839149224752283`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U2", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d2", "*", 
         RowBox[{"q2", "/", "Q2"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"d3", "*", 
         RowBox[{"q3", "/", "Q2"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"d4", "*", 
         RowBox[{"q4", "/", "Q2"}]}], ")"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"r2", "-", "k2"}], ")"}]}], "-", 
    RowBox[{"e", "*", 
     RowBox[{"Q2", "^", "2"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "\[Rule]", "%15"}], ",", 
     RowBox[{"p2", "\[Rule]", "%17"}], ",", 
     RowBox[{"p3", "\[Rule]", "%19"}], ",", 
     RowBox[{"p4", "\[Rule]", "%21"}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "e"}], " ", 
   SuperscriptBox["Q2", "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "k2"}], "+", "r2"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "Q2"], 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"-", "q2"}], "+", "q3"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", 
              RowBox[{"3", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["q2", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    SuperscriptBox["q4", "2"]}], ")"}]}], "-", 
                  RowBox[{"q4", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
                    RowBox[{"q3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"3", " ", "q2", " ", "q3", " ", "r2"}], "-", 
               RowBox[{"3", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
               RowBox[{"Q2", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}], "+", 
               RowBox[{"q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
               RowBox[{"Q2", " ", "q3", " ", "q4", " ", "x"}]}], ")"}]}], "-", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                  RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   SuperscriptBox["q2", "2"]}], "+", 
                  RowBox[{"6", " ", 
                   SuperscriptBox["Q2", "2"]}], "-", 
                  RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], " ", "Q2"}], "+", "q3", "-", "q4"}], 
                    ")"}]}], "+", 
                  RowBox[{"q3", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["q2", "2"], " ", "r2"}], "+", 
               RowBox[{"3", " ", "q2", " ", "q3", " ", "r2"}], "-", 
               RowBox[{"3", " ", "q2", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
               RowBox[{"Q2", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}], "+", 
               RowBox[{"q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
               RowBox[{"Q2", " ", "q3", " ", "q4", " ", "x"}]}], ")"}]}]}], 
           ")"}]}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"-", "q1"}], "+", "q2"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                  RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   SuperscriptBox["q2", "2"]}], "+", 
                  RowBox[{"6", " ", 
                   SuperscriptBox["Q2", "2"]}], "-", 
                  RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], " ", "Q2"}], "+", "q3", "-", "q4"}], 
                    ")"}]}], "+", 
                  RowBox[{"q3", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["q2", "2"], " ", "r2"}], "+", 
               RowBox[{"3", " ", "q2", " ", "q3", " ", "r2"}], "-", 
               RowBox[{"3", " ", "q2", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
               RowBox[{"Q2", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}], "+", 
               RowBox[{"q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
               RowBox[{"Q2", " ", "q3", " ", "q4", " ", "x"}]}], ")"}]}], "-", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "m"}], " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "3"}], " ", "q1", " ", "q2"}], "+", 
                  RowBox[{"2", " ", "q2", " ", "q3"}], "+", 
                  SuperscriptBox["q3", "2"], "+", 
                  RowBox[{"3", " ", "q1", " ", "q4"}], "+", 
                  RowBox[{"q2", " ", "q4"}], "-", 
                  RowBox[{"4", " ", "q3", " ", "q4"}]}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   SuperscriptBox["q1", "2"]}], "-", 
                  RowBox[{"6", " ", "q1", " ", "Q1"}], "+", 
                  RowBox[{"3", " ", 
                   SuperscriptBox["Q1", "2"]}], "+", 
                  RowBox[{"3", " ", 
                   SuperscriptBox["Q2", "2"]}], "+", 
                  RowBox[{"q2", " ", "q3"}], "-", 
                  RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["q3", "2"]}], "-", 
                  RowBox[{"q2", " ", "q4"}], "+", 
                  RowBox[{"q3", " ", "q4"}]}], ")"}]}], "+", 
               RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "-", 
               RowBox[{"3", " ", "q1", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
               RowBox[{"3", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "-", 
               RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
               RowBox[{"Q1", " ", "Q2", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}], "+", 
               RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
               RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
              ")"}]}]}], ")"}]}]}], ")"}]}]}], "+", 
     RowBox[{
      FractionBox["1", "Q2"], 
      RowBox[{"q4", " ", 
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"-", "q3"}], "+", "q4"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"3", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                RowBox[{"c", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["q2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                   RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    SuperscriptBox["q4", "2"]}], ")"}]}], "-", 
                   RowBox[{"q4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
                    RowBox[{"q3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                RowBox[{"3", " ", "q2", " ", "q3", " ", "r2"}], "-", 
                RowBox[{"3", " ", "q3", " ", "q4", " ", "r2"}], "-", 
                RowBox[{"q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
                RowBox[{"Q2", " ", 
                 SuperscriptBox["q3", "2"], " ", "x"}], "+", 
                RowBox[{"q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
                RowBox[{"Q2", " ", "q3", " ", "q4", " ", "x"}]}], ")"}]}]}], 
            "+", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["q2", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "-", 
                  RowBox[{"q4", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"6", " ", 
                    SuperscriptBox["Q2", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    RowBox[{"q3", " ", "q4"}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["q4", "2"]}], "-", 
                    RowBox[{"6", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "+", "q4"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "+", 
                    SuperscriptBox["q3", "2"], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q4", "2"]}], "-", 
                    RowBox[{"3", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "+", "q4"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
               "+", 
               RowBox[{"3", " ", "q2", " ", "q3", " ", "r2"}], "+", 
               RowBox[{"3", " ", "q2", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", 
                SuperscriptBox["q4", "2"], " ", "r2"}], "-", 
               RowBox[{"4", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
               
               RowBox[{"Q2", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}], "+", 
               RowBox[{"4", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], "+", 
               
               RowBox[{"2", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}], "-", 
               
               RowBox[{"3", " ", "Q2", " ", 
                SuperscriptBox["q4", "2"], " ", "x"}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], "+", 
     RowBox[{
      FractionBox["1", "Q2"], 
      RowBox[{"q3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           FractionBox["1", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", 
               RowBox[{"3", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                RowBox[{"c", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["q2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                   RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    SuperscriptBox["q4", "2"]}], ")"}]}], "-", 
                   RowBox[{"q4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
                    RowBox[{"q3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                RowBox[{"3", " ", "q2", " ", "q3", " ", "r2"}], "-", 
                RowBox[{"3", " ", "q3", " ", "q4", " ", "r2"}], "-", 
                RowBox[{"q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
                RowBox[{"Q2", " ", 
                 SuperscriptBox["q3", "2"], " ", "x"}], "+", 
                RowBox[{"q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
                RowBox[{"Q2", " ", "q3", " ", "q4", " ", "x"}]}], ")"}]}], 
             "-", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"6", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                   RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
                RowBox[{"c", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q4"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", " ", 
                    SuperscriptBox["q2", "2"]}], "+", 
                   RowBox[{"6", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                   RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
                   RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], " ", "Q2"}], "+", "q3", "-", "q4"}], 
                    ")"}]}], "+", 
                   RowBox[{"q3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}],
                 "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["q2", "2"], " ", "r2"}], "+", 
                RowBox[{"3", " ", "q2", " ", "q3", " ", "r2"}], "-", 
                RowBox[{"3", " ", "q2", " ", "q4", " ", "r2"}], "-", 
                RowBox[{"3", " ", "q3", " ", "q4", " ", "r2"}], "-", 
                RowBox[{"q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
                RowBox[{"Q2", " ", 
                 SuperscriptBox["q3", "2"], " ", "x"}], "+", 
                RowBox[{"q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
                RowBox[{"Q2", " ", "q3", " ", "q4", " ", "x"}]}], ")"}]}]}], 
            ")"}]}]}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"-", "q3"}], "+", "q4"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"3", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                RowBox[{"c", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["q2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                   RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    SuperscriptBox["q4", "2"]}], ")"}]}], "-", 
                   RowBox[{"q4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"6", " ", "Q2", " ", "q3"}], "+", 
                    RowBox[{"q3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                RowBox[{"3", " ", "q2", " ", "q3", " ", "r2"}], "-", 
                RowBox[{"3", " ", "q3", " ", "q4", " ", "r2"}], "-", 
                RowBox[{"q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
                RowBox[{"Q2", " ", 
                 SuperscriptBox["q3", "2"], " ", "x"}], "+", 
                RowBox[{"q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
                RowBox[{"Q2", " ", "q3", " ", "q4", " ", "x"}]}], ")"}]}]}], 
            "+", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["q2", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "-", 
                  RowBox[{"q4", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"6", " ", 
                    SuperscriptBox["Q2", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    RowBox[{"q3", " ", "q4"}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["q4", "2"]}], "-", 
                    RowBox[{"6", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "+", "q4"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "+", 
                    SuperscriptBox["q3", "2"], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q4", "2"]}], "-", 
                    RowBox[{"3", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "+", "q4"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
               "+", 
               RowBox[{"3", " ", "q2", " ", "q3", " ", "r2"}], "+", 
               RowBox[{"3", " ", "q2", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", 
                SuperscriptBox["q4", "2"], " ", "r2"}], "-", 
               RowBox[{"4", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
               
               RowBox[{"Q2", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}], "+", 
               RowBox[{"4", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], "+", 
               
               RowBox[{"2", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}], "-", 
               
               RowBox[{"3", " ", "Q2", " ", 
                SuperscriptBox["q4", "2"], " ", "x"}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.683913443547245*^9, 3.683914927389539*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "U2", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "Q1", " ", 
    RowBox[{"(", 
     RowBox[{"q1", "-", "q2"}], ")"}], " ", 
    SuperscriptBox["Q2", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "e", " ", "Q1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
     SuperscriptBox["Q2", "4"]}], "+", 
    RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["q1", "2"], " ", "q2"}], "+", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q1", "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Q2", "-", "q4"}], ")"}], "2"]}], ")"}]}], "+", 
       RowBox[{"q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "Q1", " ", "q2"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"q2", "-", "q4"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", 
             RowBox[{"2", " ", "Q2"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
      ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"k2", "-", "r2"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"k2", "-", "r2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", "q3"}], "+", 
       RowBox[{"Q1", " ", "q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "q4"}], " ", "r2"}], "+", 
          RowBox[{"Q2", " ", "q3", " ", "x"}], "+", 
          RowBox[{"Q2", " ", "q4", " ", "x"}]}], ")"}]}], "+", 
       RowBox[{"q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q2", " ", "Q2", " ", "r1"}], "-", 
          RowBox[{"Q1", " ", "q2", " ", "r2"}], "+", 
          RowBox[{"Q1", " ", "q4", " ", "r2"}], "-", 
          RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "x"}], "-", 
          RowBox[{"Q1", " ", "Q2", " ", "q4", " ", "x"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6839149357710733`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "r1"], "%30", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"%30", " ", ":", " ", 
    RowBox[{"Simplify", "[", "U1", "]"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6839149461173067`*^9, 3.683914947110324*^9}, {
  3.73385198318497*^9, 3.7338520069699574`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "k1"}], " ", 
    SuperscriptBox["q1", "2"], " ", "Q2"}], "+", 
   RowBox[{
    SuperscriptBox["q1", "2"], " ", "Q2", " ", "r1"}], "+", 
   RowBox[{"q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"m", " ", "Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], "+", 
      RowBox[{"c", " ", "Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q1", "2"], "-", 
         RowBox[{"2", " ", "q1", " ", "Q1"}], "+", 
         SuperscriptBox["Q1", "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], ")"}], " ", "Q2"}], "+", 
      
      RowBox[{"q1", " ", "Q2", " ", "r1"}], "-", 
      RowBox[{"Q1", " ", "q2", " ", "r2"}]}], ")"}]}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["Q1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]]], "Output",
 CellChangeTimes->{3.683913554291011*^9, 3.683914955420638*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "r2"], "%32", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"%32", " ", ":", " ", 
    RowBox[{"Simplify", "[", "U2", "]"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.683914960102159*^9, 3.683914963892705*^9}, {
  3.733852012090518*^9, 3.733852031290098*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "Q1", " ", 
    RowBox[{"(", 
     RowBox[{"q1", "-", "q2"}], ")"}], " ", 
    SuperscriptBox["Q2", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "m"}], " ", "Q1", " ", 
     RowBox[{"(", 
      RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", "q3"}], "-", 
    RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["q1", "2"], " ", "q2"}], "+", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q1", "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Q2", "-", "q4"}], ")"}], "2"]}], ")"}]}], "+", 
       RowBox[{"q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "Q1", " ", "q2"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"q2", "-", "q4"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", 
             RowBox[{"2", " ", "Q2"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Q1"}], " ", "q2", " ", "q4"}], "+", 
       RowBox[{"q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Q1"}], " ", "q2"}], "+", 
          RowBox[{"Q1", " ", "q4"}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"k2", "-", "r2"}], ")"}]}], "-", 
    RowBox[{"Q1", " ", "q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "q4"}], " ", "r2"}], "+", 
       RowBox[{"Q2", " ", "q3", " ", "x"}], "+", 
       RowBox[{"Q2", " ", "q4", " ", "x"}]}], ")"}]}], "-", 
    RowBox[{"q1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q2", " ", "Q2", " ", "r1"}], "-", 
       RowBox[{"Q1", " ", "q2", " ", "r2"}], "+", 
       RowBox[{"Q1", " ", "q4", " ", "r2"}], "-", 
       RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "x"}], "-", 
       RowBox[{"Q1", " ", "Q2", " ", "q4", " ", "x"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.683913564819023*^9, 3.683914965911242*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"%33", "\[Equal]", "0"}], "&&", 
     RowBox[{"%34", "\[Equal]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r1", ",", "r2"}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{"%33", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "r1"], "U1"}]}], ",", " ", 
    RowBox[{"%34", " ", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "r2"], "U2"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6839135709515333`*^9, 3.683913607929092*^9}, {
  3.6839149703113613`*^9, 3.683914976133041*^9}, {3.683915040550511*^9, 
  3.683915042950366*^9}, {3.733852034898135*^9, 3.7338520722433558`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"r1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"k1", " ", 
                 SuperscriptBox["q1", "2"]}], 
                RowBox[{"2", " ", 
                 SuperscriptBox["Q1", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "q2"}], ")"}]}]]}], "+", 
              FractionBox[
               RowBox[{"m", " ", "q1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
               RowBox[{"2", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q2"}], ")"}]}]], "+", 
              FractionBox[
               RowBox[{"c", " ", "q1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["q1", "2"], "-", 
                  RowBox[{"2", " ", "q1", " ", "Q1"}], "+", 
                  SuperscriptBox["Q1", "2"], "-", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], ")"}]}], 
               RowBox[{"2", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q2"}], ")"}]}]]}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"q1", " ", "q2"}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q2"}], ")"}], " ", 
               SuperscriptBox["Q2", "2"]}]], "-", 
             FractionBox[
              RowBox[{"q1", " ", "q4"}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q2"}], ")"}], " ", 
               SuperscriptBox["Q2", "2"]}]], "+", 
             FractionBox[
              RowBox[{"q2", " ", "q4"}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q2"}], ")"}], " ", 
               SuperscriptBox["Q2", "2"]}]], "-", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "Q1"}], " ", "q2", " ", "q4"}], "+", 
               RowBox[{"q1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "Q1"}], " ", "q2"}], "+", 
                  RowBox[{"Q1", " ", "q4"}]}], ")"}]}]}], 
              RowBox[{"2", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q2"}], ")"}], " ", 
               SuperscriptBox["Q2", "2"]}]]}], ")"}]}], "-", 
          FractionBox[
           RowBox[{"q1", " ", "q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"m", " ", "q3"}], 
                RowBox[{"2", " ", "Q2"}]]}], "+", 
              FractionBox[
               RowBox[{"k2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "Q1"}], " ", "q2", " ", "q4"}], "+", 
                  RowBox[{"q1", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Q1"}], " ", "q2"}], "+", 
                    RowBox[{"Q1", " ", "q4"}]}], ")"}]}]}], ")"}]}], 
               RowBox[{"2", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q2"}], ")"}], " ", 
                SuperscriptBox["Q2", "2"]}]], "-", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["q1", "2"], " ", "q2"}], "+", 
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["Q1", "2"], "-", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"Q2", "-", "q4"}], ")"}], "2"]}], ")"}]}], "+", 
                  RowBox[{"q1", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "Q1", " ", "q2"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"q2", "-", "q4"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "-", 
                    RowBox[{"2", " ", "Q2"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], "+", 
              FractionBox[
               RowBox[{"q1", " ", "q3", " ", "x"}], 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], "-", 
              FractionBox[
               RowBox[{"q2", " ", "q3", " ", "x"}], 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], "+", 
              FractionBox[
               RowBox[{"q1", " ", "q4", " ", "x"}], 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], "-", 
              FractionBox[
               RowBox[{"q2", " ", "q4", " ", "x"}], 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]]}], ")"}]}], 
           RowBox[{"2", " ", "Q1", " ", 
            RowBox[{"(", 
             RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["q1", "3"], " ", "q2"}], 
            RowBox[{
             SuperscriptBox["Q1", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"q1", "-", "q2"}], ")"}], "2"], " ", 
             SuperscriptBox["Q2", "2"]}]]}], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["q1", "2"], " ", 
            SuperscriptBox["q2", "2"]}], 
           RowBox[{"4", " ", 
            SuperscriptBox["Q1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"q1", "-", "q2"}], ")"}], "2"], " ", 
            SuperscriptBox["Q2", "2"]}]], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["q1", "3"], " ", "q4"}], 
           RowBox[{
            SuperscriptBox["Q1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"q1", "-", "q2"}], ")"}], "2"], " ", 
            SuperscriptBox["Q2", "2"]}]], "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["q1", "2"], " ", "q2", " ", "q4"}], 
           RowBox[{
            SuperscriptBox["Q1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"q1", "-", "q2"}], ")"}], "2"], " ", 
            SuperscriptBox["Q2", "2"]}]]}], ")"}]}], ")"}]}]}], ",", 
    RowBox[{"r2", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"Q1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "q1", " ", "q2"}], "+", 
           SuperscriptBox["q2", "2"], "+", 
           RowBox[{"4", " ", "q1", " ", "q4"}], "-", 
           RowBox[{"4", " ", "q2", " ", "q4"}]}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "k2", " ", "q1", " ", "Q1", " ", "q2"}], "+", 
         RowBox[{"k1", " ", "q1", " ", "q2", " ", "Q2"}], "+", 
         RowBox[{"m", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["q1", "2"], " ", "Q1", " ", "q2", " ", "Q2"}], "-", 
         RowBox[{"2", " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["Q1", "3"], " ", "q2", " ", "Q2"}], "-", 
         RowBox[{"m", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
         RowBox[{"2", " ", "c", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "3"], " ", "Q2"}], "+", 
         RowBox[{"4", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"]}], "-", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["Q2", "2"]}], "-", 
         RowBox[{"c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "3"]}], "+", 
         RowBox[{"2", " ", "m", " ", "q1", " ", "Q1", " ", "Q2", " ", "q3"}], 
         "-", 
         RowBox[{"2", " ", "m", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3"}], 
         "-", 
         RowBox[{"2", " ", "k2", " ", "q1", " ", "Q1", " ", "q4"}], "+", 
         RowBox[{"2", " ", "k2", " ", "Q1", " ", "q2", " ", "q4"}], "-", 
         RowBox[{"4", " ", "c", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
         RowBox[{"2", " ", "c", " ", "q1", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"2", " ", "q1", " ", "Q1", " ", "Q2", " ", "q3", " ", "x"}], 
         "+", 
         RowBox[{"2", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], 
         "-", 
         RowBox[{"2", " ", "q1", " ", "Q1", " ", "Q2", " ", "q4", " ", "x"}], 
         "+", 
         RowBox[{
         "2", " ", "Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}]}], 
        ")"}]}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.683915046900628*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finding the equatins for price constraints: ", "Subtitle",
 CellChangeTimes->{{3.7338521564372187`*^9, 3.733852176845945*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%33", "\[Equal]", "0"}], ",", "r1"}], "]"}]], "Input",
 CellChangeTimes->{{3.683915225594721*^9, 3.683915227017318*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"k1", " ", "q1", " ", "Q2"}], "+", 
      RowBox[{"m", " ", "q1", " ", "Q1", " ", "Q2"}], "-", 
      RowBox[{"c", " ", 
       SuperscriptBox["q1", "2"], " ", "Q1", " ", "Q2"}], "+", 
      RowBox[{"2", " ", "c", " ", "q1", " ", 
       SuperscriptBox["Q1", "2"], " ", "Q2"}], "-", 
      RowBox[{"c", " ", 
       SuperscriptBox["Q1", "3"], " ", "Q2"}], "-", 
      RowBox[{"m", " ", "Q1", " ", "q2", " ", "Q2"}], "+", 
      RowBox[{"c", " ", "Q1", " ", 
       SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
      RowBox[{"2", " ", "c", " ", "Q1", " ", "q2", " ", 
       SuperscriptBox["Q2", "2"]}], "+", 
      RowBox[{"c", " ", "Q1", " ", 
       SuperscriptBox["Q2", "3"]}], "+", 
      RowBox[{"Q1", " ", "q2", " ", "r2"}]}], 
     RowBox[{"2", " ", "q1", " ", "Q2"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6839137494801064`*^9, 3.683915234243142*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.683915182841379*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q2", "*", 
    RowBox[{"r2", "/", "Q2"}]}], "+", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q2"}], ")"}], "^", "2"}]}], "-", 
   RowBox[{"q2", "*", 
    RowBox[{"r1", "/", "Q1"}]}], "-", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q1"}], ")"}], "^", "2"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", "%45"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.683915371547937*^9, 3.6839153717073307`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "c"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"]}], "+", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q2", " ", "r2"}], "Q2"], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k1", " ", "q1", " ", "Q2"}], "+", 
      RowBox[{"Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["q1", "2"]}], "+", 
            RowBox[{"2", " ", "q1", " ", "Q1"}], "-", 
            SuperscriptBox["Q1", "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], ")"}], " ", "Q2"}], 
         "+", 
         RowBox[{"q2", " ", "r2"}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"2", " ", "q1", " ", "Q1", " ", "Q2"}]]}]], "Output",
 CellChangeTimes->{3.683915373166113*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%46", "\[Equal]", "0"}], ",", "r2"}], "]"}]], "Input",
 CellChangeTimes->{{3.683915396222352*^9, 3.683915419997079*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", 
    FractionBox[
     RowBox[{"Q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "c", " ", "q1", " ", 
         SuperscriptBox["Q1", "3"]}], "-", 
        RowBox[{"k1", " ", "q1", " ", "q2"}], "-", 
        RowBox[{"m", " ", "q1", " ", "Q1", " ", "q2"}], "+", 
        RowBox[{"c", " ", 
         SuperscriptBox["q1", "2"], " ", "Q1", " ", "q2"}], "+", 
        RowBox[{"2", " ", "c", " ", "q1", " ", 
         SuperscriptBox["Q1", "2"], " ", "q2"}], "+", 
        RowBox[{"c", " ", 
         SuperscriptBox["Q1", "3"], " ", "q2"}], "+", 
        RowBox[{"m", " ", "Q1", " ", 
         SuperscriptBox["q2", "2"]}], "-", 
        RowBox[{"c", " ", "Q1", " ", 
         SuperscriptBox["q2", "3"]}], "-", 
        RowBox[{"4", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2"}], 
        "+", 
        RowBox[{"2", " ", "c", " ", "Q1", " ", 
         SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
        RowBox[{"2", " ", "c", " ", "q1", " ", "Q1", " ", 
         SuperscriptBox["Q2", "2"]}], "-", 
        RowBox[{"c", " ", "Q1", " ", "q2", " ", 
         SuperscriptBox["Q2", "2"]}]}], ")"}]}], 
     RowBox[{"Q1", " ", "q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "q1"}], "+", "q2"}], ")"}]}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.68391543997892*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%34", "\[Equal]", "0"}], ",", "r2"}], "]"}]], "Input",
 CellChangeTimes->{{3.683915503896576*^9, 3.6839155169269114`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", 
    FractionBox[
     RowBox[{
      FractionBox[
       RowBox[{"m", " ", "q3"}], 
       RowBox[{"2", " ", "Q2"}]], "-", 
      FractionBox[
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Q1"}], " ", "q2", " ", "q4"}], "+", 
          RowBox[{"q1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "Q1"}], " ", "q2"}], "+", 
             RowBox[{"Q1", " ", "q4"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        SuperscriptBox["Q2", "2"]}]], "+", 
      FractionBox[
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["q1", "2"], " ", "q2"}], "+", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Q1", "2"], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"Q2", "-", "q4"}], ")"}], "2"]}], ")"}]}], "+", 
          RowBox[{"q1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "Q1", " ", "q2"}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"q2", "-", "q4"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", 
                RowBox[{"2", " ", "Q2"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], "+", 
      FractionBox[
       RowBox[{"q1", " ", "q2", " ", "r1"}], 
       RowBox[{"2", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], "-", 
      FractionBox[
       RowBox[{"q1", " ", "q3", " ", "x"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], "+", 
      FractionBox[
       RowBox[{"q2", " ", "q3", " ", "x"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], "-", 
      FractionBox[
       RowBox[{"q1", " ", "q4", " ", "x"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], "+", 
      FractionBox[
       RowBox[{"q2", " ", "q4", " ", "x"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]]}], 
     RowBox[{
      FractionBox[
       RowBox[{"q1", " ", "q2"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        SuperscriptBox["Q2", "2"]}]], "-", 
      FractionBox[
       RowBox[{"q1", " ", "q4"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        SuperscriptBox["Q2", "2"]}]], "+", 
      FractionBox[
       RowBox[{"q2", " ", "q4"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        SuperscriptBox["Q2", "2"]}]], "-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "Q1"}], " ", "q2", " ", "q4"}], "+", 
        RowBox[{"q1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Q1"}], " ", "q2"}], "+", 
           RowBox[{"Q1", " ", "q4"}]}], ")"}]}]}], 
       RowBox[{"2", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        SuperscriptBox["Q2", "2"]}]]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6839155532113113`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q1", "*", 
    RowBox[{"r1", "/", "Q1"}]}], "+", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "^", "2"}]}], "-", 
   RowBox[{"q1", "*", 
    RowBox[{"r2", "/", "Q2"}]}], "-", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q2"}], ")"}], "^", "2"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", "%52"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.68391564893116*^9, 3.683915649232017*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q1", "-", "Q2"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q1", " ", "r1"}], "Q1"], "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q1", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
       RowBox[{"q2", " ", "q4"}]}], ")"}]}]], 
   RowBox[{"q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k2", " ", "Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q1", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
         RowBox[{"q2", " ", "q4"}]}], ")"}]}], "+", 
      RowBox[{"Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q2"}], ")"}], " ", "q3"}], "+", 
         RowBox[{"c", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["q1", "2"], " ", "q2"}], "+", 
            RowBox[{"q2", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Q1", "2"], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"Q2", "-", "q4"}], ")"}], "2"]}], ")"}]}], "+", 
            RowBox[{"q1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "Q1", " ", "q2"}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", 
                  RowBox[{"2", " ", "Q2"}], "+", "q4"}], ")"}]}]}], ")"}]}]}],
            ")"}]}], "+", 
         RowBox[{"q1", " ", "q2", " ", "r1"}], "-", 
         RowBox[{"q1", " ", "Q1", " ", "q3", " ", "x"}], "+", 
         RowBox[{"Q1", " ", "q2", " ", "q3", " ", "x"}], "-", 
         RowBox[{"q1", " ", "Q1", " ", "q4", " ", "x"}], "+", 
         RowBox[{"Q1", " ", "q2", " ", "q4", " ", "x"}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.6839156676130667`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%53", "\[Equal]", "0"}], ",", "r1"}], "]"}]], "Input",
 CellChangeTimes->{{3.683915670924776*^9, 3.6839156827056723`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       FractionBox["q1", "Q1"], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q1", "2"], " ", "q2"}], 
        RowBox[{"2", " ", "Q1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", "q4"}]}], ")"}]}]]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], "+", 
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"q1", "-", "Q2"}], ")"}], "2"]}], "+", 
       FractionBox[
        RowBox[{"k2", " ", "q1"}], 
        RowBox[{"2", " ", "Q2"}]], "+", 
       FractionBox[
        RowBox[{"m", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{"q1", "-", "q2"}], ")"}], " ", "q3"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", "q4"}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"c", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["q1", "2"], " ", "q2"}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q1", "2"], "-", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Q2", "-", "q4"}], ")"}], "2"]}], ")"}]}], "+", 
           RowBox[{"q1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "Q1", " ", "q2"}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", 
                 RowBox[{"2", " ", "Q2"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", "q4"}]}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q1", "2"], " ", "q3", " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", "q4"}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"q1", " ", "q2", " ", "q3", " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", "q4"}]}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q1", "2"], " ", "q4", " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", "q4"}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"q1", " ", "q2", " ", "q4", " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", "q4"}]}], ")"}]}]]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.683915684353712*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 981},
WindowMargins->{{-10, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.4 for Linux x86 (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 624, 15, 77, "Text"],
Cell[CellGroupData[{
Cell[1207, 39, 159, 5, 58, "Input"],
Cell[1369, 46, 249, 8, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1655, 59, 235, 8, 58, "Input"],
Cell[1893, 69, 365, 13, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2295, 87, 235, 8, 58, "Input"],
Cell[2533, 97, 363, 13, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2933, 115, 159, 5, 58, "Input"],
Cell[3095, 122, 254, 8, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3386, 135, 375, 12, 59, "Input"],
Cell[3764, 149, 927, 34, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4728, 188, 375, 12, 59, "Input"],
Cell[5106, 202, 1327, 49, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6470, 256, 375, 12, 59, "Input"],
Cell[6848, 270, 1349, 50, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8234, 325, 375, 12, 59, "Input"],
Cell[8612, 339, 962, 35, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9611, 379, 244, 6, 34, "Input"],
Cell[9858, 387, 1081, 40, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10976, 432, 239, 6, 34, "Input"],
Cell[11218, 440, 1670, 63, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12925, 508, 159, 3, 34, "Input"],
Cell[13087, 513, 1298, 49, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14422, 567, 157, 3, 34, "Input"],
Cell[14582, 572, 688, 25, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15307, 602, 842, 24, 34, "Input"],
Cell[16152, 628, 15894, 392, 899, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32083, 1025, 562, 18, 32, "Input"],
Cell[32648, 1045, 4628, 111, 206, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37313, 1161, 83, 2, 32, "Input"],
Cell[37399, 1165, 1811, 50, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39247, 1220, 782, 25, 32, "Input"],
Cell[40032, 1247, 23813, 549, 804, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63882, 1801, 83, 2, 32, "Input"],
Cell[63968, 1805, 2169, 64, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66174, 1874, 316, 7, 32, "Input"],
Cell[66493, 1883, 1056, 31, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67586, 1919, 313, 7, 32, "Input"],
Cell[67902, 1928, 2182, 66, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70121, 1999, 722, 19, 32, "Input"],
Cell[70846, 2020, 10230, 251, 418, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81113, 2276, 132, 1, 51, "Subtitle"],
Cell[CellGroupData[{
Cell[81270, 2281, 181, 4, 32, "Input"],
Cell[81454, 2287, 989, 23, 54, "Output"]
}, Open  ]],
Cell[82458, 2313, 68, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[82551, 2318, 529, 17, 32, "Input"],
Cell[83083, 2337, 1203, 38, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84323, 2380, 181, 4, 32, "Input"],
Cell[84507, 2386, 1446, 37, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85990, 2428, 183, 4, 32, "Input"],
Cell[86176, 2434, 3690, 111, 116, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89903, 2550, 526, 17, 32, "Input"],
Cell[90432, 2569, 2311, 67, 104, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92780, 2641, 183, 4, 32, "Input"],
Cell[92966, 2647, 3773, 114, 173, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

