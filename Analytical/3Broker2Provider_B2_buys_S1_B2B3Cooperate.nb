(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     81548,       2458]
NotebookOptionsPosition[     78628,       2353]
NotebookOutlinePosition[     78965,       2368]
CellTagsIndexPosition[     78922,       2365]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "First step is to define the demands based on the prices and qualities, \
which follows the \[Theta] definition. B1 has the lowest quality in the \
market and B3 has the highest quality. In this part we assum that B2 buys \
from S1. B2 & B3 Cooperate\nm here is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and x is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "min"], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.733847862555691*^9, 3.733847896993387*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D1", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p2", "-", "p1"}], 
    RowBox[{"q2", "-", "q1"}]], "-", "m"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "m"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]]}]], "Output",
 CellChangeTimes->{3.672399177822143*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D2", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p3", "-", "p2"}], 
    RowBox[{"q3", "-", "q2"}]], "-", 
   FractionBox[
    RowBox[{"p2", "-", "p1"}], 
    RowBox[{"q2", "-", "q1"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p1"}], "+", "p2"}], 
    RowBox[{
     RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]]}]], "Output",
 CellChangeTimes->{3.672399189170911*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D3", "=", " ", 
  RowBox[{"x", "-", " ", 
   FractionBox[
    RowBox[{"p3", "-", "p2"}], 
    RowBox[{"q3", "-", "q2"}]]}]}]], "Input",
 CellChangeTimes->{{3.6723992361722603`*^9, 3.672399237133861*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p2"}], "+", "p3"}], 
    RowBox[{
     RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", "x"}]], "Output",
 CellChangeTimes->{3.672399238189464*^9}]
}, Open  ]],

Cell["\<\
The next step is defining the profit functions for brokers, and replace the \
demands with their definitions:
Vi is (Qi-qj)
\
\>", "Text",
 CellChangeTimes->{3.733847922882831*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]1", "=", " ", 
  RowBox[{
   RowBox[{"D1", "*", "p1"}], "-", 
   RowBox[{
    RowBox[{"q1", "/", "Q1"}], "*", "D1", "*", "r1"}], "-", 
   RowBox[{"c", "*", "D1", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "^", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6723994687649517`*^9, 3.672399473428626*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"p1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "m"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p1"}], "+", "p2"}], 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q1", "-", "Q1"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "m"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p1"}], "+", "p2"}], 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "m"}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.6723994789083233`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]2", "=", " ", 
  RowBox[{
   RowBox[{"D2", "*", "p2"}], "-", 
   RowBox[{
    RowBox[{"q2", "/", "Q1"}], "*", "D2", "*", "r1"}], "-", 
   RowBox[{"c", "*", "D2", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q1"}], ")"}], "^", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.67239949750622*^9, 3.672399503690152*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"p2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p2"}], "+", "p3"}], 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p2"}], "+", "p3"}], 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p1"}], "+", "p2"}], 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.672399509667181*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]3", "=", " ", 
  RowBox[{
   RowBox[{"D3", "*", "p3"}], "-", 
   RowBox[{
    RowBox[{"q3", "/", "Q2"}], "*", "D3", "*", "r2"}], "-", 
   RowBox[{"c", "*", "D3", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q3", "-", "Q2"}], ")"}], "^", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.672399524713159*^9, 3.6723995512775097`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"p3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", "x"}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", "x"}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q3", " ", "r2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p2"}], "+", "p3"}], 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", "x"}], ")"}]}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.672399554808724*^9}]
}, Open  ]],

Cell["\<\
Now, for each broker, we can find the derivate of its profit with respect to \
its price. Since B2 & B3 cooperate, their total profit is summation of their \
profits:
\
\>", "Text",
 CellChangeTimes->{{3.733847939923024*^9, 3.733847993915763*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"der1", " ", "=", " ", 
  RowBox[{
   SubscriptBox["\[PartialD]", "p1"], "\[CapitalPi]1"}]}]], "Input",
 CellChangeTimes->{{3.672400547422886*^9, 3.672400560515774*^9}, {
  3.7338480009654217`*^9, 3.733848004356203*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "m"}], "-", 
  FractionBox["p1", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{"q1", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.672400561830089*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"der2", " ", "=", " ", 
  RowBox[{
   SubscriptBox["\[PartialD]", "p2"], 
   RowBox[{"(", 
    RowBox[{"\[CapitalPi]2", "+", "\[CapitalPi]3"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6724005824196568`*^9, 3.672400601461767*^9}, {
  3.733848008092454*^9, 3.7338480095883293`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p1"}], "+", "p2"}], 
    RowBox[{
     RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
  FractionBox["p3", 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "-", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
  RowBox[{"p2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r1"}], "Q1"], "-", 
  FractionBox[
   RowBox[{"q3", " ", "r2"}], 
   RowBox[{"Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.672400611936041*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"der3", " ", "=", " ", 
  RowBox[{
   SubscriptBox["\[PartialD]", "p3"], 
   RowBox[{"(", 
    RowBox[{"\[CapitalPi]2", "+", "\[CapitalPi]3"}], ")"}]}]}]], "Input",
 CellChangeTimes->{
  3.672400629558707*^9, {3.7338480123334007`*^9, 3.733848014140387*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["p2", 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "-", 
  FractionBox["p3", 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "-", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "-", 
  FractionBox[
   RowBox[{"q2", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"q3", " ", "r2"}], 
   RowBox[{"Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", "x"}]], "Output",
 CellChangeTimes->{3.672400632783264*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"der1", "\[Equal]", "0"}], "&&", 
    RowBox[{"der2", "\[Equal]", "0"}], "&&", 
    RowBox[{"der3", "\[Equal]", "0"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.672400637662781*^9, 3.672400690293107*^9}, {
  3.73384802243808*^9, 3.733848033454226*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "m", " ", "q1", " ", "Q1"}], "-", 
        RowBox[{"2", " ", "c", " ", 
         SuperscriptBox["q1", "2"], " ", "Q1"}], "+", 
        RowBox[{"4", " ", "c", " ", "q1", " ", 
         SuperscriptBox["Q1", "2"]}], "-", 
        RowBox[{"3", " ", "c", " ", 
         SuperscriptBox["Q1", "3"]}], "+", 
        RowBox[{"2", " ", "m", " ", "Q1", " ", "q2"}], "+", 
        RowBox[{"2", " ", "c", " ", 
         SuperscriptBox["Q1", "2"], " ", "q2"}], "-", 
        RowBox[{"c", " ", "Q1", " ", 
         SuperscriptBox["q2", "2"]}], "-", 
        RowBox[{"2", " ", "q1", " ", "r1"}], "-", 
        RowBox[{"q2", " ", "r1"}], "+", 
        RowBox[{"q1", " ", "Q1", " ", "x"}], "-", 
        RowBox[{"Q1", " ", "q2", " ", "x"}]}], 
       RowBox[{"3", " ", "Q1"}]]}]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{"m", " ", "q1"}], "3"], "+", 
      FractionBox[
       RowBox[{"c", " ", 
        SuperscriptBox["q1", "2"]}], "3"], "-", 
      FractionBox[
       RowBox[{"2", " ", "c", " ", "q1", " ", "Q1"}], "3"], "+", 
      RowBox[{"c", " ", 
       SuperscriptBox["Q1", "2"]}], "-", 
      FractionBox[
       RowBox[{"m", " ", "q2"}], "3"], "-", 
      FractionBox[
       RowBox[{"4", " ", "c", " ", "Q1", " ", "q2"}], "3"], "+", 
      FractionBox[
       RowBox[{"2", " ", "c", " ", 
        SuperscriptBox["q2", "2"]}], "3"], "+", 
      FractionBox[
       RowBox[{"q1", " ", "r1"}], 
       RowBox[{"3", " ", "Q1"}]], "+", 
      FractionBox[
       RowBox[{"2", " ", "q2", " ", "r1"}], 
       RowBox[{"3", " ", "Q1"}]], "-", 
      FractionBox[
       RowBox[{"2", " ", "q1", " ", "x"}], "3"], "+", 
      FractionBox[
       RowBox[{"2", " ", "q2", " ", "x"}], "3"]}]}], ",", 
    RowBox[{"p3", "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{"m", " ", "q1"}], "3"], "+", 
      FractionBox[
       RowBox[{"c", " ", 
        SuperscriptBox["q1", "2"]}], "3"], "-", 
      FractionBox[
       RowBox[{"2", " ", "c", " ", "q1", " ", "Q1"}], "3"], "+", 
      FractionBox[
       RowBox[{"c", " ", 
        SuperscriptBox["Q1", "2"]}], "2"], "-", 
      FractionBox[
       RowBox[{"m", " ", "q2"}], "3"], "-", 
      FractionBox[
       RowBox[{"c", " ", "Q1", " ", "q2"}], "3"], "+", 
      FractionBox[
       RowBox[{"c", " ", 
        SuperscriptBox["q2", "2"]}], "6"], "+", 
      FractionBox[
       RowBox[{"c", " ", 
        SuperscriptBox["Q2", "2"]}], "2"], "-", 
      RowBox[{"c", " ", "Q2", " ", "q3"}], "+", 
      FractionBox[
       RowBox[{"c", " ", 
        SuperscriptBox["q3", "2"]}], "2"], "+", 
      FractionBox[
       RowBox[{"q1", " ", "r1"}], 
       RowBox[{"3", " ", "Q1"}]], "+", 
      FractionBox[
       RowBox[{"q2", " ", "r1"}], 
       RowBox[{"6", " ", "Q1"}]], "+", 
      FractionBox[
       RowBox[{"q3", " ", "r2"}], 
       RowBox[{"2", " ", "Q2"}]], "-", 
      FractionBox[
       RowBox[{"2", " ", "q1", " ", "x"}], "3"], "+", 
      FractionBox[
       RowBox[{"q2", " ", "x"}], "6"], "+", 
      FractionBox[
       RowBox[{"q3", " ", "x"}], "2"]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.672400697663913*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U1", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"D1", "*", 
         RowBox[{"q1", "/", "Q1"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"D2", "*", 
         RowBox[{"q2", "/", "Q1"}]}], ")"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"r1", "-", "k1"}], ")"}]}], "-", 
    RowBox[{"e", "*", 
     RowBox[{"Q1", "^", "2"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "m", " ", "q1", " ", "Q1"}], "-", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["q1", "2"], " ", "Q1"}], "+", 
         RowBox[{"4", " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "2"]}], "-", 
         RowBox[{"3", " ", "c", " ", 
          SuperscriptBox["Q1", "3"]}], "+", 
         RowBox[{"2", " ", "m", " ", "Q1", " ", "q2"}], "+", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2"}], "-", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"]}], "-", 
         RowBox[{"2", " ", "q1", " ", "r1"}], "-", 
         RowBox[{"q2", " ", "r1"}], "+", 
         RowBox[{"q1", " ", "Q1", " ", "x"}], "-", 
         RowBox[{"Q1", " ", "q2", " ", "x"}]}], 
        RowBox[{"3", " ", "Q1"}]]}]}], ",", 
     RowBox[{"p2", "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{"m", " ", "q1"}], "3"], "+", 
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox["q1", "2"]}], "3"], "-", 
       FractionBox[
        RowBox[{"2", " ", "c", " ", "q1", " ", "Q1"}], "3"], "+", 
       RowBox[{"c", " ", 
        SuperscriptBox["Q1", "2"]}], "-", 
       FractionBox[
        RowBox[{"m", " ", "q2"}], "3"], "-", 
       FractionBox[
        RowBox[{"4", " ", "c", " ", "Q1", " ", "q2"}], "3"], "+", 
       FractionBox[
        RowBox[{"2", " ", "c", " ", 
         SuperscriptBox["q2", "2"]}], "3"], "+", 
       FractionBox[
        RowBox[{"q1", " ", "r1"}], 
        RowBox[{"3", " ", "Q1"}]], "+", 
       FractionBox[
        RowBox[{"2", " ", "q2", " ", "r1"}], 
        RowBox[{"3", " ", "Q1"}]], "-", 
       FractionBox[
        RowBox[{"2", " ", "q1", " ", "x"}], "3"], "+", 
       FractionBox[
        RowBox[{"2", " ", "q2", " ", "x"}], "3"]}]}], ",", 
     RowBox[{"p3", "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{"m", " ", "q1"}], "3"], "+", 
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox["q1", "2"]}], "3"], "-", 
       FractionBox[
        RowBox[{"2", " ", "c", " ", "q1", " ", "Q1"}], "3"], "+", 
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox["Q1", "2"]}], "2"], "-", 
       FractionBox[
        RowBox[{"m", " ", "q2"}], "3"], "-", 
       FractionBox[
        RowBox[{"c", " ", "Q1", " ", "q2"}], "3"], "+", 
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox["q2", "2"]}], "6"], "+", 
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox["Q2", "2"]}], "2"], "-", 
       RowBox[{"c", " ", "Q2", " ", "q3"}], "+", 
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox["q3", "2"]}], "2"], "+", 
       FractionBox[
        RowBox[{"q1", " ", "r1"}], 
        RowBox[{"3", " ", "Q1"}]], "+", 
       FractionBox[
        RowBox[{"q2", " ", "r1"}], 
        RowBox[{"6", " ", "Q1"}]], "+", 
       FractionBox[
        RowBox[{"q3", " ", "r2"}], 
        RowBox[{"2", " ", "Q2"}]], "-", 
       FractionBox[
        RowBox[{"2", " ", "q1", " ", "x"}], "3"], "+", 
       FractionBox[
        RowBox[{"q2", " ", "x"}], "6"], "+", 
       FractionBox[
        RowBox[{"q3", " ", "x"}], "2"]}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.672401105833088*^9, 3.672401120126959*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "e"}], " ", 
   SuperscriptBox["Q1", "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "k1"}], "+", "r1"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "Q1"], 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"c", " ", 
              SuperscriptBox["Q1", "2"]}], "2"]}], "+", 
           RowBox[{"c", " ", "Q1", " ", "q2"}], "-", 
           FractionBox[
            RowBox[{"c", " ", 
             SuperscriptBox["q2", "2"]}], "2"], "+", 
           FractionBox[
            RowBox[{"c", " ", 
             SuperscriptBox["Q2", "2"]}], "2"], "-", 
           RowBox[{"c", " ", "Q2", " ", "q3"}], "+", 
           FractionBox[
            RowBox[{"c", " ", 
             SuperscriptBox["q3", "2"]}], "2"], "-", 
           FractionBox[
            RowBox[{"q2", " ", "r1"}], 
            RowBox[{"2", " ", "Q1"}]], "+", 
           FractionBox[
            RowBox[{"q3", " ", "r2"}], 
            RowBox[{"2", " ", "Q2"}]], "-", 
           FractionBox[
            RowBox[{"q2", " ", "x"}], "2"], "+", 
           FractionBox[
            RowBox[{"q3", " ", "x"}], "2"]}], 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}]], "-", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"m", " ", "q1"}], "3"], "+", 
            FractionBox[
             RowBox[{"c", " ", 
              SuperscriptBox["q1", "2"]}], "3"], "-", 
            FractionBox[
             RowBox[{"2", " ", "c", " ", "q1", " ", "Q1"}], "3"], "+", 
            RowBox[{"c", " ", 
             SuperscriptBox["Q1", "2"]}], "-", 
            FractionBox[
             RowBox[{"m", " ", "q2"}], "3"], "-", 
            FractionBox[
             RowBox[{"4", " ", "c", " ", "Q1", " ", "q2"}], "3"], "+", 
            FractionBox[
             RowBox[{"2", " ", "c", " ", 
              SuperscriptBox["q2", "2"]}], "3"], "+", 
            FractionBox[
             RowBox[{"q1", " ", "r1"}], 
             RowBox[{"3", " ", "Q1"}]], "+", 
            FractionBox[
             RowBox[{"2", " ", "q2", " ", "r1"}], 
             RowBox[{"3", " ", "Q1"}]], "-", 
            FractionBox[
             RowBox[{"2", " ", "q1", " ", "x"}], "3"], "+", 
            FractionBox[
             RowBox[{"2", " ", "q2", " ", "x"}], "3"], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "m", " ", "q1", " ", "Q1"}], "-", 
              RowBox[{"2", " ", "c", " ", 
               SuperscriptBox["q1", "2"], " ", "Q1"}], "+", 
              RowBox[{"4", " ", "c", " ", "q1", " ", 
               SuperscriptBox["Q1", "2"]}], "-", 
              RowBox[{"3", " ", "c", " ", 
               SuperscriptBox["Q1", "3"]}], "+", 
              RowBox[{"2", " ", "m", " ", "Q1", " ", "q2"}], "+", 
              RowBox[{"2", " ", "c", " ", 
               SuperscriptBox["Q1", "2"], " ", "q2"}], "-", 
              RowBox[{"c", " ", "Q1", " ", 
               SuperscriptBox["q2", "2"]}], "-", 
              RowBox[{"2", " ", "q1", " ", "r1"}], "-", 
              RowBox[{"q2", " ", "r1"}], "+", 
              RowBox[{"q1", " ", "Q1", " ", "x"}], "-", 
              RowBox[{"Q1", " ", "q2", " ", "x"}]}], 
             RowBox[{"3", " ", "Q1"}]]}], ")"}]}]}], ")"}]}]}], "+", 
     FractionBox[
      RowBox[{"q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "m"}], "+", 
         FractionBox[
          RowBox[{
           FractionBox[
            RowBox[{"m", " ", "q1"}], "3"], "+", 
           FractionBox[
            RowBox[{"c", " ", 
             SuperscriptBox["q1", "2"]}], "3"], "-", 
           FractionBox[
            RowBox[{"2", " ", "c", " ", "q1", " ", "Q1"}], "3"], "+", 
           RowBox[{"c", " ", 
            SuperscriptBox["Q1", "2"]}], "-", 
           FractionBox[
            RowBox[{"m", " ", "q2"}], "3"], "-", 
           FractionBox[
            RowBox[{"4", " ", "c", " ", "Q1", " ", "q2"}], "3"], "+", 
           FractionBox[
            RowBox[{"2", " ", "c", " ", 
             SuperscriptBox["q2", "2"]}], "3"], "+", 
           FractionBox[
            RowBox[{"q1", " ", "r1"}], 
            RowBox[{"3", " ", "Q1"}]], "+", 
           FractionBox[
            RowBox[{"2", " ", "q2", " ", "r1"}], 
            RowBox[{"3", " ", "Q1"}]], "-", 
           FractionBox[
            RowBox[{"2", " ", "q1", " ", "x"}], "3"], "+", 
           FractionBox[
            RowBox[{"2", " ", "q2", " ", "x"}], "3"], "+", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "m", " ", "q1", " ", "Q1"}], "-", 
             RowBox[{"2", " ", "c", " ", 
              SuperscriptBox["q1", "2"], " ", "Q1"}], "+", 
             RowBox[{"4", " ", "c", " ", "q1", " ", 
              SuperscriptBox["Q1", "2"]}], "-", 
             RowBox[{"3", " ", "c", " ", 
              SuperscriptBox["Q1", "3"]}], "+", 
             RowBox[{"2", " ", "m", " ", "Q1", " ", "q2"}], "+", 
             RowBox[{"2", " ", "c", " ", 
              SuperscriptBox["Q1", "2"], " ", "q2"}], "-", 
             RowBox[{"c", " ", "Q1", " ", 
              SuperscriptBox["q2", "2"]}], "-", 
             RowBox[{"2", " ", "q1", " ", "r1"}], "-", 
             RowBox[{"q2", " ", "r1"}], "+", 
             RowBox[{"q1", " ", "Q1", " ", "x"}], "-", 
             RowBox[{"Q1", " ", "q2", " ", "x"}]}], 
            RowBox[{"3", " ", "Q1"}]]}], 
          RowBox[{
           RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "Q1"]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.672401131755739*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U1Simp", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", "%13", "]"}]}]], "Input",
 CellChangeTimes->{{3.733848074679172*^9, 3.733848081518509*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"6", " ", 
    SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q3"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"6", " ", "e", " ", 
     SuperscriptBox["Q1", "4"], " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "+", 
    RowBox[{"k1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "q1", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "-", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              SuperscriptBox["Q1", "2"]}], "+", 
             SuperscriptBox["q2", "2"], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "+", 
             RowBox[{"2", " ", "q2", " ", "q3"}], "-", 
             RowBox[{"2", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{"q2", "+", 
                RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       "-", 
       RowBox[{"2", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "-", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "+", 
       RowBox[{"2", " ", "q1", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
       RowBox[{"2", " ", "q2", " ", "Q2", " ", "q3", " ", "r1"}], "+", 
       RowBox[{"3", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "-", 
       RowBox[{"Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", "x"}]}], ")"}]}], "+", 
    RowBox[{"r1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "m", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["q1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
          RowBox[{"4", " ", "q1", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "+", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              SuperscriptBox["Q1", "2"]}], "+", 
             SuperscriptBox["q2", "2"], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "+", 
             RowBox[{"2", " ", "q2", " ", "q3"}], "-", 
             RowBox[{"2", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{"q2", "+", 
                RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{"2", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "-", 
       RowBox[{"2", " ", "q1", " ", "Q2", " ", "q3", " ", "r1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
       RowBox[{"3", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
       RowBox[{"Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", "x"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.672401141756895*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"D3", "*", 
       RowBox[{"q3", "/", "Q2"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"r2", "-", "k2"}], ")"}]}], "-", 
    RowBox[{"e", "*", 
     RowBox[{"Q2", "^", "2"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "m", " ", "q1", " ", "Q1"}], "-", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["q1", "2"], " ", "Q1"}], "+", 
         RowBox[{"4", " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "2"]}], "-", 
         RowBox[{"3", " ", "c", " ", 
          SuperscriptBox["Q1", "3"]}], "+", 
         RowBox[{"2", " ", "m", " ", "Q1", " ", "q2"}], "+", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2"}], "-", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"]}], "-", 
         RowBox[{"2", " ", "q1", " ", "r1"}], "-", 
         RowBox[{"q2", " ", "r1"}], "+", 
         RowBox[{"q1", " ", "Q1", " ", "x"}], "-", 
         RowBox[{"Q1", " ", "q2", " ", "x"}]}], 
        RowBox[{"3", " ", "Q1"}]]}]}], ",", 
     RowBox[{"p2", "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{"m", " ", "q1"}], "3"], "+", 
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox["q1", "2"]}], "3"], "-", 
       FractionBox[
        RowBox[{"2", " ", "c", " ", "q1", " ", "Q1"}], "3"], "+", 
       RowBox[{"c", " ", 
        SuperscriptBox["Q1", "2"]}], "-", 
       FractionBox[
        RowBox[{"m", " ", "q2"}], "3"], "-", 
       FractionBox[
        RowBox[{"4", " ", "c", " ", "Q1", " ", "q2"}], "3"], "+", 
       FractionBox[
        RowBox[{"2", " ", "c", " ", 
         SuperscriptBox["q2", "2"]}], "3"], "+", 
       FractionBox[
        RowBox[{"q1", " ", "r1"}], 
        RowBox[{"3", " ", "Q1"}]], "+", 
       FractionBox[
        RowBox[{"2", " ", "q2", " ", "r1"}], 
        RowBox[{"3", " ", "Q1"}]], "-", 
       FractionBox[
        RowBox[{"2", " ", "q1", " ", "x"}], "3"], "+", 
       FractionBox[
        RowBox[{"2", " ", "q2", " ", "x"}], "3"]}]}], ",", 
     RowBox[{"p3", "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{"m", " ", "q1"}], "3"], "+", 
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox["q1", "2"]}], "3"], "-", 
       FractionBox[
        RowBox[{"2", " ", "c", " ", "q1", " ", "Q1"}], "3"], "+", 
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox["Q1", "2"]}], "2"], "-", 
       FractionBox[
        RowBox[{"m", " ", "q2"}], "3"], "-", 
       FractionBox[
        RowBox[{"c", " ", "Q1", " ", "q2"}], "3"], "+", 
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox["q2", "2"]}], "6"], "+", 
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox["Q2", "2"]}], "2"], "-", 
       RowBox[{"c", " ", "Q2", " ", "q3"}], "+", 
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox["q3", "2"]}], "2"], "+", 
       FractionBox[
        RowBox[{"q1", " ", "r1"}], 
        RowBox[{"3", " ", "Q1"}]], "+", 
       FractionBox[
        RowBox[{"q2", " ", "r1"}], 
        RowBox[{"6", " ", "Q1"}]], "+", 
       FractionBox[
        RowBox[{"q3", " ", "r2"}], 
        RowBox[{"2", " ", "Q2"}]], "-", 
       FractionBox[
        RowBox[{"2", " ", "q1", " ", "x"}], "3"], "+", 
       FractionBox[
        RowBox[{"q2", " ", "x"}], "6"], "+", 
       FractionBox[
        RowBox[{"q3", " ", "x"}], "2"]}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.672401176584426*^9, 3.672401188612261*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "e"}], " ", 
   SuperscriptBox["Q2", "2"]}], "+", 
  FractionBox[
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "k2"}], "+", "r2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"x", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["Q1", "2"]}], "2"]}], "+", 
        RowBox[{"c", " ", "Q1", " ", "q2"}], "-", 
        FractionBox[
         RowBox[{"c", " ", 
          SuperscriptBox["q2", "2"]}], "2"], "+", 
        FractionBox[
         RowBox[{"c", " ", 
          SuperscriptBox["Q2", "2"]}], "2"], "-", 
        RowBox[{"c", " ", "Q2", " ", "q3"}], "+", 
        FractionBox[
         RowBox[{"c", " ", 
          SuperscriptBox["q3", "2"]}], "2"], "-", 
        FractionBox[
         RowBox[{"q2", " ", "r1"}], 
         RowBox[{"2", " ", "Q1"}]], "+", 
        FractionBox[
         RowBox[{"q3", " ", "r2"}], 
         RowBox[{"2", " ", "Q2"}]], "-", 
        FractionBox[
         RowBox[{"q2", " ", "x"}], "2"], "+", 
        FractionBox[
         RowBox[{"q3", " ", "x"}], "2"]}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "Q2"]}]], "Output",
 CellChangeTimes->{3.672401231195097*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U2simp", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "e"}], " ", 
     SuperscriptBox["Q2", "2"]}], "+", 
    FractionBox[
     RowBox[{"q3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "k2"}], "+", "r2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"x", "-", 
        FractionBox[
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"c", " ", 
             SuperscriptBox["Q1", "2"]}], "2"]}], "+", 
          RowBox[{"c", " ", "Q1", " ", "q2"}], "-", 
          FractionBox[
           RowBox[{"c", " ", 
            SuperscriptBox["q2", "2"]}], "2"], "+", 
          FractionBox[
           RowBox[{"c", " ", 
            SuperscriptBox["Q2", "2"]}], "2"], "-", 
          RowBox[{"c", " ", "Q2", " ", "q3"}], "+", 
          FractionBox[
           RowBox[{"c", " ", 
            SuperscriptBox["q3", "2"]}], "2"], "-", 
          FractionBox[
           RowBox[{"q2", " ", "r1"}], 
           RowBox[{"2", " ", "Q1"}]], "+", 
          FractionBox[
           RowBox[{"q3", " ", "r2"}], 
           RowBox[{"2", " ", "Q2"}]], "-", 
          FractionBox[
           RowBox[{"q2", " ", "x"}], "2"], "+", 
          FractionBox[
           RowBox[{"q3", " ", "x"}], "2"]}], 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "Q2"]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.733848088999455*^9, 3.733848091919199*^9}},
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", "e", " ", "Q1", " ", 
    SuperscriptBox["Q2", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "+", 
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{"k2", "-", "r2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q1", "2"], "-", 
         RowBox[{"2", " ", "Q1", " ", "q2"}], "+", 
         SuperscriptBox["q2", "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], ")"}]}], "+", 
      RowBox[{"q2", " ", "Q2", " ", "r1"}], "-", 
      RowBox[{"Q1", " ", "q3", " ", "r2"}], "-", 
      RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "x"}], "+", 
      RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "x"}]}], ")"}]}]}], 
  RowBox[{"2", " ", "Q1", " ", 
   SuperscriptBox["Q2", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"q2", "-", "q3"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.672401257348029*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"derU1", " ", "=", " ", 
  RowBox[{
   SubscriptBox["\[PartialD]", "r1"], "U1"}]}]], "Input",
 CellChangeTimes->{{3.672401334356119*^9, 3.672401336399043*^9}, {
  3.6724013681426153`*^9, 3.672401386174944*^9}, {3.7338481005347567`*^9, 
  3.733848103982881*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"q1", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["q1", 
          RowBox[{"3", " ", "Q1"}]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "q1"}], "-", "q2"}], 
          RowBox[{"3", " ", "Q1"}]], "+", 
         FractionBox[
          RowBox[{"2", " ", "q2"}], 
          RowBox[{"3", " ", "Q1"}]]}], ")"}]}], 
      RowBox[{"Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            FractionBox["q1", 
             RowBox[{"3", " ", "Q1"}]], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "q1"}], "-", "q2"}], 
             RowBox[{"3", " ", "Q1"}]], "+", 
            FractionBox[
             RowBox[{"2", " ", "q2"}], 
             RowBox[{"3", " ", "Q1"}]]}], 
           RowBox[{
            RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
         FractionBox["q2", 
          RowBox[{"2", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]]}], ")"}]}], "Q1"]}], 
    ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "k1"}], "+", "r1"}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "Q1"], 
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["Q1", "2"]}], "2"]}], "+", 
        RowBox[{"c", " ", "Q1", " ", "q2"}], "-", 
        FractionBox[
         RowBox[{"c", " ", 
          SuperscriptBox["q2", "2"]}], "2"], "+", 
        FractionBox[
         RowBox[{"c", " ", 
          SuperscriptBox["Q2", "2"]}], "2"], "-", 
        RowBox[{"c", " ", "Q2", " ", "q3"}], "+", 
        FractionBox[
         RowBox[{"c", " ", 
          SuperscriptBox["q3", "2"]}], "2"], "-", 
        FractionBox[
         RowBox[{"q2", " ", "r1"}], 
         RowBox[{"2", " ", "Q1"}]], "+", 
        FractionBox[
         RowBox[{"q3", " ", "r2"}], 
         RowBox[{"2", " ", "Q2"}]], "-", 
        FractionBox[
         RowBox[{"q2", " ", "x"}], "2"], "+", 
        FractionBox[
         RowBox[{"q3", " ", "x"}], "2"]}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]], "-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"m", " ", "q1"}], "3"], "+", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["q1", "2"]}], "3"], "-", 
         FractionBox[
          RowBox[{"2", " ", "c", " ", "q1", " ", "Q1"}], "3"], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["Q1", "2"]}], "-", 
         FractionBox[
          RowBox[{"m", " ", "q2"}], "3"], "-", 
         FractionBox[
          RowBox[{"4", " ", "c", " ", "Q1", " ", "q2"}], "3"], "+", 
         FractionBox[
          RowBox[{"2", " ", "c", " ", 
           SuperscriptBox["q2", "2"]}], "3"], "+", 
         FractionBox[
          RowBox[{"q1", " ", "r1"}], 
          RowBox[{"3", " ", "Q1"}]], "+", 
         FractionBox[
          RowBox[{"2", " ", "q2", " ", "r1"}], 
          RowBox[{"3", " ", "Q1"}]], "-", 
         FractionBox[
          RowBox[{"2", " ", "q1", " ", "x"}], "3"], "+", 
         FractionBox[
          RowBox[{"2", " ", "q2", " ", "x"}], "3"], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "m", " ", "q1", " ", "Q1"}], "-", 
           RowBox[{"2", " ", "c", " ", 
            SuperscriptBox["q1", "2"], " ", "Q1"}], "+", 
           RowBox[{"4", " ", "c", " ", "q1", " ", 
            SuperscriptBox["Q1", "2"]}], "-", 
           RowBox[{"3", " ", "c", " ", 
            SuperscriptBox["Q1", "3"]}], "+", 
           RowBox[{"2", " ", "m", " ", "Q1", " ", "q2"}], "+", 
           RowBox[{"2", " ", "c", " ", 
            SuperscriptBox["Q1", "2"], " ", "q2"}], "-", 
           RowBox[{"c", " ", "Q1", " ", 
            SuperscriptBox["q2", "2"]}], "-", 
           RowBox[{"2", " ", "q1", " ", "r1"}], "-", 
           RowBox[{"q2", " ", "r1"}], "+", 
           RowBox[{"q1", " ", "Q1", " ", "x"}], "-", 
           RowBox[{"Q1", " ", "q2", " ", "x"}]}], 
          RowBox[{"3", " ", "Q1"}]]}], ")"}]}]}], ")"}]}]}], "+", 
  FractionBox[
   RowBox[{"q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "m"}], "+", 
      FractionBox[
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "q1"}], "3"], "+", 
        FractionBox[
         RowBox[{"c", " ", 
          SuperscriptBox["q1", "2"]}], "3"], "-", 
        FractionBox[
         RowBox[{"2", " ", "c", " ", "q1", " ", "Q1"}], "3"], "+", 
        RowBox[{"c", " ", 
         SuperscriptBox["Q1", "2"]}], "-", 
        FractionBox[
         RowBox[{"m", " ", "q2"}], "3"], "-", 
        FractionBox[
         RowBox[{"4", " ", "c", " ", "Q1", " ", "q2"}], "3"], "+", 
        FractionBox[
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["q2", "2"]}], "3"], "+", 
        FractionBox[
         RowBox[{"q1", " ", "r1"}], 
         RowBox[{"3", " ", "Q1"}]], "+", 
        FractionBox[
         RowBox[{"2", " ", "q2", " ", "r1"}], 
         RowBox[{"3", " ", "Q1"}]], "-", 
        FractionBox[
         RowBox[{"2", " ", "q1", " ", "x"}], "3"], "+", 
        FractionBox[
         RowBox[{"2", " ", "q2", " ", "x"}], "3"], "+", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "m", " ", "q1", " ", "Q1"}], "-", 
          RowBox[{"2", " ", "c", " ", 
           SuperscriptBox["q1", "2"], " ", "Q1"}], "+", 
          RowBox[{"4", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "2"]}], "-", 
          RowBox[{"3", " ", "c", " ", 
           SuperscriptBox["Q1", "3"]}], "+", 
          RowBox[{"2", " ", "m", " ", "Q1", " ", "q2"}], "+", 
          RowBox[{"2", " ", "c", " ", 
           SuperscriptBox["Q1", "2"], " ", "q2"}], "-", 
          RowBox[{"c", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"]}], "-", 
          RowBox[{"2", " ", "q1", " ", "r1"}], "-", 
          RowBox[{"q2", " ", "r1"}], "+", 
          RowBox[{"q1", " ", "Q1", " ", "x"}], "-", 
          RowBox[{"Q1", " ", "q2", " ", "x"}]}], 
         RowBox[{"3", " ", "Q1"}]]}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "Q1"]}]], "Output",
 CellChangeTimes->{3.672401389164338*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "%18", "]"}]], "Input",
 CellChangeTimes->{{3.733848120463809*^9, 3.7338481745287037`*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"6", " ", 
    SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q3"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "c", " ", 
     SuperscriptBox["q1", "2"], " ", "Q1", " ", "q2", " ", "Q2"}], "-", 
    RowBox[{"4", " ", "c", " ", "q1", " ", 
     SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2"}], "+", 
    RowBox[{"3", " ", "c", " ", 
     SuperscriptBox["Q1", "3"], " ", "q2", " ", "Q2"}], "-", 
    RowBox[{"2", " ", "c", " ", 
     SuperscriptBox["Q1", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
    RowBox[{"c", " ", "Q1", " ", 
     SuperscriptBox["q2", "3"], " ", "Q2"}], "-", 
    RowBox[{"3", " ", "c", " ", "Q1", " ", "q2", " ", 
     SuperscriptBox["Q2", "3"]}], "-", 
    RowBox[{"2", " ", "m", " ", "Q1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}], "-", 
    RowBox[{"2", " ", "c", " ", 
     SuperscriptBox["q1", "2"], " ", "Q1", " ", "Q2", " ", "q3"}], "+", 
    RowBox[{"4", " ", "c", " ", "q1", " ", 
     SuperscriptBox["Q1", "2"], " ", "Q2", " ", "q3"}], "-", 
    RowBox[{"4", " ", "c", " ", 
     SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2", " ", "q3"}], "+", 
    RowBox[{"2", " ", "c", " ", "Q1", " ", 
     SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "+", 
    RowBox[{"6", " ", "c", " ", "Q1", " ", "q2", " ", 
     SuperscriptBox["Q2", "2"], " ", "q3"}], "-", 
    RowBox[{"3", " ", "c", " ", "Q1", " ", "q2", " ", "Q2", " ", 
     SuperscriptBox["q3", "2"]}], "-", 
    RowBox[{"k1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"4", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "-", 
    RowBox[{"4", " ", "q1", " ", "Q2", " ", "q3", " ", "r1"}], "+", 
    RowBox[{"4", " ", "q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
    RowBox[{"3", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
    RowBox[{"2", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", "x"}], "+", 
    
    RowBox[{"Q1", " ", 
     SuperscriptBox["q2", "2"], " ", "Q2", " ", "x"}], "-", 
    RowBox[{"2", " ", "q1", " ", "Q1", " ", "Q2", " ", "q3", " ", "x"}], "-", 
    
    RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.672401396374641*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"derU2", " ", "=", " ", 
  RowBox[{
   SubscriptBox["\[PartialD]", "r2"], "U2"}]}]], "Input",
 CellChangeTimes->{{3.672401400265718*^9, 3.672401408523711*^9}, {
  3.7338481376648273`*^9, 3.733848148600869*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["q3", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "k2"}], "+", "r2"}], ")"}]}], 
    RowBox[{"2", " ", 
     SuperscriptBox["Q2", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]]}], "+", 
  FractionBox[
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{"x", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["Q1", "2"]}], "2"]}], "+", 
        RowBox[{"c", " ", "Q1", " ", "q2"}], "-", 
        FractionBox[
         RowBox[{"c", " ", 
          SuperscriptBox["q2", "2"]}], "2"], "+", 
        FractionBox[
         RowBox[{"c", " ", 
          SuperscriptBox["Q2", "2"]}], "2"], "-", 
        RowBox[{"c", " ", "Q2", " ", "q3"}], "+", 
        FractionBox[
         RowBox[{"c", " ", 
          SuperscriptBox["q3", "2"]}], "2"], "-", 
        FractionBox[
         RowBox[{"q2", " ", "r1"}], 
         RowBox[{"2", " ", "Q1"}]], "+", 
        FractionBox[
         RowBox[{"q3", " ", "r2"}], 
         RowBox[{"2", " ", "Q2"}]], "-", 
        FractionBox[
         RowBox[{"q2", " ", "x"}], "2"], "+", 
        FractionBox[
         RowBox[{"q3", " ", "x"}], "2"]}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "Q2"]}]], "Output",
 CellChangeTimes->{3.672401410309682*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["q3", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "k2"}], "+", "r2"}], ")"}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox["Q2", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]]}], "+", 
   FractionBox[
    RowBox[{"q3", " ", 
     RowBox[{"(", 
      RowBox[{"x", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"c", " ", 
            SuperscriptBox["Q1", "2"]}], "2"]}], "+", 
         RowBox[{"c", " ", "Q1", " ", "q2"}], "-", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["q2", "2"]}], "2"], "+", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["Q2", "2"]}], "2"], "-", 
         RowBox[{"c", " ", "Q2", " ", "q3"}], "+", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["q3", "2"]}], "2"], "-", 
         FractionBox[
          RowBox[{"q2", " ", "r1"}], 
          RowBox[{"2", " ", "Q1"}]], "+", 
         FractionBox[
          RowBox[{"q3", " ", "r2"}], 
          RowBox[{"2", " ", "Q2"}]], "-", 
         FractionBox[
          RowBox[{"q2", " ", "x"}], "2"], "+", 
         FractionBox[
          RowBox[{"q3", " ", "x"}], "2"]}], 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "Q2"]}], 
  "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q1", "2"], "-", 
         RowBox[{"2", " ", "Q1", " ", "q2"}], "+", 
         SuperscriptBox["q2", "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], ")"}]}], "+", 
      RowBox[{"k2", " ", "Q1", " ", "q3"}], "+", 
      RowBox[{"q2", " ", "Q2", " ", "r1"}], "-", 
      RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "-", 
      RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "x"}], "+", 
      RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "x"}]}], ")"}]}], 
   RowBox[{"2", " ", "Q1", " ", 
    SuperscriptBox["Q2", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q3"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.6724014129890738`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", "derU1", "]"}], "\[Equal]", "0"}], "&&", 
    RowBox[{
     RowBox[{"Simplify", "[", "derU2", "]"}], "\[Equal]", "0"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"r1", ",", "r2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6724014165047407`*^9, 3.672401452593828*^9}, {
  3.7338481861384487`*^9, 3.7338482154339848`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"r1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Q2", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q3"}], ")"}]}], ")"}]}], 
          RowBox[{
           SuperscriptBox["q3", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}]}], 
               RowBox[{"3", " ", "Q1"}]]}], "-", 
             FractionBox[
              RowBox[{"2", " ", "c", " ", "q1", " ", "q2"}], 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"c", " ", 
               SuperscriptBox["q1", "2"], " ", "q2"}], 
              RowBox[{"3", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"c", " ", "Q1", " ", "q2"}], 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"c", " ", 
               SuperscriptBox["q2", "2"]}], 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"c", " ", 
               SuperscriptBox["q2", "3"]}], 
              RowBox[{"6", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"c", " ", "q2", " ", 
               SuperscriptBox["Q2", "2"]}], 
              RowBox[{"2", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"2", " ", "c", " ", "q1", " ", "q3"}], 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"c", " ", 
               SuperscriptBox["q1", "2"], " ", "q3"}], 
              RowBox[{"3", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"2", " ", "c", " ", "q2", " ", "q3"}], 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"c", " ", 
               SuperscriptBox["q2", "2"], " ", "q3"}], 
              RowBox[{"3", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"c", " ", "q2", " ", "Q2", " ", "q3"}], 
              RowBox[{"Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"c", " ", "q2", " ", 
               SuperscriptBox["q3", "2"]}], 
              RowBox[{"2", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"k1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q1", " ", 
                  RowBox[{"(", 
                   RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
                 RowBox[{"q2", " ", 
                  RowBox[{"(", 
                   RowBox[{"q2", "+", 
                    RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}], 
              RowBox[{"6", " ", 
               SuperscriptBox["Q1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"q1", " ", "q2", " ", "x"}], 
              RowBox[{"3", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{
               SuperscriptBox["q2", "2"], " ", "x"}], 
              RowBox[{"6", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"q1", " ", "q3", " ", "x"}], 
              RowBox[{"3", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"q2", " ", "q3", " ", "x"}], 
              RowBox[{"6", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]]}], ")"}]}]}], "+", 
         FractionBox[
          RowBox[{"q2", " ", "q3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q1", "2"], "-", 
                  RowBox[{"2", " ", "Q1", " ", "q2"}], "+", 
                  SuperscriptBox["q2", "2"], "-", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], ")"}], " ", 
                "q3"}], 
               RowBox[{"2", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}]}]]}], "-", 
             FractionBox[
              RowBox[{"k2", " ", 
               SuperscriptBox["q3", "2"]}], 
              RowBox[{"2", " ", 
               SuperscriptBox["Q2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"q2", " ", "q3", " ", "x"}], 
              RowBox[{"2", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{
               SuperscriptBox["q3", "2"], " ", "x"}], 
              RowBox[{"2", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]]}], ")"}]}], 
          RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}]]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "q1", " ", "q2", " ", 
           SuperscriptBox["q3", "2"]}], 
          RowBox[{"3", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["q3", "2"]}], 
          RowBox[{"12", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], "2"]}]], "-", 
         FractionBox[
          RowBox[{"2", " ", "q1", " ", 
           SuperscriptBox["q3", "3"]}], 
          RowBox[{"3", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], "2"]}]], "+", 
         FractionBox[
          RowBox[{"2", " ", "q2", " ", 
           SuperscriptBox["q3", "3"]}], 
          RowBox[{"3", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], "2"]}]]}], ")"}]}]}]}], ",", 
    RowBox[{"r2", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"Q1", " ", "q3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"8", " ", "q1", " ", "q2"}], "+", 
           SuperscriptBox["q2", "2"], "-", 
           RowBox[{"8", " ", "q1", " ", "q3"}], "+", 
           RowBox[{"8", " ", "q2", " ", "q3"}]}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "3"], " ", "q2", " ", "Q2"}], "-", 
         RowBox[{"2", " ", "k1", " ", "q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
         RowBox[{"4", " ", "m", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["q1", "2"], " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
         RowBox[{"4", " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["Q1", "3"], " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
         RowBox[{"k1", " ", 
          SuperscriptBox["q2", "3"], " ", "Q2"}], "-", 
         RowBox[{"2", " ", "m", " ", "Q1", " ", 
          SuperscriptBox["q2", "3"], " ", "Q2"}], "-", 
         RowBox[{"4", " ", "c", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["q2", "3"], " ", "Q2"}], "+", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", 
          SuperscriptBox["q2", "3"], " ", "Q2"}], "-", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "4"], " ", "Q2"}], "+", 
         RowBox[{"4", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "3"]}], "-", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["Q2", "3"]}], "-", 
         RowBox[{"4", " ", "k2", " ", "q1", " ", "Q1", " ", "q2", " ", "q3"}],
          "-", 
         RowBox[{"2", " ", "k2", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "q3"}], "+", 
         RowBox[{"4", " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "3"], " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"2", " ", "k1", " ", "q1", " ", "q2", " ", "Q2", " ", "q3"}],
          "+", 
         RowBox[{
         "4", " ", "m", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", 
          "q3"}], "-", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["q1", "2"], " ", "Q1", " ", "q2", " ", "Q2", " ", 
          "q3"}], "-", 
         RowBox[{"4", " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"4", " ", "c", " ", 
          SuperscriptBox["Q1", "3"], " ", "q2", " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"2", " ", "k1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"2", " ", "m", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"4", " ", "c", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"4", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["q2", "3"], " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"8", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "-", 
         RowBox[{"4", " ", "c", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["Q2", "3"], " ", "q3"}], "+", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "3"], " ", "q3"}], "+", 
         RowBox[{"4", " ", "k2", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"4", " ", "k2", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{
         "4", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"8", " ", "c", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["Q2", "2"], " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"8", " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"4", " ", "c", " ", "q1", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "3"]}], "+", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q3", "3"]}], "+", 
         RowBox[{"6", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "x"}], "+", 
         RowBox[{"3", " ", "Q1", " ", 
          SuperscriptBox["q2", "3"], " ", "Q2", " ", "x"}], "-", 
         RowBox[{
         "10", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3", " ", 
          "x"}], "+", 
         RowBox[{"Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", "x"}], "+", 
         RowBox[{"4", " ", "q1", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "x"}], "-", 
         RowBox[{"4", " ", "Q1", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "x"}]}], ")"}]}]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.672401470363143*^9}]
}, Open  ]],

Cell["\<\
The final step is to find the new equation if the price constraint is \
violated \
\>", "Text",
 CellChangeTimes->{{3.733848287684539*^9, 3.733848320957549*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6724030599363832`*^9, 3.6724030629906178`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q3", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "k2"}], "+", "r2"}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["Q2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]]}], "+", 
      FractionBox[
       RowBox[{"q3", " ", 
        RowBox[{"(", 
         RowBox[{"x", "-", 
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{"c", " ", 
               SuperscriptBox["Q1", "2"]}], "2"]}], "+", 
            RowBox[{"c", " ", "Q1", " ", "q2"}], "-", 
            FractionBox[
             RowBox[{"c", " ", 
              SuperscriptBox["q2", "2"]}], "2"], "+", 
            FractionBox[
             RowBox[{"c", " ", 
              SuperscriptBox["Q2", "2"]}], "2"], "-", 
            RowBox[{"c", " ", "Q2", " ", "q3"}], "+", 
            FractionBox[
             RowBox[{"c", " ", 
              SuperscriptBox["q3", "2"]}], "2"], "-", 
            FractionBox[
             RowBox[{"q2", " ", "r1"}], 
             RowBox[{"2", " ", "Q1"}]], "+", 
            FractionBox[
             RowBox[{"q3", " ", "r2"}], 
             RowBox[{"2", " ", "Q2"}]], "-", 
            FractionBox[
             RowBox[{"q2", " ", "x"}], "2"], "+", 
            FractionBox[
             RowBox[{"q3", " ", "x"}], "2"]}], 
           RowBox[{
            RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "Q2"]}], ")"}], 
    "\[Equal]", "0"}], ",", "r2"}], "]"}]], "Input",
 CellChangeTimes->{{3.672403177566866*^9, 3.67240320098549*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["Q2", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"c", " ", 
            SuperscriptBox["Q1", "2"], " ", "q3"}], 
           RowBox[{"2", " ", "Q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]]}], "+", 
         FractionBox[
          RowBox[{"c", " ", "Q1", " ", "q2", " ", "q3"}], 
          RowBox[{"Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["q2", "2"], " ", "q3"}], 
          RowBox[{"2", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", 
         FractionBox[
          RowBox[{"c", " ", "Q2", " ", "q3"}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["q3", "2"]}], 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}]], "-", 
         FractionBox[
          RowBox[{"k2", " ", 
           SuperscriptBox["q3", "2"]}], 
          RowBox[{"2", " ", 
           SuperscriptBox["Q2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["q3", "3"]}], 
          RowBox[{"2", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"q2", " ", "q3", " ", "r1"}], 
          RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"q3", " ", "x"}], "Q2"], "-", 
         FractionBox[
          RowBox[{"q2", " ", "q3", " ", "x"}], 
          RowBox[{"2", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["q3", "2"], " ", "x"}], 
          RowBox[{"2", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]]}], ")"}]}], 
      SuperscriptBox["q3", "2"]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.672403204999734*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q2", "*", 
    RowBox[{"r1", "/", "Q1"}]}], "+", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q1"}], ")"}], "^", "2"}]}], "-", 
   RowBox[{"q2", "*", 
    RowBox[{"r2", "/", "Q2"}]}], "-", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q2"}], ")"}], "^", "2"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["Q2", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"c", " ", 
            SuperscriptBox["Q1", "2"], " ", "q3"}], 
           RowBox[{"2", " ", "Q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]]}], "+", 
         FractionBox[
          RowBox[{"c", " ", "Q1", " ", "q2", " ", "q3"}], 
          RowBox[{"Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["q2", "2"], " ", "q3"}], 
          RowBox[{"2", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", 
         FractionBox[
          RowBox[{"c", " ", "Q2", " ", "q3"}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["q3", "2"]}], 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}]], "-", 
         FractionBox[
          RowBox[{"k2", " ", 
           SuperscriptBox["q3", "2"]}], 
          RowBox[{"2", " ", 
           SuperscriptBox["Q2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", 
         FractionBox[
          RowBox[{"c", " ", 
           SuperscriptBox["q3", "3"]}], 
          RowBox[{"2", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"q2", " ", "q3", " ", "r1"}], 
          RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"q3", " ", "x"}], "Q2"], "-", 
         FractionBox[
          RowBox[{"q2", " ", "q3", " ", "x"}], 
          RowBox[{"2", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["q3", "2"], " ", "x"}], 
          RowBox[{"2", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]]}], ")"}]}], 
      SuperscriptBox["q3", "2"]]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.672403281218449*^9, 3.672403397708111*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q2", " ", "r1"}], "Q1"], "+", 
  FractionBox[
   RowBox[{"q2", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"c", " ", 
         SuperscriptBox["Q1", "2"], " ", "q3"}], 
        RowBox[{"2", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]]}], "+", 
      FractionBox[
       RowBox[{"c", " ", "Q1", " ", "q2", " ", "q3"}], 
       RowBox[{"Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"c", " ", 
        SuperscriptBox["q2", "2"], " ", "q3"}], 
       RowBox[{"2", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{"c", " ", "Q2", " ", "q3"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"c", " ", 
        SuperscriptBox["q3", "2"]}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]], "-", 
      FractionBox[
       RowBox[{"k2", " ", 
        SuperscriptBox["q3", "2"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Q2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{"c", " ", 
        SuperscriptBox["q3", "3"]}], 
       RowBox[{"2", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"q2", " ", "q3", " ", "r1"}], 
       RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"q3", " ", "x"}], "Q2"], "-", 
      FractionBox[
       RowBox[{"q2", " ", "q3", " ", "x"}], 
       RowBox[{"2", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["q3", "2"], " ", "x"}], 
       RowBox[{"2", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]]}], ")"}]}], 
   SuperscriptBox["q3", "2"]]}]], "Output",
 CellChangeTimes->{3.672403400061771*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%24", "\[Equal]", "0"}], ",", "r1"}], "]"}]], "Input",
 CellChangeTimes->{{3.6724034080796623`*^9, 3.6724034342223454`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", 
    RowBox[{"-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"q2", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}]], 
      RowBox[{"Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2"}], "-", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["q2", "3"], " ", "Q2"}], "-", 
         RowBox[{"c", " ", "q2", " ", 
          SuperscriptBox["Q2", "3"]}], "+", 
         RowBox[{"k2", " ", "q2", " ", "q3"}], "-", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3"}], 
         "-", 
         RowBox[{"2", " ", "c", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q2", "3"], " ", "q3"}], "-", 
         RowBox[{"c", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "x"}], "+", 
         RowBox[{"q2", " ", "Q2", " ", "q3", " ", "x"}]}], ")"}]}]}]}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{3.672403445207047*^9}]
}, Open  ]]
},
WindowSize->{1280, 981},
WindowMargins->{{Automatic, 132}, {Automatic, -8}},
FrontEndVersion->"10.4 for Linux x86 (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 570, 14, 77, "Text"],
Cell[CellGroupData[{
Cell[1152, 38, 154, 5, 58, "Input"],
Cell[1309, 45, 223, 8, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1569, 58, 230, 8, 58, "Input"],
Cell[1802, 68, 341, 13, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2180, 86, 227, 6, 58, "Input"],
Cell[2410, 94, 228, 8, 51, "Output"]
}, Open  ]],
Cell[2653, 105, 190, 6, 77, "Text"],
Cell[CellGroupData[{
Cell[2868, 115, 371, 10, 32, "Input"],
Cell[3242, 127, 903, 34, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4182, 166, 368, 10, 32, "Input"],
Cell[4553, 178, 1327, 50, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5917, 233, 371, 10, 32, "Input"],
Cell[6291, 245, 938, 35, 64, "Output"]
}, Open  ]],
Cell[7244, 283, 257, 6, 55, "Text"],
Cell[CellGroupData[{
Cell[7526, 293, 243, 5, 34, "Input"],
Cell[7772, 300, 640, 24, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8449, 329, 306, 7, 34, "Input"],
Cell[8758, 338, 1710, 65, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10505, 408, 280, 7, 34, "Input"],
Cell[10788, 417, 1085, 41, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11910, 463, 398, 10, 32, "Input"],
Cell[12311, 475, 3320, 95, 146, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15668, 575, 3855, 110, 198, "Input"],
Cell[19526, 687, 5937, 154, 366, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25500, 846, 192, 4, 32, "Input"],
Cell[25695, 852, 4264, 112, 156, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29996, 969, 3701, 105, 198, "Input"],
Cell[33700, 1076, 1295, 41, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35032, 1122, 1495, 45, 101, "Input"],
Cell[36530, 1169, 1068, 30, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37635, 1204, 284, 6, 32, "Input"],
Cell[37922, 1212, 6728, 192, 391, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44687, 1409, 152, 3, 32, "Input"],
Cell[44842, 1414, 2728, 64, 129, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47607, 1483, 233, 5, 32, "Input"],
Cell[47843, 1490, 1454, 47, 90, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49334, 1542, 1515, 49, 102, "Input"],
Cell[50852, 1593, 909, 24, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51798, 1622, 426, 11, 32, "Input"],
Cell[52227, 1635, 13770, 326, 487, "Output"]
}, Open  ]],
Cell[66012, 1964, 171, 4, 33, "Text"],
Cell[66186, 1970, 96, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[66307, 1975, 1776, 52, 138, "Input"],
Cell[68086, 2029, 2812, 82, 136, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70935, 2116, 3191, 95, 136, "Input"],
Cell[74129, 2213, 2784, 89, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76950, 2307, 185, 4, 32, "Input"],
Cell[77138, 2313, 1474, 37, 85, "Output"]
}, Open  ]]
}
]
*)

