(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    104285,       3144]
NotebookOptionsPosition[    100525,       3008]
NotebookOutlinePosition[    100862,       3023]
CellTagsIndexPosition[    100819,       3020]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "First step is to define the demands based on the prices and qualities, \
which follows the \[Theta] definition. B1 has the lowest quality in the \
market and B3 has the highest quality. In this part we assum that B2 buys \
from S1. B1 & B2 Cooperate\nm here is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]]],
 " and x is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "min"], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{
  3.7338523689968357`*^9, {3.7338524344374123`*^9, 3.733852436445113*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D1", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p2", "-", "p1"}], 
    RowBox[{"q2", "-", "q1"}]], "-", "m"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "m"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]]}]], "Output",
 CellChangeTimes->{3.672496590277094*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D2", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p3", "-", "p2"}], 
    RowBox[{"q3", "-", "q2"}]], "-", 
   FractionBox[
    RowBox[{"p2", "-", "p1"}], 
    RowBox[{"q2", "-", "q1"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p1"}], "+", "p2"}], 
    RowBox[{
     RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]]}]], "Output",
 CellChangeTimes->{3.672496599868854*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D3", "=", " ", 
  RowBox[{"x", "-", " ", 
   FractionBox[
    RowBox[{"p3", "-", "p2"}], 
    RowBox[{"q3", "-", "q2"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p2"}], "+", "p3"}], 
    RowBox[{
     RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", "x"}]], "Output",
 CellChangeTimes->{3.672496611958584*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]1", "=", " ", 
  RowBox[{
   RowBox[{"D1", "*", "p1"}], "-", 
   RowBox[{
    RowBox[{"q1", "/", "Q1"}], "*", "D1", "*", "r1"}], "-", 
   RowBox[{"c", "*", "D1", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "^", "2"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "m"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p1"}], "+", "p2"}], 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q1", "-", "Q1"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "m"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p1"}], "+", "p2"}], 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "m"}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.672496670018641*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]2", "=", " ", 
  RowBox[{
   RowBox[{"D2", "*", "p2"}], "-", 
   RowBox[{
    RowBox[{"q2", "/", "Q1"}], "*", "D2", "*", "r1"}], "-", 
   RowBox[{"c", "*", "D2", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q1"}], ")"}], "^", "2"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p2"}], "+", "p3"}], 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p2"}], "+", "p3"}], 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p1"}], "+", "p2"}], 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.672496677890873*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]3", "=", " ", 
  RowBox[{
   RowBox[{"D3", "*", "p3"}], "-", 
   RowBox[{
    RowBox[{"q3", "/", "Q2"}], "*", "D3", "*", "r2"}], "-", 
   RowBox[{"c", "*", "D3", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q3", "-", "Q2"}], ")"}], "^", "2"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", "x"}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", "x"}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q3", " ", "r2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p2"}], "+", "p3"}], 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", "x"}], ")"}]}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.672496684964843*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p1"], 
  RowBox[{"(", 
   RowBox[{"\[CapitalPi]1", "+", "\[CapitalPi]2"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.672496695509548*^9, 3.672496704931243*^9}, 
   3.672498612713665*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "m"}], "-", 
  FractionBox["p1", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox["p2", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{"q1", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"q2", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.672496707263064*^9, 3.6724986163950644`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p2"], 
  RowBox[{"(", 
   RowBox[{"\[CapitalPi]1", "+", "\[CapitalPi]2"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.67249862294236*^9, 3.6724986372659607`*^9}, {
  3.672498680721472*^9, 3.6724986848619823`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["p1", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
  RowBox[{"p2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q1", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.672498687071599*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p3"], "\[CapitalPi]3"}]], "Input",
 CellChangeTimes->{{3.6724986924967327`*^9, 3.67249871289041*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["p3", 
    RowBox[{
     RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
  FractionBox[
   RowBox[{"q3", " ", "r2"}], 
   RowBox[{"Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", "x"}]], "Output",
 CellChangeTimes->{3.6724987141037397`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"%11", "\[Equal]", "0"}], "&&", 
     RowBox[{"%9", "\[Equal]", "0"}], "&&", 
     RowBox[{"%10", "\[Equal]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"%9", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "p1"], 
      RowBox[{"(", 
       RowBox[{"\[CapitalPi]1", "+", "\[CapitalPi]2"}], ")"}]}]}], ",", " ", "...",
     ",", " ", 
    RowBox[{"%11", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "p3"], "\[CapitalPi]3"}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.6724987191382647`*^9, 3.672498767007622*^9}, {
  3.7338524460779467`*^9, 3.733852530191852*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"6", " ", "Q1", " ", "Q2"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "m", " ", "q1", " ", "Q1", " ", "Q2"}], 
         "-", 
         RowBox[{"3", " ", "c", " ", 
          SuperscriptBox["q1", "2"], " ", "Q1", " ", "Q2"}], "+", 
         RowBox[{"6", " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "2"], " ", "Q2"}], "-", 
         RowBox[{"4", " ", "c", " ", 
          SuperscriptBox["Q1", "3"], " ", "Q2"}], "-", 
         RowBox[{"m", " ", "Q1", " ", "q2", " ", "Q2"}], "+", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2"}], "-", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "3"]}], "+", 
         RowBox[{"4", " ", "m", " ", "Q1", " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "-", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"3", " ", "q1", " ", "Q2", " ", "r1"}], "-", 
         RowBox[{"q2", " ", "Q2", " ", "r1"}], "-", 
         RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
         RowBox[{"2", " ", "Q1", " ", "q2", " ", "Q2", " ", "x"}], "-", 
         RowBox[{"2", " ", "Q1", " ", "Q2", " ", "q3", " ", "x"}]}], 
        ")"}]}]}]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", "c", " ", 
        SuperscriptBox["Q1", "2"]}], "3"], "+", 
      FractionBox[
       RowBox[{"2", " ", "m", " ", "q2"}], "3"], "-", 
      FractionBox[
       RowBox[{"4", " ", "c", " ", "Q1", " ", "q2"}], "3"], "+", 
      FractionBox[
       RowBox[{"2", " ", "c", " ", 
        SuperscriptBox["q2", "2"]}], "3"], "+", 
      FractionBox[
       RowBox[{"c", " ", 
        SuperscriptBox["Q2", "2"]}], "3"], "-", 
      FractionBox[
       RowBox[{"2", " ", "m", " ", "q3"}], "3"], "-", 
      FractionBox[
       RowBox[{"2", " ", "c", " ", "Q2", " ", "q3"}], "3"], "+", 
      FractionBox[
       RowBox[{"c", " ", 
        SuperscriptBox["q3", "2"]}], "3"], "+", 
      FractionBox[
       RowBox[{"2", " ", "q2", " ", "r1"}], 
       RowBox[{"3", " ", "Q1"}]], "+", 
      FractionBox[
       RowBox[{"q3", " ", "r2"}], 
       RowBox[{"3", " ", "Q2"}]], "-", 
      FractionBox[
       RowBox[{"q2", " ", "x"}], "3"], "+", 
      FractionBox[
       RowBox[{"q3", " ", "x"}], "3"]}]}], ",", 
    RowBox[{"p3", "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m", " ", "Q1"}], "+", 
          RowBox[{"c", " ", "q1", " ", "Q1"}], "-", 
          RowBox[{"2", " ", "c", " ", 
           SuperscriptBox["Q1", "2"]}], "+", 
          RowBox[{"c", " ", "Q1", " ", "q2"}], "+", "r1"}], ")"}]}], 
       RowBox[{"4", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "c"}], " ", 
         SuperscriptBox["Q2", "3"]}], "+", 
        RowBox[{"2", " ", "c", " ", 
         SuperscriptBox["Q2", "2"], " ", "q3"}], "-", 
        RowBox[{"c", " ", "Q2", " ", 
         SuperscriptBox["q3", "2"]}], "-", 
        RowBox[{"q3", " ", "r2"}], "+", 
        RowBox[{"q2", " ", "Q2", " ", "x"}], "-", 
        RowBox[{"Q2", " ", "q3", " ", "x"}]}], 
       RowBox[{"2", " ", "Q2"}]], "-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"12", " ", "Q1", " ", "Q2"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "m", " ", "q1", " ", "Q1", " ", "Q2"}], 
         "-", 
         RowBox[{"3", " ", "c", " ", 
          SuperscriptBox["q1", "2"], " ", "Q1", " ", "Q2"}], "+", 
         RowBox[{"6", " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "2"], " ", "Q2"}], "-", 
         RowBox[{"4", " ", "c", " ", 
          SuperscriptBox["Q1", "3"], " ", "Q2"}], "-", 
         RowBox[{"m", " ", "Q1", " ", "q2", " ", "Q2"}], "+", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2"}], "-", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "3"]}], "+", 
         RowBox[{"4", " ", "m", " ", "Q1", " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "-", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"3", " ", "q1", " ", "Q2", " ", "r1"}], "-", 
         RowBox[{"q2", " ", "Q2", " ", "r1"}], "-", 
         RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
         RowBox[{"2", " ", "Q1", " ", "q2", " ", "Q2", " ", "x"}], "-", 
         RowBox[{"2", " ", "Q1", " ", "Q2", " ", "q3", " ", "x"}]}], 
        ")"}]}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.672498777228712*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%12", "]"}]], "Input",
 CellChangeTimes->{{3.672498817703164*^9, 3.672498831463551*^9}},
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", 
       SuperscriptBox["q1", "2"]}], "-", 
      RowBox[{"6", " ", "q1", " ", "Q1"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["Q1", "2"]}], "-", 
      RowBox[{"2", " ", "Q1", " ", "q2"}], "+", 
      SuperscriptBox["q2", "2"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}]}], ")"}]}], "+", 
   RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "q1"}], "+", "q2", "-", 
      RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
   RowBox[{"3", " ", "q1", " ", "Q2", " ", "r1"}], "+", 
   RowBox[{"q2", " ", "Q2", " ", "r1"}], "+", 
   RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
   RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
  RowBox[{"6", " ", "Q1", " ", "Q2"}]]], "Output",
 CellChangeTimes->{{3.6724988073430033`*^9, 3.6724988334813347`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U1", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"D1", "*", 
         RowBox[{"q1", "/", "Q1"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"D2", "*", 
         RowBox[{"q2", "/", "Q1"}]}], ")"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"r1", "-", "k1"}], ")"}]}], "-", 
    RowBox[{"e", "*", 
     RowBox[{"Q1", "^", "2"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "->", 
      FractionBox[
       RowBox[{
        RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", 
            SuperscriptBox["q1", "2"]}], "-", 
           RowBox[{"6", " ", "q1", " ", "Q1"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["Q1", "2"]}], "-", 
           RowBox[{"2", " ", "Q1", " ", "q2"}], "+", 
           SuperscriptBox["q2", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1"}], "+", "q2", "-", 
           RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
        RowBox[{"3", " ", "q1", " ", "Q2", " ", "r1"}], "+", 
        RowBox[{"q2", " ", "Q2", " ", "r1"}], "+", 
        RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
        RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
       RowBox[{"6", " ", "Q1", " ", "Q2"}]]}], ",", 
     RowBox[{"p2", "->", 
      FractionBox[
       RowBox[{
        RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"Q1", "-", "q2"}], ")"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], ")"}]}], "+", 
        RowBox[{"2", " ", "m", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"2", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
        RowBox[{"Q1", " ", "q3", " ", "r2"}], "-", 
        RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "x"}], "+", 
        RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "x"}]}], 
       RowBox[{"3", " ", "Q1", " ", "Q2"}]]}], ",", " ", 
     RowBox[{"p3", "->", 
      FractionBox[
       RowBox[{
        RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Q1", "-", "q2"}], ")"}], "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"q2", " ", "Q2", " ", "r1"}], "+", 
        RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
        RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
       RowBox[{"3", " ", "Q1", " ", "Q2"}]]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.672498953509315*^9, 3.6724989861691837`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "e"}], " ", 
   SuperscriptBox["Q1", "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "k1"}], "+", "r1"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "Q1"], 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"Q1", "-", "q2"}], ")"}], "2"]}], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "m", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
              RowBox[{"2", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
              RowBox[{"Q1", " ", "q3", " ", "r2"}], "-", 
              RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "x"}], "+", 
              RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "x"}]}], 
             RowBox[{"3", " ", "Q1", " ", "Q2"}]]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"Q1", "-", "q2"}], ")"}], "2"], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}]}], ")"}]}], "+", 
             RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
             RowBox[{"q2", " ", "Q2", " ", "r1"}], "+", 
             RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
             RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
            RowBox[{"3", " ", "Q1", " ", "Q2"}]]}], 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}]], "-", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"Q1", "-", "q2"}], ")"}], "2"]}], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "m", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
              RowBox[{"2", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
              RowBox[{"Q1", " ", "q3", " ", "r2"}], "-", 
              RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "x"}], "+", 
              RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "x"}]}], 
             RowBox[{"3", " ", "Q1", " ", "Q2"}]], "-", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q1", " ", "Q2"}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   SuperscriptBox["q1", "2"]}], "-", 
                  RowBox[{"6", " ", "q1", " ", "Q1"}], "+", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["Q1", "2"]}], "-", 
                  RowBox[{"2", " ", "Q1", " ", "q2"}], "+", 
                  SuperscriptBox["q2", "2"], "+", 
                  RowBox[{"2", " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}]}], ")"}]}], "+", 
               
               RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "q1"}], "+", "q2", "-", 
                  RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
               RowBox[{"3", " ", "q1", " ", "Q2", " ", "r1"}], "+", 
               RowBox[{"q2", " ", "Q2", " ", "r1"}], "+", 
               RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
               RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
              ")"}]}]}], ")"}]}]}], ")"}]}]}], "+", 
     RowBox[{
      FractionBox["1", "Q1"], 
      RowBox[{"q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "m"}], "+", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"Q1", "-", "q2"}], ")"}], "2"]}], "+", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "m", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
              RowBox[{"2", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
              RowBox[{"Q1", " ", "q3", " ", "r2"}], "-", 
              RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "x"}], "+", 
              RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "x"}]}], 
             RowBox[{"3", " ", "Q1", " ", "Q2"}]], "-", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q1", " ", "Q2"}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   SuperscriptBox["q1", "2"]}], "-", 
                  RowBox[{"6", " ", "q1", " ", "Q1"}], "+", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["Q1", "2"]}], "-", 
                  RowBox[{"2", " ", "Q1", " ", "q2"}], "+", 
                  SuperscriptBox["q2", "2"], "+", 
                  RowBox[{"2", " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}]}], ")"}]}], "+", 
               
               RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "q1"}], "+", "q2", "-", 
                  RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
               RowBox[{"3", " ", "q1", " ", "Q2", " ", "r1"}], "+", 
               RowBox[{"q2", " ", "Q2", " ", "r1"}], "+", 
               RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
               RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
              ")"}]}]}], ")"}]}]}], ")"}]}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.672499006365556*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%22", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"6", " ", 
    SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q3"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"6", " ", "e", " ", 
     SuperscriptBox["Q1", "4"], " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "+", 
    RowBox[{"r1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "m"}], " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["q1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
          RowBox[{"6", " ", "q1", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "-", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              SuperscriptBox["Q1", "2"]}], "+", 
             SuperscriptBox["q2", "2"], "-", 
             RowBox[{"2", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", 
                RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "-", 
             RowBox[{"3", " ", "q2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "-", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "-", 
       RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3", " ", "r1"}], "+", 
       RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
       RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
       RowBox[{"2", " ", "Q1", " ", "q2", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", "x"}]}], ")"}]}], "+", 
    RowBox[{"k1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", 
              SuperscriptBox["q1", "2"]}], "+", 
             RowBox[{"6", " ", "q1", " ", "Q1"}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["Q1", "2"]}], "-", 
             RowBox[{"2", " ", "Q1", " ", "q2"}], "+", 
             SuperscriptBox["q2", "2"], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["Q2", "2"]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "q2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", 
                RowBox[{"2", " ", "Q1"}], "+", "q2"}], ")"}]}], "-", 
             RowBox[{"4", " ", "q2", " ", "Q2"}]}], ")"}], " ", "q3"}], "+", 
          RowBox[{"2", " ", "q2", " ", 
           SuperscriptBox["q3", "2"]}]}], ")"}]}], "-", 
       RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "+", 
       RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
       RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "r1"}], "+", 
       RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
       RowBox[{"2", " ", "Q1", " ", "q2", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.672499012610327*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"D3", "*", 
       RowBox[{"q3", "/", "Q2"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"r2", "-", "k2"}], ")"}]}], "-", 
    RowBox[{"e", "*", 
     RowBox[{"Q2", "^", "2"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "->", 
      FractionBox[
       RowBox[{
        RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", 
            SuperscriptBox["q1", "2"]}], "-", 
           RowBox[{"6", " ", "q1", " ", "Q1"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["Q1", "2"]}], "-", 
           RowBox[{"2", " ", "Q1", " ", "q2"}], "+", 
           SuperscriptBox["q2", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1"}], "+", "q2", "-", 
           RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
        RowBox[{"3", " ", "q1", " ", "Q2", " ", "r1"}], "+", 
        RowBox[{"q2", " ", "Q2", " ", "r1"}], "+", 
        RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
        RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
       RowBox[{"6", " ", "Q1", " ", "Q2"}]]}], ",", 
     RowBox[{"p2", "->", 
      FractionBox[
       RowBox[{
        RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"Q1", "-", "q2"}], ")"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], ")"}]}], "+", 
        RowBox[{"2", " ", "m", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"2", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
        RowBox[{"Q1", " ", "q3", " ", "r2"}], "-", 
        RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "x"}], "+", 
        RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "x"}]}], 
       RowBox[{"3", " ", "Q1", " ", "Q2"}]]}], ",", " ", 
     RowBox[{"p3", "->", 
      FractionBox[
       RowBox[{
        RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Q1", "-", "q2"}], ")"}], "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}]}], ")"}]}], "+", 
        RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"q2", " ", "Q2", " ", "r1"}], "+", 
        RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
        RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
       RowBox[{"3", " ", "Q1", " ", "Q2"}]]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.672499044324134*^9, 3.672499054724506*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "e"}], " ", 
   SuperscriptBox["Q2", "2"]}], "+", 
  FractionBox[
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "k2"}], "+", "r2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"x", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"Q1", "-", "q2"}], ")"}], "2"]}], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], ")"}]}], "+", 
           RowBox[{"2", " ", "m", " ", "Q1", " ", "Q2", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
           RowBox[{"2", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
           RowBox[{"Q1", " ", "q3", " ", "r2"}], "-", 
           RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "x"}], "+", 
           RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "x"}]}], 
          RowBox[{"3", " ", "Q1", " ", "Q2"}]]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"Q1", "-", "q2"}], ")"}], "2"], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}]}], ")"}]}], "+", 
          RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
          RowBox[{"q2", " ", "Q2", " ", "r1"}], "+", 
          RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
          RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
         RowBox[{"3", " ", "Q1", " ", "Q2"}]]}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "Q2"]}]], "Output",
 CellChangeTimes->{3.6724990684568577`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%24", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"3", " ", "e", " ", "Q1", " ", 
    SuperscriptBox["Q2", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "+", 
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{"k2", "-", "r2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
      RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{"Q1", "-", "q2", "+", "Q2", "-", "q3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"Q1", "-", "q2", "-", "Q2", "+", "q3"}], ")"}]}], "+", 
      RowBox[{"q2", " ", "Q2", " ", "r1"}], "-", 
      RowBox[{"Q1", " ", "q3", " ", "r2"}], "+", 
      RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], ")"}]}]}], 
  RowBox[{"3", " ", "Q1", " ", 
   SuperscriptBox["Q2", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"q2", "-", "q3"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.672499072438039*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "r1"], "%23", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"%23", " ", ":", " ", 
    RowBox[{"Simplify", "[", "U1", "]"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.672499077414405*^9, 3.672499089054727*^9}, {
  3.733852566944973*^9, 3.733852583865471*^9}, {3.733852792654943*^9, 
  3.733852794878928*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"6", " ", 
    SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q3"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "m"}], " ", "Q1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
    RowBox[{"k1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "q1", " ", "q2", " ", "Q2"}], "+", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
       RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3"}], "-", 
       RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3"}]}], ")"}]}], "+", 
    RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["q1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"6", " ", "q1", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "-", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["Q1", "2"]}], "+", 
          SuperscriptBox["q2", "2"], "-", 
          RowBox[{"2", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", 
             RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "-", 
          RowBox[{"3", " ", "q2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "-", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "-", 
    RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3", " ", "r1"}], "+", 
    RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "r1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2"}], "-", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
       RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3"}], "+", 
       RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3"}]}], ")"}], " ", "r1"}], 
    "-", 
    RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
    RowBox[{"2", " ", "Q1", " ", "q2", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}], " ", "x"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.672499090482168*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "r2"], "%25", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"%25", " ", ":", " ", 
    RowBox[{"Simplify", "[", "U2", "]"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6724991018480663`*^9, 3.672499115772088*^9}, {
  3.733852595065743*^9, 3.7338526000737457`*^9}, {3.733852800839333*^9, 
  3.733852803367271*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "Q1"}], " ", 
    SuperscriptBox["q3", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"k2", "-", "r2"}], ")"}]}], "-", 
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
      RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{"Q1", "-", "q2", "+", "Q2", "-", "q3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"Q1", "-", "q2", "-", "Q2", "+", "q3"}], ")"}]}], "+", 
      RowBox[{"q2", " ", "Q2", " ", "r1"}], "-", 
      RowBox[{"Q1", " ", "q3", " ", "r2"}], "+", 
      RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], ")"}]}]}], 
  RowBox[{"3", " ", "Q1", " ", 
   SuperscriptBox["Q2", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"q2", "-", "q3"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.672499135216907*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"%26", "\[Equal]", "0"}], "&&", 
     RowBox[{"%28", "\[Equal]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r1", ",", "r2"}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"%26", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "r1"], "U1"}]}], ",", " ", 
    RowBox[{"%28", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "r2"], "U2"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.672499149518057*^9, 3.672499168241096*^9}, {
  3.733852603722447*^9, 3.7338526381390333`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"r1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "q1"}], "+", "q2"}], ")"}]}], 
               RowBox[{"6", " ", "Q1"}]]}], "+", 
             FractionBox[
              RowBox[{"k1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], " ", "q1", " ", "q2", " ", "Q2"}], "+", 
                 
                 RowBox[{
                  SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
                 RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3"}], "-", 
                 RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3"}]}], ")"}]}], 
              RowBox[{"6", " ", 
               SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"c", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", 
                  SuperscriptBox["q1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
                 RowBox[{"6", " ", "q1", " ", "Q1", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "-", 
                 RowBox[{"q2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    SuperscriptBox["Q1", "2"]}], "+", 
                    SuperscriptBox["q2", "2"], "-", 
                    RowBox[{"2", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "-", 
                    RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "-", 
                    RowBox[{"3", " ", "q2", " ", "q3"}]}], ")"}]}]}], ")"}]}], 
              RowBox[{"6", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"q2", " ", "x"}], 
              RowBox[{"3", " ", "Q1"}]]}], ")"}]}], 
          RowBox[{"3", " ", 
           SuperscriptBox["Q2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
         FractionBox[
          RowBox[{"q2", " ", "q3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"m", " ", "q3"}], 
               RowBox[{"3", " ", "Q2"}]]}], "-", 
             FractionBox[
              RowBox[{"k2", " ", 
               SuperscriptBox["q3", "2"]}], 
              RowBox[{"3", " ", 
               SuperscriptBox["Q2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"c", " ", 
               RowBox[{"(", 
                RowBox[{"Q1", "-", "q2", "+", "Q2", "-", "q3"}], ")"}], " ", 
               "q3", " ", 
               RowBox[{"(", 
                RowBox[{"Q1", "-", "q2", "-", "Q2", "+", "q3"}], ")"}]}], 
              RowBox[{"3", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"2", " ", "q3", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}], 
              RowBox[{"3", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]]}], ")"}]}], 
          RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}]]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "q1", " ", "q2", " ", 
           SuperscriptBox["q3", "2"]}], 
          RowBox[{"3", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], "2"]}]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["q3", "2"]}], 
          RowBox[{"3", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], "2"]}]], "-", 
         FractionBox[
          RowBox[{"2", " ", "q1", " ", 
           SuperscriptBox["q3", "3"]}], 
          RowBox[{"3", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], "2"]}]], "+", 
         FractionBox[
          RowBox[{"2", " ", "q2", " ", 
           SuperscriptBox["q3", "3"]}], 
          RowBox[{"3", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], "2"]}]]}], ")"}]}]}]}], ",", 
    RowBox[{"r2", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", 
          SuperscriptBox["Q1", "2"], " ", "Q2"}], "-", 
         RowBox[{"m", " ", "q2", " ", "Q2"}], "+", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "q2", " ", "Q2"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["Q2", "3"]}], "-", 
         RowBox[{"k2", " ", "q3"}], "+", 
         RowBox[{"m", " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
         RowBox[{"c", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"2", " ", "q2", " ", "Q2", " ", "x"}], "-", 
         RowBox[{"2", " ", "Q2", " ", "q3", " ", "x"}]}], 
        RowBox[{"2", " ", "q3"}]]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q2", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["q3", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"m", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"3", " ", "q1"}], "+", "q2"}], ")"}]}], 
                 RowBox[{"6", " ", "Q1"}]]}], "+", 
               FractionBox[
                RowBox[{"k1", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "3"}], " ", "q1", " ", "q2", " ", "Q2"}], 
                   "+", 
                   RowBox[{
                    SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
                   RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3"}], "-", 
                   RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3"}]}], ")"}]}], 
                
                RowBox[{"6", " ", 
                 SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
               FractionBox[
                RowBox[{"c", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", " ", 
                    SuperscriptBox["q1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
                   RowBox[{"6", " ", "q1", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "-", 
                   RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    SuperscriptBox["Q1", "2"]}], "+", 
                    SuperscriptBox["q2", "2"], "-", 
                    RowBox[{"2", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "-", 
                    RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "-", 
                    RowBox[{"3", " ", "q2", " ", "q3"}]}], ")"}]}]}], ")"}]}], 
                RowBox[{"6", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
               FractionBox[
                RowBox[{"q2", " ", "x"}], 
                RowBox[{"3", " ", "Q1"}]]}], ")"}]}], 
            RowBox[{"3", " ", 
             SuperscriptBox["Q2", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
           FractionBox[
            RowBox[{"q2", " ", "q3", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"m", " ", "q3"}], 
                 RowBox[{"3", " ", "Q2"}]]}], "-", 
               FractionBox[
                RowBox[{"k2", " ", 
                 SuperscriptBox["q3", "2"]}], 
                RowBox[{"3", " ", 
                 SuperscriptBox["Q2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
               FractionBox[
                RowBox[{"c", " ", 
                 RowBox[{"(", 
                  RowBox[{"Q1", "-", "q2", "+", "Q2", "-", "q3"}], ")"}], " ",
                  "q3", " ", 
                 RowBox[{"(", 
                  RowBox[{"Q1", "-", "q2", "-", "Q2", "+", "q3"}], ")"}]}], 
                RowBox[{"3", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
               FractionBox[
                RowBox[{"2", " ", "q3", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}], 
                RowBox[{"3", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}]}]]}], ")"}]}], 
            RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q3"}], ")"}]}]]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", "Q1", " ", "q3", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"2", " ", "q1", " ", "q2", " ", 
             SuperscriptBox["q3", "2"]}], 
            RowBox[{"3", " ", 
             SuperscriptBox["Q1", "2"], " ", 
             SuperscriptBox["Q2", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"q2", "-", "q3"}], ")"}], "2"]}]], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["q2", "2"], " ", 
             SuperscriptBox["q3", "2"]}], 
            RowBox[{"3", " ", 
             SuperscriptBox["Q1", "2"], " ", 
             SuperscriptBox["Q2", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"q2", "-", "q3"}], ")"}], "2"]}]], "-", 
           FractionBox[
            RowBox[{"2", " ", "q1", " ", 
             SuperscriptBox["q3", "3"]}], 
            RowBox[{"3", " ", 
             SuperscriptBox["Q1", "2"], " ", 
             SuperscriptBox["Q2", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"q2", "-", "q3"}], ")"}], "2"]}]], "+", 
           FractionBox[
            RowBox[{"2", " ", "q2", " ", 
             SuperscriptBox["q3", "3"]}], 
            RowBox[{"3", " ", 
             SuperscriptBox["Q1", "2"], " ", 
             SuperscriptBox["Q2", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"q2", "-", "q3"}], ")"}], "2"]}]]}], ")"}]}], 
        ")"}]}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6724991809276237`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%30", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"3", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "k1"}], " ", "Q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", 
           RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
        RowBox[{"3", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"Q1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1"}], "+", 
           RowBox[{"2", " ", "q2"}]}], ")"}], " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"c", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", "q1", " ", "Q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["q1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["Q1", "2"]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["q2", "2"]}], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Q2", "-", "q3"}], ")"}], "2"], "-", 
              RowBox[{"3", " ", "q2", " ", "q3"}], "+", 
              RowBox[{"Q1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "4"}], " ", "q2"}], "+", 
                 RowBox[{"6", " ", "q3"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        "+", 
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k2", " ", "q3"}], "+", 
           RowBox[{"4", " ", "Q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
          ")"}]}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.672499200073358*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%32", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"6", " ", "Q1", " ", "q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "-", 
         RowBox[{"2", " ", "q3"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"k1", " ", "q2", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", 
          RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
       RowBox[{"3", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["q1", "2"], " ", "q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "-", 
       RowBox[{"6", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q1", "2"], "-", 
          RowBox[{"Q1", " ", "q2"}], "+", 
          SuperscriptBox["q2", "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q2", "3"], "+", 
          RowBox[{
           SuperscriptBox["Q1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "q2"}], "-", 
             RowBox[{"6", " ", "q3"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "Q1", " ", "q2", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", 
             RowBox[{"3", " ", "q3"}]}], ")"}]}], "-", 
          RowBox[{"4", " ", "q2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["q2", "2"], " ", "q3"}], "+", 
          RowBox[{"6", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Q2", "-", "q3"}], ")"}], "2"], " ", "q3"}]}], ")"}]}]}],
       ")"}]}], "+", 
    RowBox[{"Q1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "9"}], " ", "q1", " ", "q2"}], "+", 
          SuperscriptBox["q2", "2"], "+", 
          RowBox[{"6", " ", "q1", " ", "q3"}], "-", 
          RowBox[{"6", " ", "q2", " ", "q3"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "k2", " ", "q3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", "q1", " ", "q2"}], "+", 
          SuperscriptBox["q2", "2"], "+", 
          RowBox[{"3", " ", "q1", " ", "q3"}], "-", 
          RowBox[{"3", " ", "q2", " ", "q3"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "6"}], " ", "q1", " ", "q2"}], "+", 
          SuperscriptBox["q2", "2"], "+", 
          RowBox[{"6", " ", "q1", " ", "q3"}], "-", 
          RowBox[{"6", " ", "q2", " ", "q3"}]}], ")"}], " ", "x"}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6724992210657177`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finding the equations for price constraints", "Subtitle",
 CellChangeTimes->{{3.733852655859571*^9, 3.733852668939777*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%28", "\[Equal]", "0"}], ",", "r2"}], "]"}]], "Input",
 CellChangeTimes->{{3.672499841604594*^9, 3.672499863655155*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["Q2", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"q2", "-", "q3"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "q3"}], 
         RowBox[{"3", " ", "Q2"}]], "+", 
        FractionBox[
         RowBox[{"k2", " ", 
          SuperscriptBox["q3", "2"]}], 
         RowBox[{"3", " ", 
          SuperscriptBox["Q2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"Q1", "-", "q2", "+", "Q2", "-", "q3"}], ")"}], " ", "q3", 
          " ", 
          RowBox[{"(", 
           RowBox[{"Q1", "-", "q2", "-", "Q2", "+", "q3"}], ")"}]}], 
         RowBox[{"3", " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{"q2", " ", "q3", " ", "r1"}], 
         RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{"2", " ", "q3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}], 
         RowBox[{"3", " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}]]}], ")"}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox["q3", "2"]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6724998722801027`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q2", "*", 
    RowBox[{"r1", "/", "Q1"}]}], "+", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q1"}], ")"}], "^", "2"}]}], "-", 
   RowBox[{"q2", "*", 
    RowBox[{"r2", "/", "Q2"}]}], "-", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q2"}], ")"}], "^", "2"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["Q2", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"q2", "-", "q3"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "q3"}], 
         RowBox[{"3", " ", "Q2"}]], "+", 
        FractionBox[
         RowBox[{"k2", " ", 
          SuperscriptBox["q3", "2"]}], 
         RowBox[{"3", " ", 
          SuperscriptBox["Q2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"Q1", "-", "q2", "+", "Q2", "-", "q3"}], ")"}], " ", "q3", 
          " ", 
          RowBox[{"(", 
           RowBox[{"Q1", "-", "q2", "-", "Q2", "+", "q3"}], ")"}]}], 
         RowBox[{"3", " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{"q2", " ", "q3", " ", "r1"}], 
         RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{"2", " ", "q3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}], 
         RowBox[{"3", " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}]]}], ")"}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox["q3", "2"]}]]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.672499911320779*^9, 3.672499918971897*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q2", " ", "r1"}], "Q1"], "-", 
  FractionBox[
   RowBox[{"3", " ", "q2", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q3"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"m", " ", "q3"}], 
       RowBox[{"3", " ", "Q2"}]], "+", 
      FractionBox[
       RowBox[{"k2", " ", 
        SuperscriptBox["q3", "2"]}], 
       RowBox[{"3", " ", 
        SuperscriptBox["Q2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{"Q1", "-", "q2", "+", "Q2", "-", "q3"}], ")"}], " ", "q3", 
        " ", 
        RowBox[{"(", 
         RowBox[{"Q1", "-", "q2", "-", "Q2", "+", "q3"}], ")"}]}], 
       RowBox[{"3", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{"q2", " ", "q3", " ", "r1"}], 
       RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{"2", " ", "q3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}], 
       RowBox[{"3", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}]]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["q3", "2"]}]]}]], "Output",
 CellChangeTimes->{3.672499922173526*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "%35", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "Q1", " ", "Q2", " ", "q3"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["q2", "3"]}], "-", 
       RowBox[{
        SuperscriptBox["Q1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "Q1", " ", "q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
       RowBox[{"q2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Q2", "+", "q3"}], ")"}], "2"]}]}], ")"}]}], "-", 
    RowBox[{"q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"k2", " ", "Q1", " ", "q3"}], "+", 
       RowBox[{"Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q2", " ", "r1"}], "-", 
          RowBox[{"2", " ", "q3", " ", "r1"}], "-", 
          RowBox[{"2", " ", "Q1", " ", "q2", " ", "x"}], "+", 
          RowBox[{"2", " ", "Q1", " ", "q3", " ", "x"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.672499925857119*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%36", "\[Equal]", "0"}], ",", "r1"}], "]"}]], "Input",
 CellChangeTimes->{{3.672499928840013*^9, 3.672499937367876*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", 
    RowBox[{"-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"q2", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}]], 
      RowBox[{"Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2"}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["q2", "3"], " ", "Q2"}], "-", 
         RowBox[{"c", " ", "q2", " ", 
          SuperscriptBox["Q2", "3"]}], "+", 
         RowBox[{"k2", " ", "q2", " ", "q3"}], "-", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"m", " ", "q2", " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3"}], 
         "-", 
         RowBox[{"2", " ", "c", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q2", "3"], " ", "q3"}], "-", 
         RowBox[{"c", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "x"}], "+", 
         RowBox[{"2", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}]}], 
        ")"}]}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.672499938592122*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%26", "\[Equal]", "0"}], ",", "r1"}], "]"}]], "Input",
 CellChangeTimes->{{3.672499972952833*^9, 3.672499992485688*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", 
    FractionBox[
     RowBox[{
      FractionBox[
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "q1"}], "+", "q2"}], ")"}]}], 
       RowBox[{"6", " ", "Q1"}]], "-", 
      FractionBox[
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", "q1", " ", "q2", " ", "Q2"}], "+", 
          RowBox[{
           SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
          RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3"}], "-", 
          RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3"}]}], ")"}]}], 
       RowBox[{"6", " ", 
        SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["q1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
          RowBox[{"6", " ", "q1", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "-", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              SuperscriptBox["Q1", "2"]}], "+", 
             SuperscriptBox["q2", "2"], "-", 
             RowBox[{"2", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", 
                RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "-", 
             RowBox[{"3", " ", "q2", " ", "q3"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{"6", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{"q2", " ", "q3", " ", "r2"}], 
       RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"q2", " ", "x"}], 
       RowBox[{"3", " ", "Q1"}]]}], 
     RowBox[{
      FractionBox[
       RowBox[{"q1", " ", "q2"}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Q1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
      FractionBox[
       SuperscriptBox["q2", "2"], 
       RowBox[{"6", " ", 
        SuperscriptBox["Q1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"q1", " ", "q3"}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Q1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{"q2", " ", "q3"}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Q1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2"}], "-", 
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
        RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3"}], "+", 
        RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3"}]}], 
       RowBox[{"6", " ", 
        SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}]]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.672499994400584*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox[
  RowBox[{
   FractionBox[
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "q1"}], "+", "q2"}], ")"}]}], 
    RowBox[{"6", " ", "Q1"}]], "-", 
   FractionBox[
    RowBox[{"k1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "q1", " ", "q2", " ", "Q2"}], "+", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
       RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3"}], "-", 
       RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3"}]}], ")"}]}], 
    RowBox[{"6", " ", 
     SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["q1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"6", " ", "q1", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "-", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["Q1", "2"]}], "+", 
          SuperscriptBox["q2", "2"], "-", 
          RowBox[{"2", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", 
             RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "-", 
          RowBox[{"3", " ", "q2", " ", "q3"}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"6", " ", "Q1", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"q2", " ", "q3", " ", "r2"}], 
    RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{"q2", " ", "x"}], 
    RowBox[{"3", " ", "Q1"}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{"q1", " ", "q2"}], 
    RowBox[{"2", " ", 
     SuperscriptBox["Q1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
   FractionBox[
    SuperscriptBox["q2", "2"], 
    RowBox[{"6", " ", 
     SuperscriptBox["Q1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{"q1", " ", "q3"}], 
    RowBox[{"2", " ", 
     SuperscriptBox["Q1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"q2", " ", "q3"}], 
    RowBox[{"2", " ", 
     SuperscriptBox["Q1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2"}], "-", 
     RowBox[{
      SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
     RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3"}], "+", 
     RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3"}]}], 
    RowBox[{"6", " ", 
     SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]]}]]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   FractionBox[
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "q1"}], "+", "q2"}], ")"}]}], 
    RowBox[{"6", " ", "Q1"}]], "-", 
   FractionBox[
    RowBox[{"k1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "q1", " ", "q2", " ", "Q2"}], "+", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
       RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3"}], "-", 
       RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3"}]}], ")"}]}], 
    RowBox[{"6", " ", 
     SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["q1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"6", " ", "q1", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "-", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["Q1", "2"]}], "+", 
          SuperscriptBox["q2", "2"], "-", 
          RowBox[{"2", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", 
             RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "-", 
          RowBox[{"3", " ", "q2", " ", "q3"}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"6", " ", "Q1", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"q2", " ", "q3", " ", "r2"}], 
    RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{"q2", " ", "x"}], 
    RowBox[{"3", " ", "Q1"}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{"q1", " ", "q2"}], 
    RowBox[{"2", " ", 
     SuperscriptBox["Q1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
   FractionBox[
    SuperscriptBox["q2", "2"], 
    RowBox[{"6", " ", 
     SuperscriptBox["Q1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{"q1", " ", "q3"}], 
    RowBox[{"2", " ", 
     SuperscriptBox["Q1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"q2", " ", "q3"}], 
    RowBox[{"2", " ", 
     SuperscriptBox["Q1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2"}], "-", 
     RowBox[{
      SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
     RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3"}], "+", 
     RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3"}]}], 
    RowBox[{"6", " ", 
     SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}]}]]}]]], "Output",
 CellChangeTimes->{3.672500001523547*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%39", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", 
          RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
       RowBox[{"3", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "k1"}], " ", "Q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", 
           RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
        RowBox[{"3", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"Q1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"c", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", "q1", " ", "Q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["q1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["Q1", "2"]}], "+", 
              SuperscriptBox["q2", "2"], "-", 
              RowBox[{"2", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", 
                 RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "-", 
              RowBox[{"3", " ", "q2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
        
        RowBox[{"2", " ", "q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "q2"}], " ", "Q2", " ", "x"}], "+", 
           RowBox[{"q3", " ", 
            RowBox[{"(", 
             RowBox[{"r2", "+", 
              RowBox[{"Q2", " ", "x"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.672500013590398*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q3", "*", 
    RowBox[{"r2", "/", "Q2"}]}], "+", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q3", "-", "Q2"}], ")"}], "^", "2"}]}], "-", 
   RowBox[{"q3", "*", 
    RowBox[{"r1", "/", "Q1"}]}], "-", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q3", "-", "Q1"}], ")"}], "^", "2"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{"r1", "->", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"2", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", 
             RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
          RowBox[{"3", " ", "q1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}]]}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "k1"}], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", 
             RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
          RowBox[{"3", " ", "q1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
          RowBox[{"c", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"6", " ", "q1", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["q1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "+", 
             RowBox[{"q2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["Q1", "2"]}], "+", 
                SuperscriptBox["q2", "2"], "-", 
                RowBox[{"2", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", 
                   RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "-", 
                RowBox[{"3", " ", "q2", " ", "q3"}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"2", " ", "q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "q2"}], " ", "Q2", " ", "x"}], "+", 
             RowBox[{"q3", " ", 
              RowBox[{"(", 
               RowBox[{"r2", "+", 
                RowBox[{"Q2", " ", "x"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6725000324611387`*^9, 3.672500080501176*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "c"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q3"}], ")"}], "2"]}], "+", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q3", " ", "r2"}], "Q2"], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", 
          RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
       RowBox[{"3", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}]], 
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "k1"}], " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", 
            RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
         RowBox[{"3", " ", "q1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
         RowBox[{"c", " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"6", " ", "q1", " ", "Q1", " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["q1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "+", 
            RowBox[{"q2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", 
                SuperscriptBox["Q1", "2"]}], "+", 
               SuperscriptBox["q2", "2"], "-", 
               RowBox[{"2", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", 
                  RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "-", 
               RowBox[{"3", " ", "q2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "q2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q2"}], " ", "Q2", " ", "x"}], "+", 
            RowBox[{"q3", " ", 
             RowBox[{"(", 
              RowBox[{"r2", "+", 
               RowBox[{"Q2", " ", "x"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.6725000847657557`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%42", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "c"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"Q1", "-", "q3"}], ")"}], "2"]}], "+", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q3", " ", "r2"}], "Q2"], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", 
          RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
       RowBox[{"3", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}]], 
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "k1"}], " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", 
            RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
         RowBox[{"3", " ", "q1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
         RowBox[{"c", " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"6", " ", "q1", " ", "Q1", " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["q1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "+", 
            RowBox[{"q2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", 
                SuperscriptBox["Q1", "2"]}], "+", 
               SuperscriptBox["q2", "2"], "-", 
               RowBox[{"2", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", 
                  RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "-", 
               RowBox[{"3", " ", "q2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "q2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q2"}], " ", "Q2", " ", "x"}], "+", 
            RowBox[{"q3", " ", 
             RowBox[{"(", 
              RowBox[{"r2", "+", 
               RowBox[{"Q2", " ", "x"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.672500092644187*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%43", "\[Equal]", "0"}], ",", "r2"}], "]"}]], "Input",
 CellChangeTimes->{{3.672500094803247*^9, 3.672500106053398*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       FractionBox["q3", "Q2"], "+", 
       FractionBox[
        RowBox[{"q2", " ", 
         SuperscriptBox["q3", "2"]}], 
        RowBox[{"Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", 
              RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
           RowBox[{"3", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}]]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Q1", "-", "q3"}], ")"}], "2"]}], "-", 
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "+", 
       FractionBox[
        RowBox[{"k1", " ", "q3"}], 
        RowBox[{"2", " ", "Q1"}]], "-", 
       FractionBox[
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1"}], "+", "q2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", "q3"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", 
              RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
           RowBox[{"3", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"c", " ", "q3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", "q1", " ", "Q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["q1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["Q1", "2"]}], "+", 
              SuperscriptBox["q2", "2"], "-", 
              RowBox[{"2", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", 
                 RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"Q2", "-", "q3"}], ")"}], "2"]}], "-", 
              RowBox[{"3", " ", "q2", " ", "q3"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", 
              RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
           RowBox[{"3", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "q3", " ", "x"}], 
        RowBox[{
         RowBox[{"q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", 
            RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
         RowBox[{"3", " ", "q1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}]], "-", 
       FractionBox[
        RowBox[{"q2", " ", 
         SuperscriptBox["q3", "2"], " ", "x"}], 
        RowBox[{
         RowBox[{"q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", 
            RowBox[{"3", " ", "q3"}]}], ")"}]}], "+", 
         RowBox[{"3", " ", "q1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]}]]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6725001079023542`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 981},
WindowMargins->{{-10, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.4 for Linux x86 (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 566, 14, 77, "Text"],
Cell[CellGroupData[{
Cell[1148, 38, 154, 5, 58, "Input"],
Cell[1305, 45, 223, 8, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1565, 58, 230, 8, 58, "Input"],
Cell[1798, 68, 341, 13, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2176, 86, 159, 5, 58, "Input"],
Cell[2338, 93, 228, 8, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2603, 106, 303, 9, 32, "Input"],
Cell[2909, 117, 901, 34, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3847, 156, 303, 9, 32, "Input"],
Cell[4153, 167, 1327, 50, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5517, 222, 303, 9, 32, "Input"],
Cell[5823, 233, 938, 35, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6798, 273, 240, 6, 34, "Input"],
Cell[7041, 281, 1104, 41, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8182, 327, 266, 6, 34, "Input"],
Cell[8451, 335, 1668, 64, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10156, 404, 156, 3, 34, "Input"],
Cell[10315, 409, 668, 25, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11020, 439, 789, 23, 34, "Input"],
Cell[11812, 464, 5444, 134, 249, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17293, 603, 154, 3, 32, "Input"],
Cell[17450, 608, 1117, 30, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18604, 643, 3487, 93, 242, "Input"],
Cell[22094, 738, 7808, 189, 463, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29939, 932, 88, 2, 32, "Input"],
Cell[30030, 936, 4216, 108, 156, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34283, 1049, 3331, 88, 242, "Input"],
Cell[37617, 1139, 2219, 59, 126, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39873, 1203, 88, 2, 32, "Input"],
Cell[39964, 1207, 1112, 31, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41113, 1243, 362, 8, 32, "Input"],
Cell[41478, 1253, 2592, 70, 106, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44107, 1328, 366, 8, 32, "Input"],
Cell[44476, 1338, 1027, 29, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45540, 1372, 617, 18, 32, "Input"],
Cell[46160, 1392, 12680, 321, 500, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58877, 1718, 88, 2, 32, "Input"],
Cell[58968, 1722, 2571, 77, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61576, 1804, 88, 2, 32, "Input"],
Cell[61667, 1808, 3555, 102, 155, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65259, 1915, 129, 1, 51, "Subtitle"],
Cell[CellGroupData[{
Cell[65413, 1920, 181, 4, 32, "Input"],
Cell[65597, 1926, 1594, 46, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67228, 1977, 1971, 59, 104, "Input"],
Cell[69202, 2038, 1731, 54, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70970, 2097, 84, 2, 32, "Input"],
Cell[71057, 2101, 1409, 41, 78, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72503, 2147, 181, 4, 32, "Input"],
Cell[72687, 2153, 1646, 40, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74370, 2198, 181, 4, 32, "Input"],
Cell[74554, 2204, 3539, 101, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78130, 2310, 3129, 97, 98, "Input"],
Cell[81262, 2409, 3172, 98, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84471, 2512, 88, 2, 32, "Input"],
Cell[84562, 2516, 2542, 76, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87141, 2597, 3158, 92, 127, "Input"],
Cell[90302, 2691, 2969, 89, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93308, 2785, 88, 2, 30, "Input"],
Cell[93399, 2789, 2923, 87, 109, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96359, 2881, 181, 4, 30, "Input"],
Cell[96543, 2887, 3954, 117, 169, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

