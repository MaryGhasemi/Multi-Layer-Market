(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    209035,       5351]
NotebookOptionsPosition[    205710,       5231]
NotebookOutlinePosition[    206047,       5246]
CellTagsIndexPosition[    206004,       5243]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "First step is to define the demands based on the prices and qualities, \
which follows the \[Theta] definition. B1 has the lowest quality in the \
market and B4 has the highest quality. In this part we assum that B2 buys \
from S1 and B3 buys from S2.  B1 and B2 Cooperate.\nm here is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and x is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "min"], TraditionalForm]]],
 "\n\n"
}], "Text",
 CellChangeTimes->{{3.7338515477095633`*^9, 3.7338515782537413`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d1", " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p2", "-", "p1"}], 
    RowBox[{"q2", "-", "q1"}]], "-", "m"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "m"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]]}]], "Output",
 CellChangeTimes->{{3.6839107543552027`*^9, 3.683910772811389*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d2", " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p3", "-", "p2"}], 
    RowBox[{"q3", "-", "q2"}]], "-", 
   FractionBox[
    RowBox[{"p2", "-", "p1"}], 
    RowBox[{"q2", "-", "q1"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p1"}], "+", "p2"}], 
    RowBox[{
     RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]]}]], "Output",
 CellChangeTimes->{3.683910795692984*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d3", " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p4", "-", "p3"}], 
    RowBox[{"q4", "-", "q3"}]], "-", 
   FractionBox[
    RowBox[{"p3", "-", "p2"}], 
    RowBox[{"q3", "-", "q2"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p2"}], "+", "p3"}], 
    RowBox[{
     RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p3"}], "+", "p4"}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]]}]], "Output",
 CellChangeTimes->{3.6839108018699083`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d4", " ", "=", " ", 
  RowBox[{"x", "-", 
   FractionBox[
    RowBox[{"p4", "-", "p3"}], 
    RowBox[{"q4", "-", "q3"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p3"}], "+", "p4"}], 
    RowBox[{
     RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", "x"}]], "Output",
 CellChangeTimes->{3.6839108082111893`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]1", " ", "=", " ", 
  RowBox[{
   RowBox[{"d1", "*", "p1"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r1", "*", 
      FractionBox[
       RowBox[{"q1", "*", "d1"}], "Q1"]}], "+", 
     RowBox[{"c", "*", "d1", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q1", "-", "Q1"}], ")"}], "^", "2"}]}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "m"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p1"}], "+", "p2"}], 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q1", "-", "Q1"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "m"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p1"}], "+", "p2"}], 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "m"}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.683910817095706*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]2", " ", "=", " ", 
  RowBox[{
   RowBox[{"d2", "*", "p2"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r1", "*", 
      FractionBox[
       RowBox[{"q2", "*", "d2"}], "Q1"]}], "+", 
     RowBox[{"c", "*", "d2", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q2", "-", "Q1"}], ")"}], "^", "2"}]}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p2"}], "+", "p3"}], 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p2"}], "+", "p3"}], 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p1"}], "+", "p2"}], 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.683910823378833*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]3", " ", "=", " ", 
  RowBox[{
   RowBox[{"d3", "*", "p3"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r2", "*", 
      FractionBox[
       RowBox[{"q3", "*", "d3"}], "Q2"]}], "+", 
     RowBox[{"c", "*", "d3", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q3", "-", "Q2"}], ")"}], "^", "2"}]}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p3"}], "+", "p4"}], 
      RowBox[{
       RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p3"}], "+", "p4"}], 
      RowBox[{
       RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p2"}], "+", "p3"}], 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p3"}], "+", "p4"}], 
       RowBox[{
        RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}], " ", "r2"}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.683910835361642*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]4", " ", "=", " ", 
  RowBox[{
   RowBox[{"d4", "*", "p4"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r2", "*", 
      FractionBox[
       RowBox[{"q4", "*", "d4"}], "Q2"]}], "+", 
     RowBox[{"c", "*", "d4", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q4", "-", "Q2"}], ")"}], "^", "2"}]}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p3"}], "+", "p4"}], 
       RowBox[{
        RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", "x"}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p3"}], "+", "p4"}], 
       RowBox[{
        RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", "x"}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q4", " ", "r2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p3"}], "+", "p4"}], 
        RowBox[{
         RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", "x"}], ")"}]}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.6839108528471737`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p1"], 
  RowBox[{"(", 
   RowBox[{"\[CapitalPi]1", "+", "\[CapitalPi]2"}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "m"}], "-", 
  FractionBox["p1", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox["p2", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{"q1", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"q2", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.683911163341799*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p2"], 
  RowBox[{"(", 
   RowBox[{"\[CapitalPi]1", "+", "\[CapitalPi]2"}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["p1", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
  RowBox[{"p2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q1", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.683911177773665*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p3"], "\[CapitalPi]3"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p2"}], "+", "p3"}], 
    RowBox[{
     RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p3"}], "+", "p4"}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "+", 
  RowBox[{"p3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}], " ", "r2"}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.683911186894525*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p4"], "\[CapitalPi]4"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["p4", 
    RowBox[{
     RowBox[{"-", "q3"}], "+", "q4"}]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p3"}], "+", "p4"}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "+", 
  FractionBox[
   RowBox[{"q4", " ", "r2"}], 
   RowBox[{"Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]], "+", "x"}]], "Output",
 CellChangeTimes->{3.6839111955526037`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"%12", "\[Equal]", "0"}], "&&", 
     RowBox[{"%11", "\[Equal]", "0"}], "&&", 
     RowBox[{"%10", "\[Equal]", "0"}], "&&", 
     RowBox[{"%9", "\[Equal]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%9", " ", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "p1"], 
      RowBox[{"(", 
       RowBox[{"\[CapitalPi]1", "+", "\[CapitalPi]2"}], ")"}]}]}], ",", " ", "...",
     ",", " ", 
    RowBox[{"%12", ":", "  ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "p4"], "\[CapitalPi]4"}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.73385160133529*^9, 3.733851637039846*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["2", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}], ")"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["2", 
                   RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                 FractionBox["2", 
                  RowBox[{
                   RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}], "2"]]}], "-", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], 
                  RowBox[{
                   RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}]}], ")"}]}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "m"}], "+", 
             FractionBox[
              RowBox[{"c", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
              RowBox[{
               RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
             FractionBox[
              RowBox[{"c", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"]}], 
              RowBox[{
               RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
             FractionBox[
              RowBox[{"q1", " ", "r1"}], 
              RowBox[{"Q1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"q2", " ", "r1"}], 
              RowBox[{"Q1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}]], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["1", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}], "2"]]}], "-", 
                  FractionBox[
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], 
                   RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{"c", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
                   RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                 RowBox[{"c", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
                 FractionBox[
                  RowBox[{"q1", " ", "r1"}], 
                  RowBox[{"Q1", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "-", 
                 FractionBox[
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r1"}], 
                  "Q1"]}], ")"}]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "c"}], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
                    FractionBox[
                    RowBox[{"q3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}], " ", "r2"}], 
                    "Q2"]}], ")"}]}], 
                  RowBox[{
                   RowBox[{"-", "q3"}], "+", "q4"}]]}], "-", 
                FractionBox[
                 RowBox[{
                  FractionBox[
                   RowBox[{"c", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"]}], 
                   RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]], "+", 
                  FractionBox[
                   RowBox[{"q4", " ", "r2"}], 
                   RowBox[{"Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]], "+", "x"}], 
                 RowBox[{
                  RowBox[{"-", "q3"}], "+", "q4"}]]}], 
               RowBox[{
                RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}]}]}], ")"}], "/", 
        
        RowBox[{"(", 
         RowBox[{
          FractionBox["12", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "q3"}], "+", "q4"}], ")"}], "2"]}]], "+", 
          FractionBox["12", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "q2"}], "+", "q3"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]]}], ")"}]}], 
       ")"}]}]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "c", " ", 
          SuperscriptBox["Q1", "3"], " ", "q2", " ", "Q2"}], "-", 
         RowBox[{"3", " ", "m", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
         RowBox[{"6", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
         RowBox[{"3", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["q2", "3"], " ", "Q2"}], "-", 
         RowBox[{"3", " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "3"]}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["Q1", "3"], " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"2", " ", "m", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3"}], 
         "+", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "3"], " ", "q3"}], "+", 
         RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"4", " ", "c", " ", 
          SuperscriptBox["Q1", "3"], " ", "Q2", " ", "q4"}], "+", 
         RowBox[{"4", " ", "m", " ", "Q1", " ", "q2", " ", "Q2", " ", "q4"}], 
         "-", 
         RowBox[{"8", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2", " ", "q4"}], "+", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4"}], "+", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "3"], " ", "q4"}], "-", 
         RowBox[{"4", " ", "m", " ", "Q1", " ", "Q2", " ", "q3", " ", "q4"}], 
         "-", 
         RowBox[{"6", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3", " ", "q4"}], "+", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
         RowBox[{"c", " ", "Q1", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q4", "2"]}], "+", 
         RowBox[{"c", " ", "Q1", " ", "Q2", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "-", 
         RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "+", 
         RowBox[{"4", " ", "q2", " ", "Q2", " ", "q4", " ", "r1"}], "-", 
         RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "-", 
         RowBox[{"Q1", " ", "q2", " ", "q4", " ", "r2"}], "+", 
         RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "+", 
         RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], "-", 
         RowBox[{"Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "x"}], "-", 
         RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], "+", 
         RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
        ")"}]}]}]}], ",", 
    RowBox[{"p3", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "3"]}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["Q1", "3"], " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"m", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "3"], " ", "q3"}], "+", 
         RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["Q1", "3"], " ", "Q2", " ", "q4"}], "+", 
         RowBox[{"m", " ", "Q1", " ", "q2", " ", "Q2", " ", "q4"}], "-", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2", " ", "q4"}], "+", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4"}], "+", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "3"], " ", "q4"}], "-", 
         RowBox[{"m", " ", "Q1", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
         RowBox[{"6", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3", " ", "q4"}], "+", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
         RowBox[{"c", " ", "Q1", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q4", "2"]}], "+", 
         RowBox[{"c", " ", "Q1", " ", "Q2", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "+", 
         RowBox[{"q2", " ", "Q2", " ", "q4", " ", "r1"}], "-", 
         RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "-", 
         RowBox[{"Q1", " ", "q2", " ", "q4", " ", "r2"}], "+", 
         RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "+", 
         RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], "-", 
         RowBox[{"Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "x"}], "-", 
         RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], "+", 
         RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
        ")"}]}]}]}], ",", 
    RowBox[{"p4", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q4"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "3"]}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["Q1", "3"], " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"m", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "-", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "3"], " ", "q3"}], "-", 
         RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["Q1", "3"], " ", "Q2", " ", "q4"}], "-", 
         RowBox[{"m", " ", "Q1", " ", "q2", " ", "Q2", " ", "q4"}], "+", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2", " ", "q4"}], "-", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4"}], "-", 
         RowBox[{"8", " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q4"}], "-", 
         RowBox[{"5", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "3"], " ", "q4"}], "+", 
         RowBox[{"m", " ", "Q1", " ", "Q2", " ", "q3", " ", "q4"}], "+", 
         RowBox[{"6", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3", " ", "q4"}], "-", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q4", "2"]}], "+", 
         RowBox[{"6", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "2"], " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"c", " ", "Q1", " ", "Q2", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"3", " ", "c", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q4", "3"]}], "+", 
         RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
         RowBox[{"q2", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
         RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
         RowBox[{"4", " ", "Q1", " ", "q2", " ", "q4", " ", "r2"}], "-", 
         RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "-", 
         RowBox[{"3", " ", "Q1", " ", 
          SuperscriptBox["q4", "2"], " ", "r2"}], "-", 
         RowBox[{"4", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], 
         "+", 
         RowBox[{"Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "x"}], "+", 
         RowBox[{"4", " ", "Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], 
         "+", 
         RowBox[{"2", " ", "Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}], 
         "-", 
         RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q4", "2"], " ", "x"}]}], ")"}]}]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.68391121101044*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U1", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d1", "*", 
         RowBox[{"q1", "/", "Q1"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"d2", "*", 
         RowBox[{"q2", "/", "Q1"}]}], ")"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"r1", "-", "k1"}], ")"}]}], "-", 
    RowBox[{"e", "*", 
     RowBox[{"Q1", "^", "2"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "\[Rule]", "%15"}], ",", 
     RowBox[{"p2", "\[Rule]", "%17"}], ",", 
     RowBox[{"p3", "\[Rule]", "%19"}], ",", 
     RowBox[{"p4", "\[Rule]", "%21"}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "e"}], " ", 
   SuperscriptBox["Q1", "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "k1"}], "+", "r1"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "Q1"], 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"-", "q2"}], "+", "q3"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                   RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
                RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", " ", 
                    SuperscriptBox["q2", "3"]}], "-", 
                   RowBox[{
                    SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
                   RowBox[{
                    SuperscriptBox["q2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["Q1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "-", 
                   RowBox[{"2", " ", "Q1", " ", "q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
                   RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
                   RowBox[{"q3", " ", 
                    SuperscriptBox["q4", "2"]}], "+", 
                   RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    SuperscriptBox["q4", "2"], "-", 
                    RowBox[{"2", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "+", 
                RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
                RowBox[{"4", " ", "q2", " ", "Q2", " ", "q4", " ", "r1"}], 
                "+", 
                RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], 
                "+", 
                RowBox[{"Q1", " ", "q2", " ", "q4", " ", "r2"}], "-", 
                RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], 
                "-", 
                RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], 
                "+", 
                RowBox[{"Q1", " ", "Q2", " ", 
                 SuperscriptBox["q3", "2"], " ", "x"}], "+", 
                RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], 
                "-", 
                RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
               ")"}]}]}], "+", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    SuperscriptBox["Q2", "2"]}], " ", "q3"}], "+", 
                  RowBox[{
                   SuperscriptBox["Q1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["q2", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "-", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
                  RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
                  RowBox[{"q3", " ", 
                   SuperscriptBox["q4", "2"]}], "+", 
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"2", " ", "Q1", " ", "q3"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    RowBox[{"2", " ", "Q1", " ", "q4"}], "+", 
                    SuperscriptBox["q4", "2"], "-", 
                    RowBox[{"2", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
               RowBox[{"q2", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
               RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
               RowBox[{"Q1", " ", "q2", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
               RowBox[{"Q1", " ", "Q2", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}], "+", 
               RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
               RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
              ")"}]}]}], ")"}]}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"-", "q1"}], "+", "q2"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                  RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   SuperscriptBox["q2", "3"]}], "-", 
                  RowBox[{
                   SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
                  RowBox[{
                   SuperscriptBox["q2", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["Q1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "-", 
                  RowBox[{"2", " ", "Q1", " ", "q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "-", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
                  RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
                  RowBox[{"q3", " ", 
                   SuperscriptBox["q4", "2"]}], "+", 
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    SuperscriptBox["q4", "2"], "-", 
                    RowBox[{"2", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "+", 
               RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
               RowBox[{"4", " ", "q2", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
               RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
               RowBox[{"Q1", " ", "q2", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
               RowBox[{"Q1", " ", "Q2", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}], "+", 
               RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
               RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
              ")"}]}], "-", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "m"}], " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "3"}], " ", "q1", " ", "q2"}], "+", 
                  RowBox[{"2", " ", "q2", " ", "q3"}], "+", 
                  SuperscriptBox["q3", "2"], "+", 
                  RowBox[{"3", " ", "q1", " ", "q4"}], "+", 
                  RowBox[{"q2", " ", "q4"}], "-", 
                  RowBox[{"4", " ", "q3", " ", "q4"}]}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "q2", " ", 
                   SuperscriptBox["Q2", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["q2", "2"], " ", "q3"}], "-", 
                  RowBox[{"4", " ", "q2", " ", "Q2", " ", "q3"}], "-", 
                  RowBox[{
                   SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
                  RowBox[{"2", " ", "q2", " ", 
                   SuperscriptBox["q3", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["Q1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
                  RowBox[{"3", " ", 
                   SuperscriptBox["q1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q2", "-", "q4"}], ")"}]}], "-", 
                  RowBox[{
                   SuperscriptBox["q2", "2"], " ", "q4"}], "-", 
                  RowBox[{"2", " ", "q2", " ", "Q2", " ", "q4"}], "-", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
                  RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
                  RowBox[{"q2", " ", 
                   SuperscriptBox["q4", "2"]}], "-", 
                  RowBox[{"q3", " ", 
                   SuperscriptBox["q4", "2"]}], "+", 
                  RowBox[{"6", " ", "q1", " ", "Q1", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q4"}], ")"}]}], "+", 
                  RowBox[{"2", " ", "Q1", " ", "q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
               RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
               RowBox[{"3", " ", "q1", " ", "Q2", " ", "q4", " ", "r1"}], "-", 
               RowBox[{"q2", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
               RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
               RowBox[{"Q1", " ", "q2", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
               RowBox[{"Q1", " ", "Q2", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}], "+", 
               RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
               RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
              ")"}]}]}], ")"}]}]}], ")"}]}]}], "+", 
     RowBox[{
      FractionBox["1", "Q1"], 
      RowBox[{"q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "m"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"-", "q1"}], "+", "q2"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                  RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   SuperscriptBox["q2", "3"]}], "-", 
                  RowBox[{
                   SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
                  RowBox[{
                   SuperscriptBox["q2", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["Q1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "-", 
                  RowBox[{"2", " ", "Q1", " ", "q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "-", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
                  RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
                  RowBox[{"q3", " ", 
                   SuperscriptBox["q4", "2"]}], "+", 
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    SuperscriptBox["q4", "2"], "-", 
                    RowBox[{"2", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "+", 
               RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
               RowBox[{"4", " ", "q2", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
               RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
               RowBox[{"Q1", " ", "q2", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
               RowBox[{"Q1", " ", "Q2", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}], "+", 
               RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
               RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
              ")"}]}], "-", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "m"}], " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "3"}], " ", "q1", " ", "q2"}], "+", 
                  RowBox[{"2", " ", "q2", " ", "q3"}], "+", 
                  SuperscriptBox["q3", "2"], "+", 
                  RowBox[{"3", " ", "q1", " ", "q4"}], "+", 
                  RowBox[{"q2", " ", "q4"}], "-", 
                  RowBox[{"4", " ", "q3", " ", "q4"}]}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "q2", " ", 
                   SuperscriptBox["Q2", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["q2", "2"], " ", "q3"}], "-", 
                  RowBox[{"4", " ", "q2", " ", "Q2", " ", "q3"}], "-", 
                  RowBox[{
                   SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
                  RowBox[{"2", " ", "q2", " ", 
                   SuperscriptBox["q3", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["Q1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
                  RowBox[{"3", " ", 
                   SuperscriptBox["q1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q2", "-", "q4"}], ")"}]}], "-", 
                  RowBox[{
                   SuperscriptBox["q2", "2"], " ", "q4"}], "-", 
                  RowBox[{"2", " ", "q2", " ", "Q2", " ", "q4"}], "-", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
                  RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
                  RowBox[{"q2", " ", 
                   SuperscriptBox["q4", "2"]}], "-", 
                  RowBox[{"q3", " ", 
                   SuperscriptBox["q4", "2"]}], "+", 
                  RowBox[{"6", " ", "q1", " ", "Q1", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q4"}], ")"}]}], "+", 
                  RowBox[{"2", " ", "Q1", " ", "q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
               RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
               RowBox[{"3", " ", "q1", " ", "Q2", " ", "q4", " ", "r1"}], "-", 
               RowBox[{"q2", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
               RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
               RowBox[{"Q1", " ", "q2", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
               RowBox[{"Q1", " ", "Q2", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}], "+", 
               RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], "-", 
               RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
              ")"}]}]}], ")"}]}]}], ")"}]}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.683911394020829*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "U1", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"6", " ", 
    SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q3"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q4"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "6"}], " ", "e", " ", 
     SuperscriptBox["Q1", "4"], " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
    RowBox[{"k1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "q1", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{"q3", "-", "q4"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["q1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q4"}], ")"}]}], "-", 
          RowBox[{"6", " ", "q1", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
             RowBox[{
              SuperscriptBox["Q1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "q2"}], "-", "q3", "-", 
                RowBox[{"2", " ", "q4"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["Q2", "2"], " ", "q4"}], "-", 
             RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
             RowBox[{"q3", " ", 
              SuperscriptBox["q4", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["q2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}], "-", 
             RowBox[{"2", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
                RowBox[{"q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], 
             "-", 
             RowBox[{"q2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", 
                 SuperscriptBox["Q2", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q3", "2"]}], "+", 
                RowBox[{"3", " ", "q3", " ", "q4"}], "+", 
                SuperscriptBox["q4", "2"], "-", 
                RowBox[{"2", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"3", " ", "q1", " ", 
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "+", 
       RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q3", " ", "r1"}], 
       "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", "r1"}], "+", 
       RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q4", " ", "r1"}], 
       "-", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4", " ", "r1"}], "-", 
       RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3", " ", "q4", " ", "r1"}], 
       "+", 
       RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "q4", " ", "r1"}], 
       "+", 
       RowBox[{"2", " ", "Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "q3", " ", "r2"}], "+", 
       RowBox[{"Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "q4", " ", "r2"}], "-", 
       RowBox[{"3", " ", "Q1", " ", "q2", " ", "q3", " ", "q4", " ", "r2"}], 
       "-", 
       RowBox[{"Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", "x"}], "+", 
       RowBox[{"Q1", " ", "q2", " ", "Q2", " ", 
        SuperscriptBox["q3", "2"], " ", "x"}], "+", 
       RowBox[{"Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4", " ", "x"}], "-", 
       RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}],
       ")"}]}], "+", 
    RowBox[{"r1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "m"}], " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "q1", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{"q3", "-", "q4"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["q1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q4"}], ")"}]}], "-", 
          RowBox[{"6", " ", "q1", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
             RowBox[{
              SuperscriptBox["Q1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", "q2"}], "-", "q3", "-", 
                RowBox[{"2", " ", "q4"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["Q2", "2"], " ", "q4"}], "-", 
             RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
             RowBox[{"q3", " ", 
              SuperscriptBox["q4", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["q2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}], "-", 
             RowBox[{"2", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
                RowBox[{"q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], 
             "-", 
             RowBox[{"q2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", 
                 SuperscriptBox["Q2", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q3", "2"]}], "+", 
                RowBox[{"3", " ", "q3", " ", "q4"}], "+", 
                SuperscriptBox["q4", "2"], "-", 
                RowBox[{"2", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"3", " ", "q1", " ", 
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "-", 
       RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q3", " ", "r1"}], 
       "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", "r1"}], "-", 
       RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q4", " ", "r1"}], 
       "+", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4", " ", "r1"}], "+", 
       RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3", " ", "q4", " ", "r1"}], 
       "-", 
       RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "q4", " ", "r1"}], 
       "-", 
       RowBox[{"2", " ", "Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "q3", " ", "r2"}], "-", 
       RowBox[{"Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "q4", " ", "r2"}], "+", 
       RowBox[{"3", " ", "Q1", " ", "q2", " ", "q3", " ", "q4", " ", "r2"}], 
       "+", 
       RowBox[{"Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", "x"}], "-", 
       RowBox[{"Q1", " ", "q2", " ", "Q2", " ", 
        SuperscriptBox["q3", "2"], " ", "x"}], "-", 
       RowBox[{"Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4", " ", "x"}], "+", 
       RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}],
       ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.683911404705551*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U2", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d4", "*", 
         RowBox[{"q4", "/", "Q2"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"d3", "*", 
         RowBox[{"q3", "/", "Q2"}]}], ")"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"r2", "-", "k2"}], ")"}]}], "-", 
    RowBox[{"e", "*", 
     RowBox[{"Q2", "^", "2"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "\[Rule]", "%15"}], ",", 
     RowBox[{"p2", "\[Rule]", "%17"}], ",", 
     RowBox[{"p3", "\[Rule]", "%19"}], ",", 
     RowBox[{"p4", "\[Rule]", "%21"}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "e"}], " ", 
   SuperscriptBox["Q2", "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "k2"}], "+", "r2"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "Q2"], 
      RowBox[{"q4", " ", 
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"-", "q3"}], "+", "q4"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    SuperscriptBox["Q2", "2"]}], " ", "q3"}], "+", 
                   RowBox[{
                    SuperscriptBox["Q1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["q2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
                   RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
                   RowBox[{"q3", " ", 
                    SuperscriptBox["q4", "2"]}], "+", 
                   RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"2", " ", "Q1", " ", "q3"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    RowBox[{"2", " ", "Q1", " ", "q4"}], "+", 
                    SuperscriptBox["q4", "2"], "-", 
                    RowBox[{"2", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
                RowBox[{"q2", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
                RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], 
                "+", 
                RowBox[{"Q1", " ", "q2", " ", "q4", " ", "r2"}], "-", 
                RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], 
                "-", 
                RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], 
                "+", 
                RowBox[{"Q1", " ", "Q2", " ", 
                 SuperscriptBox["q3", "2"], " ", "x"}], "+", 
                RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], 
                "-", 
                RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
               ")"}]}]}], "+", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    SuperscriptBox["Q2", "2"]}], " ", "q3"}], "+", 
                  RowBox[{
                   SuperscriptBox["Q1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["q2", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "-", 
                  RowBox[{"5", " ", 
                   SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
                  RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
                  RowBox[{"6", " ", "Q2", " ", 
                   SuperscriptBox["q4", "2"]}], "-", 
                  RowBox[{"q3", " ", 
                   SuperscriptBox["q4", "2"]}], "-", 
                  RowBox[{"3", " ", 
                   SuperscriptBox["q4", "3"]}], "+", 
                  RowBox[{"2", " ", "q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"Q1", " ", "q3"}], "+", 
                    SuperscriptBox["q3", "2"], "+", 
                    RowBox[{"Q1", " ", "q4"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q4", "2"]}], "-", 
                    RowBox[{"2", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "+", 
                    RowBox[{"2", " ", "q4"}]}], ")"}]}]}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
               RowBox[{"q2", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
               RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
               RowBox[{"4", " ", "Q1", " ", "q2", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "Q1", " ", 
                SuperscriptBox["q4", "2"], " ", "r2"}], "-", 
               RowBox[{
               "4", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], 
               "+", 
               RowBox[{"Q1", " ", "Q2", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}], "+", 
               RowBox[{
               "4", " ", "Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], 
               "+", 
               RowBox[{
               "2", " ", "Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}], 
               "-", 
               RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
                SuperscriptBox["q4", "2"], " ", "x"}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], "+", 
     RowBox[{
      FractionBox["1", "Q2"], 
      RowBox[{"q3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           FractionBox["1", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{
               FractionBox["1", 
                RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q4"}], ")"}]}]], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
                  RowBox[{"(", 
                   RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
                 RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["q2", "3"]}], "-", 
                    RowBox[{
                    SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
                    RowBox[{
                    SuperscriptBox["q2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["Q1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "-", 
                    RowBox[{"2", " ", "Q1", " ", "q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "q2"}], "+", "q3", "-", 
                    RowBox[{"4", " ", "q4"}]}], ")"}]}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
                    RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
                    RowBox[{"q3", " ", 
                    SuperscriptBox["q4", "2"]}], "+", 
                    RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    SuperscriptBox["q4", "2"], "-", 
                    RowBox[{"2", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "+", 
                 RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
                 RowBox[{"4", " ", "q2", " ", "Q2", " ", "q4", " ", "r1"}], 
                 "+", 
                 RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], 
                 "+", 
                 RowBox[{"Q1", " ", "q2", " ", "q4", " ", "r2"}], "-", 
                 RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], 
                 "-", 
                 RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], 
                 "+", 
                 RowBox[{"Q1", " ", "Q2", " ", 
                  SuperscriptBox["q3", "2"], " ", "x"}], "+", 
                 RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], 
                 "-", 
                 RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
                ")"}]}]}], "+", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    SuperscriptBox["Q2", "2"]}], " ", "q3"}], "+", 
                   RowBox[{
                    SuperscriptBox["Q1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["q2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
                   RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
                   RowBox[{"q3", " ", 
                    SuperscriptBox["q4", "2"]}], "+", 
                   RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"2", " ", "Q1", " ", "q3"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    RowBox[{"2", " ", "Q1", " ", "q4"}], "+", 
                    SuperscriptBox["q4", "2"], "-", 
                    RowBox[{"2", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
                RowBox[{"q2", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
                RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], 
                "+", 
                RowBox[{"Q1", " ", "q2", " ", "q4", " ", "r2"}], "-", 
                RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], 
                "-", 
                RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], 
                "+", 
                RowBox[{"Q1", " ", "Q2", " ", 
                 SuperscriptBox["q3", "2"], " ", "x"}], "+", 
                RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], 
                "-", 
                RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
               ")"}]}]}], ")"}]}]}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"-", "q3"}], "+", "q4"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    SuperscriptBox["Q2", "2"]}], " ", "q3"}], "+", 
                   RowBox[{
                    SuperscriptBox["Q1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["q2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
                   RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
                   RowBox[{"q3", " ", 
                    SuperscriptBox["q4", "2"]}], "+", 
                   RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"2", " ", "Q1", " ", "q3"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    RowBox[{"2", " ", "Q1", " ", "q4"}], "+", 
                    SuperscriptBox["q4", "2"], "-", 
                    RowBox[{"2", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
                RowBox[{"q2", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
                RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], 
                "+", 
                RowBox[{"Q1", " ", "q2", " ", "q4", " ", "r2"}], "-", 
                RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], 
                "-", 
                RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], 
                "+", 
                RowBox[{"Q1", " ", "Q2", " ", 
                 SuperscriptBox["q3", "2"], " ", "x"}], "+", 
                RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], 
                "-", 
                RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
               ")"}]}]}], "+", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    SuperscriptBox["Q2", "2"]}], " ", "q3"}], "+", 
                  RowBox[{
                   SuperscriptBox["Q1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["q2", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}], "-", 
                  RowBox[{"5", " ", 
                   SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
                  RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
                  RowBox[{"6", " ", "Q2", " ", 
                   SuperscriptBox["q4", "2"]}], "-", 
                  RowBox[{"q3", " ", 
                   SuperscriptBox["q4", "2"]}], "-", 
                  RowBox[{"3", " ", 
                   SuperscriptBox["q4", "3"]}], "+", 
                  RowBox[{"2", " ", "q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "-", 
                    RowBox[{"Q1", " ", "q3"}], "+", 
                    SuperscriptBox["q3", "2"], "+", 
                    RowBox[{"Q1", " ", "q4"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q4", "2"]}], "-", 
                    RowBox[{"2", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{"q3", "+", 
                    RowBox[{"2", " ", "q4"}]}], ")"}]}]}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
               RowBox[{"q2", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
               RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
               RowBox[{"4", " ", "Q1", " ", "q2", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "Q1", " ", 
                SuperscriptBox["q4", "2"], " ", "r2"}], "-", 
               RowBox[{
               "4", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], 
               "+", 
               RowBox[{"Q1", " ", "Q2", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}], "+", 
               RowBox[{
               "4", " ", "Q1", " ", "q2", " ", "Q2", " ", "q4", " ", "x"}], 
               "+", 
               RowBox[{
               "2", " ", "Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}], 
               "-", 
               RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
                SuperscriptBox["q4", "2"], " ", "x"}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.683911433631783*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "U2", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"6", " ", "Q1", " ", 
    SuperscriptBox["Q2", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q3"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q4"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "6"}], " ", "e", " ", "Q1", " ", 
     SuperscriptBox["Q2", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"k2", "-", "r2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "q2", " ", "q3", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Q1", "2"], "-", 
             RowBox[{"2", " ", "Q1", " ", "q2"}], "+", 
             SuperscriptBox["q2", "2"], "+", 
             RowBox[{"2", " ", "q2", " ", "Q2"}], "-", 
             SuperscriptBox["Q2", "2"], "-", 
             RowBox[{"q2", " ", "q3"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q2", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"Q1", "-", "q2"}], ")"}], "2"], "-", 
                RowBox[{"4", " ", "q2", " ", "Q2"}], "-", 
                SuperscriptBox["Q2", "2"]}], ")"}]}], "-", 
             RowBox[{"3", " ", 
              RowBox[{"(", 
               RowBox[{"Q1", "-", "q2", "-", "Q2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"Q1", "-", "q2", "+", "Q2"}], ")"}], " ", "q3"}], "+", 
             
             RowBox[{"2", " ", "q2", " ", 
              SuperscriptBox["q3", "2"]}]}], ")"}], " ", "q4"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "+", 
             RowBox[{"3", " ", "Q2"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", 
           SuperscriptBox["q4", "3"]}]}], ")"}]}], "+", 
       RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", "r1"}], "+", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4", " ", "r1"}], "-", 
       RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "q4", " ", "r1"}], 
       "-", 
       RowBox[{"2", " ", "Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "q3", " ", "r2"}], "+", 
       RowBox[{"2", " ", "Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "q4", " ", "r2"}], "-", 
       RowBox[{"3", " ", "Q1", " ", "q2", " ", 
        SuperscriptBox["q4", "2"], " ", "r2"}], "+", 
       RowBox[{"3", " ", "Q1", " ", "q3", " ", 
        SuperscriptBox["q4", "2"], " ", "r2"}], "-", 
       RowBox[{"Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", "q4", " ", 
           RowBox[{"(", 
            RowBox[{"q3", "+", "q4"}], ")"}]}], "+", 
          RowBox[{"2", " ", "q2", " ", 
           RowBox[{"(", 
            RowBox[{"q3", "+", 
             RowBox[{"2", " ", "q4"}]}], ")"}]}]}], ")"}], " ", "x"}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.683911441237834*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "r1"], "%23", " ", 
  RowBox[{"(*", 
   RowBox[{"%23", " ", ":", " ", 
    RowBox[{"Simplify", "[", "U1", "]"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.683911490224128*^9, 3.683911490400432*^9}, {
  3.733851652943881*^9, 3.7338516640165052`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"6", " ", 
    SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q3"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q4"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "m"}], " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"k1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "q1", " ", 
        SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
       RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q3"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "+", 
       RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q4"}], "-", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4"}], "-", 
       RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3", " ", "q4"}], "+", 
       RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "q4"}]}], ")"}]}], 
    "+", 
    RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["q1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q4"}], ")"}]}], "-", 
       RowBox[{"6", " ", "q1", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
          RowBox[{
           SuperscriptBox["Q1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", "q2"}], "-", "q3", "-", 
             RowBox[{"2", " ", "q4"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Q2", "2"], " ", "q4"}], "-", 
          RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
          RowBox[{"q3", " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["q2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}], "-", 
          RowBox[{"2", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
             RowBox[{"q2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], 
          "-", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              SuperscriptBox["Q2", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q3", "2"]}], "+", 
             RowBox[{"3", " ", "q3", " ", "q4"}], "+", 
             SuperscriptBox["q4", "2"], "-", 
             RowBox[{"2", " ", "Q2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], "+", 
    RowBox[{"3", " ", "q1", " ", 
     SuperscriptBox["q2", "2"], " ", "Q2", " ", "r1"}], "-", 
    RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q3", " ", "r1"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", "r1"}], "-", 
    RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4", " ", "r1"}], "+", 
    RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3", " ", "q4", " ", "r1"}], "-", 
    RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "q4", " ", "r1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "q1", " ", 
        SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
       RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q3"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "-", 
       RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q4"}], "+", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4"}], "+", 
       RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
       RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "q4"}]}], ")"}], 
     " ", "r1"}], "-", 
    RowBox[{"2", " ", "Q1", " ", 
     SuperscriptBox["q2", "2"], " ", "q3", " ", "r2"}], "-", 
    RowBox[{"Q1", " ", 
     SuperscriptBox["q2", "2"], " ", "q4", " ", "r2"}], "+", 
    RowBox[{"3", " ", "Q1", " ", "q2", " ", "q3", " ", "q4", " ", "r2"}], "+", 
    RowBox[{"Q1", " ", 
     SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", "x"}], "-", 
    RowBox[{"Q1", " ", "q2", " ", "Q2", " ", 
     SuperscriptBox["q3", "2"], " ", "x"}], "-", 
    RowBox[{"Q1", " ", 
     SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4", " ", "x"}], "+", 
    RowBox[{"Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.683911492029048*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "r2"], "%25", " ", 
  RowBox[{"(*", 
   RowBox[{"%25", " ", ":", " ", 
    RowBox[{"Simplify", "[", "U2", "]"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.6839115040326633`*^9, 3.68391150502463*^9}, {
  3.733851666624127*^9, 3.733851676224524*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"6", " ", "Q1", " ", 
    SuperscriptBox["Q2", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q3"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q4"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "c"}], " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q2", " ", "q3", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q1", "2"], "-", 
          RowBox[{"2", " ", "Q1", " ", "q2"}], "+", 
          SuperscriptBox["q2", "2"], "+", 
          RowBox[{"2", " ", "q2", " ", "Q2"}], "-", 
          SuperscriptBox["Q2", "2"], "-", 
          RowBox[{"q2", " ", "q3"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"Q1", "-", "q2"}], ")"}], "2"], "-", 
             RowBox[{"4", " ", "q2", " ", "Q2"}], "-", 
             SuperscriptBox["Q2", "2"]}], ")"}]}], "-", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{"Q1", "-", "q2", "-", "Q2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Q1", "-", "q2", "+", "Q2"}], ")"}], " ", "q3"}], "+", 
          RowBox[{"2", " ", "q2", " ", 
           SuperscriptBox["q3", "2"]}]}], ")"}], " ", "q4"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"3", " ", "Q2"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", 
        SuperscriptBox["q4", "2"]}], "+", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", 
        SuperscriptBox["q4", "3"]}]}], ")"}]}], "-", 
    RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", "r1"}], "-", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4", " ", "r1"}], "+", 
    RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "q4", " ", "r1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "q3"}], "+", 
       RowBox[{"2", " ", "Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "q4"}], "-", 
       RowBox[{"3", " ", "Q1", " ", "q2", " ", 
        SuperscriptBox["q4", "2"]}], "+", 
       RowBox[{"3", " ", "Q1", " ", "q3", " ", 
        SuperscriptBox["q4", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"k2", "-", "r2"}], ")"}]}], "+", 
    RowBox[{"2", " ", "Q1", " ", 
     SuperscriptBox["q2", "2"], " ", "q3", " ", "r2"}], "-", 
    RowBox[{"2", " ", "Q1", " ", 
     SuperscriptBox["q2", "2"], " ", "q4", " ", "r2"}], "+", 
    RowBox[{"3", " ", "Q1", " ", "q2", " ", 
     SuperscriptBox["q4", "2"], " ", "r2"}], "-", 
    RowBox[{"3", " ", "Q1", " ", "q3", " ", 
     SuperscriptBox["q4", "2"], " ", "r2"}], "+", 
    RowBox[{"Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "q4", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "+", "q4"}], ")"}]}], "+", 
       RowBox[{"2", " ", "q2", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "+", 
          RowBox[{"2", " ", "q4"}]}], ")"}]}]}], ")"}], " ", "x"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.683911508140787*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"%26", "\[Equal]", "0"}], "&&", 
     RowBox[{"%27", "\[Equal]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r1", ",", "r2"}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%26", " ", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "r1"], "U1"}]}], " ", ",", " ", 
    RowBox[{"%27", " ", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "r2"], "U2"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6839115584022713`*^9, 3.683911561090249*^9}, {
  3.733851681368408*^9, 3.733851719841951*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"r1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", 
               SuperscriptBox["q2", "2"], " ", "q3"}], 
              RowBox[{"3", " ", 
               SuperscriptBox["Q2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"2", " ", 
               SuperscriptBox["q2", "2"], " ", "q4"}], 
              RowBox[{"3", " ", 
               SuperscriptBox["Q2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"q2", " ", 
               SuperscriptBox["q4", "2"]}], 
              RowBox[{
               SuperscriptBox["Q2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"q3", " ", 
               SuperscriptBox["q4", "2"]}], 
              RowBox[{
               SuperscriptBox["Q2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "q1", " ", 
                   RowBox[{"(", 
                    RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{"q3", "-", "q4"}], ")"}]}]}], ")"}]}], 
               RowBox[{"6", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]]}], "+", 
             FractionBox[
              RowBox[{"k1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], " ", "q1", " ", 
                  SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
                 RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q3"}], 
                 "-", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "+", 
                 RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q4"}], 
                 "-", 
                 RowBox[{
                  SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4"}], "-", 
                 RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3", " ", "q4"}], 
                 "+", 
                 RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "q4"}]}], 
                ")"}]}], 
              RowBox[{"6", " ", 
               SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"6", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]], 
              RowBox[{"c", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", 
                  SuperscriptBox["q1", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"q2", "-", "q4"}], ")"}]}], "-", 
                 RowBox[{"6", " ", "q1", " ", "Q1", " ", 
                  RowBox[{"(", 
                   RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
                 RowBox[{"q2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
                    RowBox[{
                    SuperscriptBox["Q1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "q2"}], "-", "q3", "-", 
                    RowBox[{"2", " ", "q4"}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["Q2", "2"], " ", "q4"}], "-", 
                    RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
                    RowBox[{"q3", " ", 
                    SuperscriptBox["q4", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["q2", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}], "-", 
                    RowBox[{"2", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
                    RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}],
                     "-", 
                    RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                    RowBox[{"3", " ", "q3", " ", "q4"}], "+", 
                    SuperscriptBox["q4", "2"], "-", 
                    RowBox[{"2", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], "+", 
             FractionBox[
              RowBox[{
               SuperscriptBox["q2", "2"], " ", "q3", " ", "x"}], 
              RowBox[{"6", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"q2", " ", 
               SuperscriptBox["q3", "2"], " ", "x"}], 
              RowBox[{"6", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{
               SuperscriptBox["q2", "2"], " ", "q4", " ", "x"}], 
              RowBox[{"6", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"q2", " ", "q3", " ", "q4", " ", "x"}], 
              RowBox[{"6", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{
                SuperscriptBox["q2", "2"], " ", "q3"}], 
               RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]]}], "-", 
             FractionBox[
              RowBox[{
               SuperscriptBox["q2", "2"], " ", "q4"}], 
              RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"q2", " ", "q3", " ", "q4"}], 
              RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"k2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "Q1", " ", 
                  SuperscriptBox["q2", "2"], " ", "q3"}], "+", 
                 RowBox[{"2", " ", "Q1", " ", 
                  SuperscriptBox["q2", "2"], " ", "q4"}], "-", 
                 RowBox[{"3", " ", "Q1", " ", "q2", " ", 
                  SuperscriptBox["q4", "2"]}], "+", 
                 RowBox[{"3", " ", "Q1", " ", "q3", " ", 
                  SuperscriptBox["q4", "2"]}]}], ")"}]}], 
              RowBox[{"6", " ", "Q1", " ", 
               SuperscriptBox["Q2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"6", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]], 
              RowBox[{"c", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q2", " ", "q3", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["Q1", "2"], "-", 
                    RowBox[{"2", " ", "Q1", " ", "q2"}], "+", 
                    SuperscriptBox["q2", "2"], "+", 
                    RowBox[{"2", " ", "q2", " ", "Q2"}], "-", 
                    SuperscriptBox["Q2", "2"], "-", 
                    RowBox[{"q2", " ", "q3"}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"Q1", "-", "q2"}], ")"}], "2"], "-", 
                    RowBox[{"4", " ", "q2", " ", "Q2"}], "-", 
                    SuperscriptBox["Q2", "2"]}], ")"}]}], "-", 
                    RowBox[{"3", " ", 
                    RowBox[{"(", 
                    RowBox[{"Q1", "-", "q2", "-", "Q2"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"Q1", "-", "q2", "+", "Q2"}], ")"}], " ", "q3"}], 
                    "+", 
                    RowBox[{"2", " ", "q2", " ", 
                    SuperscriptBox["q3", "2"]}]}], ")"}], " ", "q4"}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"q2", "+", 
                    RowBox[{"3", " ", "Q2"}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                  SuperscriptBox["q4", "2"]}], "+", 
                 RowBox[{"3", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", 
                  SuperscriptBox["q4", "3"]}]}], ")"}]}]}], "-", 
             FractionBox[
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
                 RowBox[{"q2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], 
              RowBox[{"6", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], " ", "q4", " ", 
                  RowBox[{"(", 
                   RowBox[{"q3", "+", "q4"}], ")"}]}], "+", 
                 RowBox[{"2", " ", "q2", " ", 
                  RowBox[{"(", 
                   RowBox[{"q3", "+", 
                    RowBox[{"2", " ", "q4"}]}], ")"}]}]}], ")"}], " ", "x"}], 
              
              RowBox[{"6", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]]}], ")"}]}]}], ")"}], "/", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox["q2", "2"], " ", "q3"}], 
                RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q4"}], ")"}]}]]}], "-", 
              FractionBox[
               RowBox[{
                SuperscriptBox["q2", "2"], " ", "q4"}], 
               RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
              FractionBox[
               RowBox[{"q2", " ", "q3", " ", "q4"}], 
               RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q4"}], ")"}]}]]}], ")"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", 
               SuperscriptBox["q2", "2"], " ", "q3"}], 
              RowBox[{"3", " ", 
               SuperscriptBox["Q2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"2", " ", 
               SuperscriptBox["q2", "2"], " ", "q4"}], 
              RowBox[{"3", " ", 
               SuperscriptBox["Q2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"q2", " ", 
               SuperscriptBox["q4", "2"]}], 
              RowBox[{
               SuperscriptBox["Q2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"q3", " ", 
               SuperscriptBox["q4", "2"]}], 
              RowBox[{
               SuperscriptBox["Q2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"q1", " ", 
               SuperscriptBox["q2", "2"]}], 
              RowBox[{"2", " ", 
               SuperscriptBox["Q1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"q1", " ", "q2", " ", "q3"}], 
              RowBox[{"2", " ", 
               SuperscriptBox["Q1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{
               SuperscriptBox["q2", "2"], " ", "q3"}], 
              RowBox[{"3", " ", 
               SuperscriptBox["Q1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"q1", " ", "q2", " ", "q4"}], 
              RowBox[{"2", " ", 
               SuperscriptBox["Q1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{
               SuperscriptBox["q2", "2"], " ", "q4"}], 
              RowBox[{"6", " ", 
               SuperscriptBox["Q1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"q1", " ", "q3", " ", "q4"}], 
              RowBox[{"2", " ", 
               SuperscriptBox["Q1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{"q2", " ", "q3", " ", "q4"}], 
              RowBox[{"2", " ", 
               SuperscriptBox["Q1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"3", " ", "q1", " ", 
                SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
               RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q3"}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "-", 
               RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q4"}], "+", 
               RowBox[{
                SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4"}], "+", 
               RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
               RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "q4"}]}], 
              RowBox[{"6", " ", 
               SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q4"}], ")"}]}]]}], ")"}]}]}], ")"}]}], 
       ")"}]}]}], ",", 
    RowBox[{"r2", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "12"}], " ", "k2", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "q3"}], "-", 
          RowBox[{"12", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "3"], " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", "q3"}], "-", 
          RowBox[{"6", " ", "k1", " ", "q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q3"}], "-", 
          RowBox[{"18", " ", "m", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q3"}], "+", 
          RowBox[{"6", " ", "c", " ", 
           SuperscriptBox["q1", "2"], " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q3"}], "+", 
          RowBox[{"12", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q3"}], "+", 
          RowBox[{"6", " ", "c", " ", 
           SuperscriptBox["Q1", "3"], " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q3"}], "-", 
          RowBox[{"12", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "5"], " ", "Q2", " ", "q3"}], "-", 
          RowBox[{"24", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", 
           SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
          RowBox[{"12", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", 
           SuperscriptBox["Q2", "3"], " ", "q3"}], "-", 
          RowBox[{"6", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", 
           SuperscriptBox["Q2", "3"], " ", "q3"}], "+", 
          RowBox[{"12", " ", "k2", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", 
           SuperscriptBox["q3", "2"]}], "-", 
          RowBox[{"8", " ", "k2", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", 
           SuperscriptBox["q3", "2"]}], "+", 
          RowBox[{"12", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "3"], " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"]}], "+", 
          RowBox[{"6", " ", "k1", " ", "q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"]}], "+", 
          RowBox[{"30", " ", "m", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"]}], "-", 
          RowBox[{"6", " ", "c", " ", 
           SuperscriptBox["q1", "2"], " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"]}], "-", 
          RowBox[{"12", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"]}], "-", 
          RowBox[{"10", " ", "c", " ", 
           SuperscriptBox["Q1", "3"], " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"]}], "-", 
          RowBox[{"4", " ", "k1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"]}], "-", 
          RowBox[{"10", " ", "m", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"]}], "+", 
          RowBox[{"24", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"]}], "+", 
          RowBox[{"8", " ", "c", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"]}], "-", 
          RowBox[{"4", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "5"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"]}], "+", 
          RowBox[{"24", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox["q3", "2"]}], "-", 
          RowBox[{"8", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox["q3", "2"]}], "-", 
          RowBox[{"12", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["Q2", "3"], " ", 
           SuperscriptBox["q3", "2"]}], "+", 
          RowBox[{"10", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", 
           SuperscriptBox["Q2", "3"], " ", 
           SuperscriptBox["q3", "2"]}], "-", 
          RowBox[{"12", " ", "m", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "3"]}], "+", 
          RowBox[{"10", " ", "m", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "3"]}], "-", 
          RowBox[{"12", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "3"]}], "+", 
          RowBox[{"4", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", 
           SuperscriptBox["q3", "3"]}], "+", 
          RowBox[{"12", " ", "k2", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "q4"}], "-", 
          RowBox[{"6", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "3"], " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", "q4"}], "-", 
          RowBox[{"3", " ", "k1", " ", "q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q4"}], "-", 
          RowBox[{"9", " ", "m", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q4"}], "+", 
          RowBox[{"3", " ", "c", " ", 
           SuperscriptBox["q1", "2"], " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q4"}], "+", 
          RowBox[{"6", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q4"}], "+", 
          RowBox[{"3", " ", "c", " ", 
           SuperscriptBox["Q1", "3"], " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q4"}], "-", 
          RowBox[{"6", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "5"], " ", "Q2", " ", "q4"}], "+", 
          RowBox[{"24", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", 
           SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
          RowBox[{"6", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", 
           SuperscriptBox["Q2", "3"], " ", "q4"}], "-", 
          RowBox[{"3", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", 
           SuperscriptBox["Q2", "3"], " ", "q4"}], "+", 
          RowBox[{"4", " ", "k2", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "q3", " ", "q4"}], "+", 
          RowBox[{"36", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "3"], " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", "q4"}], "+", 
          
          RowBox[{"18", " ", "k1", " ", "q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", "q3", " ", "q4"}], "+", 
          
          RowBox[{"60", " ", "m", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", "q3", " ", "q4"}], "-", 
          
          RowBox[{"18", " ", "c", " ", 
           SuperscriptBox["q1", "2"], " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", "q3", " ", "q4"}], "-", 
          
          RowBox[{"36", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", "q3", " ", "q4"}], "-", 
          
          RowBox[{"22", " ", "c", " ", 
           SuperscriptBox["Q1", "3"], " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", "q3", " ", "q4"}], "-", 
          
          RowBox[{"4", " ", "k1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q3", " ", "q4"}], "-", 
          
          RowBox[{"7", " ", "m", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q3", " ", "q4"}], "+", 
          
          RowBox[{"36", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q3", " ", "q4"}], "+", 
          
          RowBox[{"8", " ", "c", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q3", " ", "q4"}], "-", 
          
          RowBox[{"4", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "5"], " ", "Q2", " ", "q3", " ", "q4"}], "+", 
          
          RowBox[{"16", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", 
           SuperscriptBox["Q2", "2"], " ", "q3", " ", "q4"}], "-", 
          RowBox[{"36", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["Q2", "3"], " ", "q3", " ", "q4"}], "+", 
          RowBox[{"22", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", 
           SuperscriptBox["Q2", "3"], " ", "q3", " ", "q4"}], "-", 
          RowBox[{"12", " ", "k2", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
          RowBox[{"12", " ", "k2", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
          RowBox[{"30", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "3"], " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
          RowBox[{"15", " ", "k1", " ", "q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
          RowBox[{"81", " ", "m", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
          RowBox[{"15", " ", "c", " ", 
           SuperscriptBox["q1", "2"], " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
          RowBox[{"30", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
          RowBox[{"27", " ", "c", " ", 
           SuperscriptBox["Q1", "3"], " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
          RowBox[{"12", " ", "k1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
          RowBox[{"34", " ", "m", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
          RowBox[{"54", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
          RowBox[{"24", " ", "c", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
          RowBox[{"14", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
          RowBox[{"24", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
          RowBox[{"30", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", 
           SuperscriptBox["Q2", "3"], " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
          RowBox[{"27", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["Q2", "3"], " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
          RowBox[{
          "30", " ", "m", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", "q4"}], "-", 
          RowBox[{"27", " ", "m", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", "q4"}], "+", 
          RowBox[{"24", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", "q4"}], "-", 
          RowBox[{"10", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", "q4"}], "-", 
          RowBox[{"30", " ", "k2", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"4", " ", "k2", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"6", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "3"], " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"3", " ", "k1", " ", "q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"9", " ", "m", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"3", " ", "c", " ", 
           SuperscriptBox["q1", "2"], " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"6", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"4", " ", "c", " ", 
           SuperscriptBox["Q1", "3"], " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"k1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"m", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"6", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"2", " ", "c", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"c", " ", "Q1", " ", 
           SuperscriptBox["q2", "5"], " ", "Q2", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"60", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"10", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"6", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["Q2", "3"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"4", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", 
           SuperscriptBox["Q2", "3"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"48", " ", "k2", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"24", " ", "k2", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"24", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "3"], " ", "q2", " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"12", " ", "k1", " ", "q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"42", " ", "m", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"12", " ", "c", " ", 
           SuperscriptBox["q1", "2"], " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"24", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"18", " ", "c", " ", 
           SuperscriptBox["Q1", "3"], " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"6", " ", "k1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"10", " ", "m", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"12", " ", "c", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"4", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"96", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"60", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", 
           SuperscriptBox["Q2", "2"], " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"24", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", 
           SuperscriptBox["Q2", "3"], " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"18", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["Q2", "3"], " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"18", " ", "k2", " ", "q1", " ", "Q1", " ", "q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"12", " ", "k2", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"18", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"9", " ", "k1", " ", "q1", " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{
          "51", " ", "m", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"9", " ", "c", " ", 
           SuperscriptBox["q1", "2"], " ", "Q1", " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"18", " ", "c", " ", "q1", " ", 
           SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"18", " ", "c", " ", 
           SuperscriptBox["Q1", "3"], " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"9", " ", "k1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"27", " ", "m", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"18", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"18", " ", "c", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"c", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"36", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"42", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"18", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["Q2", "3"], " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"18", " ", "c", " ", "Q1", " ", "q2", " ", 
           SuperscriptBox["Q2", "3"], " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"18", " ", "m", " ", "q1", " ", "Q1", " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"18", " ", "m", " ", "Q1", " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{
          "12", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"6", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", 
           SuperscriptBox["q4", "2"]}], "+", 
          RowBox[{"18", " ", "k2", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["q4", "3"]}], "-", 
          RowBox[{"6", " ", "k2", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", 
           SuperscriptBox["q4", "3"]}], "+", 
          RowBox[{"30", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q4", "3"]}], "-", 
          RowBox[{"5", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", 
           SuperscriptBox["q4", "3"]}], "+", 
          RowBox[{"36", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox["q4", "3"]}], "-", 
          RowBox[{"12", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox["q4", "3"]}], "-", 
          RowBox[{
          "36", " ", "k2", " ", "q1", " ", "Q1", " ", "q2", " ", "q3", " ", 
           SuperscriptBox["q4", "3"]}], "+", 
          RowBox[{"24", " ", "k2", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "q3", " ", 
           SuperscriptBox["q4", "3"]}], "-", 
          RowBox[{"60", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "3"]}], "+", 
          RowBox[{"32", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "3"]}], "-", 
          RowBox[{"72", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", 
           SuperscriptBox["Q2", "2"], " ", "q3", " ", 
           SuperscriptBox["q4", "3"]}], "+", 
          RowBox[{"48", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", "q3", " ", 
           SuperscriptBox["q4", "3"]}], "+", 
          RowBox[{"18", " ", "k2", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "3"]}], "-", 
          RowBox[{"18", " ", "k2", " ", "Q1", " ", "q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "3"]}], "+", 
          RowBox[{
          "30", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "3"]}], "-", 
          RowBox[{"27", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "3"]}], "+", 
          RowBox[{"36", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "3"]}], "-", 
          RowBox[{"36", " ", "c", " ", "Q1", " ", "q2", " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "3"]}], "-", 
          RowBox[{"18", " ", "c", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q4", "4"]}], "+", 
          RowBox[{"6", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q4", "4"]}], "+", 
          RowBox[{
          "36", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", 
           "q3", " ", 
           SuperscriptBox["q4", "4"]}], "-", 
          RowBox[{"24", " ", "c", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "4"]}], "-", 
          RowBox[{"18", " ", "c", " ", "q1", " ", "Q1", " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "4"]}], "+", 
          RowBox[{"18", " ", "c", " ", "Q1", " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "4"]}], "+", 
          RowBox[{"12", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q3", " ", "x"}], "-", 
          RowBox[{"24", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "x"}], "+", 
          RowBox[{"10", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "x"}], "+", 
          RowBox[{"12", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", "x"}], "-", 
          RowBox[{"10", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", "x"}], "+", 
          RowBox[{"24", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q4", " ", "x"}], "-", 
          RowBox[{"78", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", "q3", " ", "q4", " ", 
           "x"}], "+", 
          RowBox[{"19", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", "q3", " ", "q4", " ", 
           "x"}], "+", 
          RowBox[{"84", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4", " ", "x"}], "-", 
          RowBox[{"46", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", "q4", " ", "x"}], "-", 
          RowBox[{"30", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", "q4", " ", "x"}], "+", 
          RowBox[{"27", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", "q4", " ", "x"}], "-", 
          RowBox[{"42", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q4", "2"], " ", "x"}], "+", 
          RowBox[{"7", " ", "Q1", " ", 
           SuperscriptBox["q2", "4"], " ", "Q2", " ", 
           SuperscriptBox["q4", "2"], " ", "x"}], "+", 
          RowBox[{"102", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "2"], " ", "x"}], "-", 
          RowBox[{"46", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "2"], " ", "x"}], "-", 
          RowBox[{"78", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"], " ", "x"}], "+", 
          RowBox[{"57", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"], " ", "x"}], "+", 
          RowBox[{"18", " ", "q1", " ", "Q1", " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", 
           SuperscriptBox["q4", "2"], " ", "x"}], "-", 
          RowBox[{"18", " ", "Q1", " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "3"], " ", 
           SuperscriptBox["q4", "2"], " ", "x"}], "+", 
          RowBox[{"18", " ", "q1", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", 
           SuperscriptBox["q4", "3"], " ", "x"}], "-", 
          RowBox[{"6", " ", "Q1", " ", 
           SuperscriptBox["q2", "3"], " ", "Q2", " ", 
           SuperscriptBox["q4", "3"], " ", "x"}], "-", 
          RowBox[{
          "36", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "3"], " ", "x"}], "+", 
          RowBox[{"24", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3", " ", 
           SuperscriptBox["q4", "3"], " ", "x"}], "+", 
          RowBox[{"18", " ", "q1", " ", "Q1", " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "3"], " ", "x"}], "-", 
          RowBox[{"18", " ", "Q1", " ", "q2", " ", "Q2", " ", 
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "3"], " ", "x"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"8", " ", "q1", " ", 
             SuperscriptBox["q2", "4"], " ", "q3"}], "-", 
            RowBox[{"8", " ", "q1", " ", 
             SuperscriptBox["q2", "3"], " ", 
             SuperscriptBox["q3", "2"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["q2", "4"], " ", 
             SuperscriptBox["q3", "2"]}], "-", 
            RowBox[{"8", " ", "q1", " ", 
             SuperscriptBox["q2", "4"], " ", "q4"}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["q2", "4"], " ", "q3", " ", "q4"}], "+", 
            RowBox[{"8", " ", "q1", " ", 
             SuperscriptBox["q2", "2"], " ", 
             SuperscriptBox["q3", "2"], " ", "q4"}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["q2", "3"], " ", 
             SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
            RowBox[{"20", " ", "q1", " ", 
             SuperscriptBox["q2", "3"], " ", 
             SuperscriptBox["q4", "2"]}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["q2", "4"], " ", 
             SuperscriptBox["q4", "2"]}], "-", 
            RowBox[{"32", " ", "q1", " ", 
             SuperscriptBox["q2", "2"], " ", "q3", " ", 
             SuperscriptBox["q4", "2"]}], "+", 
            RowBox[{"18", " ", 
             SuperscriptBox["q2", "3"], " ", "q3", " ", 
             SuperscriptBox["q4", "2"]}], "+", 
            RowBox[{"12", " ", "q1", " ", "q2", " ", 
             SuperscriptBox["q3", "2"], " ", 
             SuperscriptBox["q4", "2"]}], "-", 
            RowBox[{"11", " ", 
             SuperscriptBox["q2", "2"], " ", 
             SuperscriptBox["q3", "2"], " ", 
             SuperscriptBox["q4", "2"]}], "-", 
            RowBox[{"12", " ", "q1", " ", 
             SuperscriptBox["q2", "2"], " ", 
             SuperscriptBox["q4", "3"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["q2", "3"], " ", 
             SuperscriptBox["q4", "3"]}], "+", 
            RowBox[{"24", " ", "q1", " ", "q2", " ", "q3", " ", 
             SuperscriptBox["q4", "3"]}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox["q2", "2"], " ", "q3", " ", 
             SuperscriptBox["q4", "3"]}], "-", 
            RowBox[{"12", " ", "q1", " ", 
             SuperscriptBox["q3", "2"], " ", 
             SuperscriptBox["q4", "3"]}], "+", 
            RowBox[{"12", " ", "q2", " ", 
             SuperscriptBox["q3", "2"], " ", 
             SuperscriptBox["q4", "3"]}]}], ")"}]}], ")"}]}], ")"}]}]}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6839116910591*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Finding the equation for the situation that price constraint is violated:\
\>", "Subtitle",
 CellChangeTimes->{{3.733851740337942*^9, 3.733851766882955*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%27", "\[Equal]", "0"}], ",", "r2"}], "]"}], " ", 
  RowBox[{"(*", "  ", 
   RowBox[{"%27", " ", ":", " ", 
    RowBox[{
     SubscriptBox["\[PartialD]", "r2"], "U2"}]}], "  ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6839119726029997`*^9, 3.6839119734445467`*^9}, {
  3.733851819876305*^9, 3.733851824228346*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"k2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "Q1", " ", 
             SuperscriptBox["q2", "2"], " ", "q3"}], "+", 
            RowBox[{"2", " ", "Q1", " ", 
             SuperscriptBox["q2", "2"], " ", "q4"}], "-", 
            RowBox[{"3", " ", "Q1", " ", "q2", " ", 
             SuperscriptBox["q4", "2"]}], "+", 
            RowBox[{"3", " ", "Q1", " ", "q3", " ", 
             SuperscriptBox["q4", "2"]}]}], ")"}]}], 
         RowBox[{"6", " ", "Q1", " ", 
          SuperscriptBox["Q2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q4"}], ")"}]}]]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"6", " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q4"}], ")"}]}]], 
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "q2", " ", "q3", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q1", "2"], "-", 
              RowBox[{"2", " ", "Q1", " ", "q2"}], "+", 
              SuperscriptBox["q2", "2"], "+", 
              RowBox[{"2", " ", "q2", " ", "Q2"}], "-", 
              SuperscriptBox["Q2", "2"], "-", 
              RowBox[{"q2", " ", "q3"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"Q1", "-", "q2"}], ")"}], "2"], "-", 
                 RowBox[{"4", " ", "q2", " ", "Q2"}], "-", 
                 SuperscriptBox["Q2", "2"]}], ")"}]}], "-", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"Q1", "-", "q2", "-", "Q2"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"Q1", "-", "q2", "+", "Q2"}], ")"}], " ", "q3"}], "+", 
              RowBox[{"2", " ", "q2", " ", 
               SuperscriptBox["q3", "2"]}]}], ")"}], " ", "q4"}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "+", 
              RowBox[{"3", " ", "Q2"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], " ", 
            SuperscriptBox["q4", "2"]}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", 
            SuperscriptBox["q4", "3"]}]}], ")"}]}]}], "+", 
       FractionBox[
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], 
        RowBox[{"6", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "q3", " ", "r1"}], 
        RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "q4", " ", "r1"}], 
        RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"q2", " ", "q3", " ", "q4", " ", "r1"}], 
        RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", "q4", " ", 
            RowBox[{"(", 
             RowBox[{"q3", "+", "q4"}], ")"}]}], "+", 
           RowBox[{"2", " ", "q2", " ", 
            RowBox[{"(", 
             RowBox[{"q3", "+", 
              RowBox[{"2", " ", "q4"}]}], ")"}]}]}], ")"}], " ", "x"}], 
        RowBox[{"6", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "q3"}], 
        RowBox[{"3", " ", 
         SuperscriptBox["Q2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "q4"}], 
        RowBox[{"3", " ", 
         SuperscriptBox["Q2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"q2", " ", 
         SuperscriptBox["q4", "2"]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["Q2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"q3", " ", 
         SuperscriptBox["q4", "2"]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["Q2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "q3"}], "+", 
         RowBox[{"2", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "q4"}], "-", 
         RowBox[{"3", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["q4", "2"]}], "+", 
         RowBox[{"3", " ", "Q1", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}]}], 
        RowBox[{"6", " ", "Q1", " ", 
         SuperscriptBox["Q2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.683911976981482*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q2", "*", 
    RowBox[{"r1", "/", "Q1"}]}], "+", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q1"}], ")"}], "^", "2"}]}], "-", 
   RowBox[{"q2", "*", 
    RowBox[{"r2", "/", "Q2"}]}], "-", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q2"}], ")"}], "^", "2"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", "%35"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.683912085611795*^9, 3.683912086715686*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q2", " ", "r1"}], "Q1"], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k2", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["q2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
          RowBox[{"3", " ", "q2", " ", 
           SuperscriptBox["q4", "2"]}], "-", 
          RowBox[{"3", " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}]}], ")"}]}], "+", 
       RowBox[{"Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "m", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "q3"}], "-", 
          RowBox[{"2", " ", "m", " ", "Q1", " ", "q2", " ", 
           SuperscriptBox["q3", "2"]}], "+", 
          RowBox[{"m", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "q4"}], "-", 
          RowBox[{"4", " ", "m", " ", "Q1", " ", "q2", " ", "q3", " ", "q4"}],
           "+", 
          RowBox[{"3", " ", "m", " ", "Q1", " ", 
           SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
          RowBox[{"c", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", "q3", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Q2", "-", "q4"}], ")"}], "2"], " ", "q4"}], "+", 
             RowBox[{
              SuperscriptBox["q2", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["q2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["q3", "2"]}], "+", 
                RowBox[{"4", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q3", "-", "q4"}], ")"}]}], "-", 
                RowBox[{"3", " ", "q3", " ", "q4"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q4", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["Q1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
                RowBox[{"q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], 
             "-", 
             RowBox[{"2", " ", "Q1", " ", "q2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
                RowBox[{"q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], 
             "-", 
             RowBox[{"q2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "6"}], " ", "Q2", " ", 
                 SuperscriptBox["q4", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["Q2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}], "+", 
                RowBox[{"q4", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                   RowBox[{"2", " ", "q3", " ", "q4"}], "+", 
                   RowBox[{"3", " ", 
                    SuperscriptBox["q4", "2"]}]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["q2", "2"], " ", "q3", " ", "r1"}], "+", 
          RowBox[{
           SuperscriptBox["q2", "2"], " ", "q4", " ", "r1"}], "-", 
          RowBox[{"3", " ", "q2", " ", "q3", " ", "q4", " ", "r1"}], "-", 
          RowBox[{"2", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "q3", " ", "x"}], "+", 
          RowBox[{"2", " ", "Q1", " ", "q2", " ", 
           SuperscriptBox["q3", "2"], " ", "x"}], "-", 
          RowBox[{"4", " ", "Q1", " ", 
           SuperscriptBox["q2", "2"], " ", "q4", " ", "x"}], "+", 
          RowBox[{"7", " ", "Q1", " ", "q2", " ", "q3", " ", "q4", " ", "x"}],
           "-", 
          RowBox[{"3", " ", "Q1", " ", 
           SuperscriptBox["q3", "2"], " ", "q4", " ", "x"}], "+", 
          RowBox[{"3", " ", "Q1", " ", "q2", " ", 
           SuperscriptBox["q4", "2"], " ", "x"}], "-", 
          RowBox[{"3", " ", "Q1", " ", "q3", " ", 
           SuperscriptBox["q4", "2"], " ", "x"}]}], ")"}]}]}], ")"}]}], ")"}],
    "/", 
   RowBox[{"(", 
    RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["q2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
       RowBox[{"3", " ", "q2", " ", 
        SuperscriptBox["q4", "2"]}], "-", 
       RowBox[{"3", " ", "q3", " ", 
        SuperscriptBox["q4", "2"]}]}], ")"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.6839120976089153`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%36", "\[Equal]", "0"}], ",", "r1"}], "]"}]], "Input",
 CellChangeTimes->{{3.68391210307117*^9, 3.68391211278071*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"]}], "+", 
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], "+", 
       FractionBox[
        RowBox[{"k2", " ", "q2"}], 
        RowBox[{"2", " ", "Q2"}]], "+", 
       FractionBox[
        RowBox[{"m", " ", 
         SuperscriptBox["q2", "3"], " ", "q3"}], 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["q2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
         RowBox[{"3", " ", "q2", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"3", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}]}]], "-", 
       FractionBox[
        RowBox[{"m", " ", 
         SuperscriptBox["q2", "2"], " ", 
         SuperscriptBox["q3", "2"]}], 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["q2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
         RowBox[{"3", " ", "q2", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"3", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}]}]], "+", 
       FractionBox[
        RowBox[{"m", " ", 
         SuperscriptBox["q2", "3"], " ", "q4"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["q2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"3", " ", "q2", " ", 
            SuperscriptBox["q4", "2"]}], "-", 
           RowBox[{"3", " ", "q3", " ", 
            SuperscriptBox["q4", "2"]}]}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"2", " ", "m", " ", 
         SuperscriptBox["q2", "2"], " ", "q3", " ", "q4"}], 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["q2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
         RowBox[{"3", " ", "q2", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"3", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}]}]], "+", 
       FractionBox[
        RowBox[{"3", " ", "m", " ", "q2", " ", 
         SuperscriptBox["q3", "2"], " ", "q4"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["q2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"3", " ", "q2", " ", 
            SuperscriptBox["q4", "2"]}], "-", 
           RowBox[{"3", " ", "q3", " ", 
            SuperscriptBox["q4", "2"]}]}], ")"}]}]], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["q2", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
            RowBox[{"3", " ", "q2", " ", 
             SuperscriptBox["q4", "2"]}], "-", 
            RowBox[{"3", " ", "q3", " ", 
             SuperscriptBox["q4", "2"]}]}], ")"}]}]], 
        RowBox[{"c", " ", "q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q3", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"Q2", "-", "q4"}], ")"}], "2"], " ", "q4"}], "+", 
           RowBox[{
            SuperscriptBox["q2", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["q2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["q3", "2"]}], "+", 
              RowBox[{"4", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q3", "-", "q4"}], ")"}]}], "-", 
              RowBox[{"3", " ", "q3", " ", "q4"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["q4", "2"]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["Q1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
              RowBox[{"q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], 
           "-", 
           RowBox[{"2", " ", "Q1", " ", "q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
              RowBox[{"q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}], 
           "-", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "6"}], " ", "Q2", " ", 
               SuperscriptBox["q4", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["Q2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}], "+", 
              RowBox[{"q4", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", 
                  SuperscriptBox["q3", "2"]}], "+", 
                 RowBox[{"2", " ", "q3", " ", "q4"}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["q4", "2"]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "3"], " ", "q3", " ", "x"}], 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["q2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
         RowBox[{"3", " ", "q2", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"3", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}]}]], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", 
         SuperscriptBox["q3", "2"], " ", "x"}], 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["q2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
         RowBox[{"3", " ", "q2", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"3", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}]}]], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["q2", "3"], " ", "q4", " ", "x"}], 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["q2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
         RowBox[{"3", " ", "q2", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"3", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}]}]], "+", 
       FractionBox[
        RowBox[{"7", " ", 
         SuperscriptBox["q2", "2"], " ", "q3", " ", "q4", " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["q2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"3", " ", "q2", " ", 
            SuperscriptBox["q4", "2"]}], "-", 
           RowBox[{"3", " ", "q3", " ", 
            SuperscriptBox["q4", "2"]}]}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "q2", " ", 
         SuperscriptBox["q3", "2"], " ", "q4", " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["q2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"3", " ", "q2", " ", 
            SuperscriptBox["q4", "2"]}], "-", 
           RowBox[{"3", " ", "q3", " ", 
            SuperscriptBox["q4", "2"]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"3", " ", 
         SuperscriptBox["q2", "2"], " ", 
         SuperscriptBox["q4", "2"], " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["q2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"3", " ", "q2", " ", 
            SuperscriptBox["q4", "2"]}], "-", 
           RowBox[{"3", " ", "q3", " ", 
            SuperscriptBox["q4", "2"]}]}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"3", " ", "q2", " ", "q3", " ", 
         SuperscriptBox["q4", "2"], " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["q2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"3", " ", "q2", " ", 
            SuperscriptBox["q4", "2"]}], "-", 
           RowBox[{"3", " ", "q3", " ", 
            SuperscriptBox["q4", "2"]}]}], ")"}]}]]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["q2", "Q1"], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "3"], " ", "q3"}], 
        RowBox[{"Q1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["q2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"3", " ", "q2", " ", 
            SuperscriptBox["q4", "2"]}], "-", 
           RowBox[{"3", " ", "q3", " ", 
            SuperscriptBox["q4", "2"]}]}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "3"], " ", "q4"}], 
        RowBox[{"2", " ", "Q1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["q2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"3", " ", "q2", " ", 
            SuperscriptBox["q4", "2"]}], "-", 
           RowBox[{"3", " ", "q3", " ", 
            SuperscriptBox["q4", "2"]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"3", " ", 
         SuperscriptBox["q2", "2"], " ", "q3", " ", "q4"}], 
        RowBox[{"2", " ", "Q1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["q2", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"3", " ", "q2", " ", 
            SuperscriptBox["q4", "2"]}], "-", 
           RowBox[{"3", " ", "q3", " ", 
            SuperscriptBox["q4", "2"]}]}], ")"}]}]]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.683912114927518*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%26", "\[Equal]", "0"}], ",", "r1"}], "]"}]], "Input",
 CellChangeTimes->{{3.6839122213816557`*^9, 3.6839122297743387`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}]}], ")"}]}], 
        RowBox[{"6", " ", "Q1", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"k1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", "q1", " ", 
            SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
           RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q3"}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "+", 
           RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q4"}], "-", 
           RowBox[{
            SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4"}], "-", 
           RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3", " ", "q4"}], "+", 
           RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "q4"}]}], 
          ")"}]}], 
        RowBox[{"6", " ", 
         SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"6", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q4"}], ")"}]}]], 
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", 
            SuperscriptBox["q1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "-", 
           RowBox[{"6", " ", "q1", " ", "Q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
              RowBox[{
               SuperscriptBox["Q1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", "q2"}], "-", "q3", "-", 
                 RowBox[{"2", " ", "q4"}]}], ")"}]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["Q2", "2"], " ", "q4"}], "-", 
              RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
              RowBox[{"q3", " ", 
               SuperscriptBox["q4", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["q2", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}], "-", 
              RowBox[{"2", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
                 RowBox[{"q2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}],
               "-", 
              RowBox[{"q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", 
                  SuperscriptBox["Q2", "2"]}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["q3", "2"]}], "+", 
                 RowBox[{"3", " ", "q3", " ", "q4"}], "+", 
                 SuperscriptBox["q4", "2"], "-", 
                 RowBox[{"2", " ", "Q2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], ")"}]}]}], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "q3", " ", "r2"}], 
        RowBox[{"3", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "q4", " ", "r2"}], 
        RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"q2", " ", "q3", " ", "q4", " ", "r2"}], 
        RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "q3", " ", "x"}], 
        RowBox[{"6", " ", "Q1", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"q2", " ", 
         SuperscriptBox["q3", "2"], " ", "x"}], 
        RowBox[{"6", " ", "Q1", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "q4", " ", "x"}], 
        RowBox[{"6", " ", "Q1", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"q2", " ", "q3", " ", "q4", " ", "x"}], 
        RowBox[{"6", " ", "Q1", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"q1", " ", 
         SuperscriptBox["q2", "2"]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["Q1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"q1", " ", "q2", " ", "q3"}], 
        RowBox[{"2", " ", 
         SuperscriptBox["Q1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "q3"}], 
        RowBox[{"3", " ", 
         SuperscriptBox["Q1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"q1", " ", "q2", " ", "q4"}], 
        RowBox[{"2", " ", 
         SuperscriptBox["Q1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "q4"}], 
        RowBox[{"6", " ", 
         SuperscriptBox["Q1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"q1", " ", "q3", " ", "q4"}], 
        RowBox[{"2", " ", 
         SuperscriptBox["Q1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"q2", " ", "q3", " ", "q4"}], 
        RowBox[{"2", " ", 
         SuperscriptBox["Q1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"3", " ", "q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
         RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "q4"}], "+", 
         RowBox[{
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q4"}], "+", 
         RowBox[{"3", " ", "q1", " ", "Q2", " ", "q3", " ", "q4"}], "-", 
         RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "q4"}]}], 
        RowBox[{"6", " ", 
         SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q4"}], ")"}]}]]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6839122803532352`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q3", "*", 
    RowBox[{"r2", "/", "Q2"}]}], "+", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q3", "-", "Q2"}], ")"}], "^", "2"}]}], "-", 
   RowBox[{"q3", "*", 
    RowBox[{"r1", "/", "Q1"}]}], "-", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q3", "-", "Q1"}], ")"}], "^", "2"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", "%42"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.683912387490555*^9, 3.683912388498815*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "c"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q3"}], ")"}], "2"]}], "+", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q3", " ", "r2"}], "Q2"], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"q3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "q1", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
             RowBox[{"q2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{"Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", "q1", " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
             RowBox[{"q2", " ", 
              RowBox[{"(", 
               RowBox[{"q3", "-", "q4"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"c", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", 
              SuperscriptBox["q1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", "q3"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
             RowBox[{"6", " ", "q1", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", "q3"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", "q4"}], ")"}]}], "-", 
             RowBox[{"q2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
                RowBox[{
                 SuperscriptBox["Q1", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", " ", "q2"}], "-", "q3", "-", 
                   RowBox[{"2", " ", "q4"}]}], ")"}]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["Q2", "2"], " ", "q4"}], "-", 
                RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
                RowBox[{"q3", " ", 
                 SuperscriptBox["q4", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["q2", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}], "-", 
                RowBox[{"2", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
                   RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}],
                 "-", 
                RowBox[{"q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "+", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "+", 
                   RowBox[{"3", " ", "q3", " ", "q4"}], "+", 
                   SuperscriptBox["q4", "2"], "-", 
                   RowBox[{"2", " ", "Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "q3", " ", "r2"}], "+", 
                RowBox[{"q4", " ", "r2"}], "-", 
                RowBox[{"Q2", " ", "q3", " ", "x"}], "+", 
                RowBox[{"Q2", " ", "q4", " ", "x"}]}], ")"}]}], "+", 
             RowBox[{"q3", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Q2", " ", "q3", " ", "x"}], "-", 
                RowBox[{"q4", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", " ", "r2"}], "+", 
                   RowBox[{"Q2", " ", "x"}]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
      ")"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.683912391076124*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%43", "\[Equal]", "0"}], ",", "r2"}], "]"}]], "Input",
 CellChangeTimes->{{3.683912393137348*^9, 3.6839124026752377`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"k1", " ", "q3"}], 
        RowBox[{"2", " ", "Q1"}]], "+", 
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q1"}], "+", "q3"}], ")"}], "2"]}], "-", 
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"]}], "+", 
       FractionBox[
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}], " ", "q3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
              RowBox[{"q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"c", " ", "q3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", 
             SuperscriptBox["q1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
            RowBox[{"6", " ", "q1", " ", "Q1", " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q4"}], ")"}]}], "-", 
            RowBox[{"q2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
               RowBox[{
                SuperscriptBox["Q1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "q2"}], "-", "q3", "-", 
                  RowBox[{"2", " ", "q4"}]}], ")"}]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["Q2", "2"], " ", "q4"}], "-", 
               RowBox[{"6", " ", "Q2", " ", "q3", " ", "q4"}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["q3", "2"], " ", "q4"}], "+", 
               RowBox[{"q3", " ", 
                SuperscriptBox["q4", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["q2", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}], "-", 
               RowBox[{"2", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}],
                "-", 
               RowBox[{"q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   SuperscriptBox["Q2", "2"]}], "+", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["q3", "2"]}], "+", 
                  RowBox[{"3", " ", "q3", " ", "q4"}], "+", 
                  SuperscriptBox["q4", "2"], "-", 
                  RowBox[{"2", " ", "Q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", "q1", " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
            RowBox[{"q2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
               RowBox[{"q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}]}],
            ")"}]}], ")"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", 
         SuperscriptBox["q3", "2"], " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
              RowBox[{"q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]], "+", 
       FractionBox[
        RowBox[{"q2", " ", 
         SuperscriptBox["q3", "3"], " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
              RowBox[{"q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "q3", " ", "q4", " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
              RowBox[{"q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]], "-", 
       FractionBox[
        RowBox[{"q2", " ", 
         SuperscriptBox["q3", "2"], " ", "q4", " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
              RowBox[{"q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["q3", "Q2"], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", 
         SuperscriptBox["q3", "2"]}], 
        RowBox[{"Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
              RowBox[{"q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["q2", "2"], " ", "q3", " ", "q4"}], 
        RowBox[{"2", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
              RowBox[{"q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]], "+", 
       FractionBox[
        RowBox[{"3", " ", "q2", " ", 
         SuperscriptBox["q3", "2"], " ", "q4"}], 
        RowBox[{"2", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", "q3", " ", "q4"}], "+", 
              RowBox[{"q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q3"}], "+", "q4"}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]]}], ")"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.683912404307173*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 981},
WindowMargins->{{-10, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.4 for Linux x86 (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 607, 15, 121, "Text"],
Cell[CellGroupData[{
Cell[1190, 39, 159, 5, 58, "Input"],
Cell[1352, 46, 249, 8, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1638, 59, 235, 8, 58, "Input"],
Cell[1876, 69, 341, 13, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2254, 87, 235, 8, 58, "Input"],
Cell[2492, 97, 343, 13, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2872, 115, 159, 5, 58, "Input"],
Cell[3034, 122, 230, 8, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3301, 135, 375, 12, 59, "Input"],
Cell[3679, 149, 901, 34, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4617, 188, 375, 12, 59, "Input"],
Cell[4995, 202, 1327, 50, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6359, 257, 375, 12, 59, "Input"],
Cell[6737, 271, 1327, 50, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8101, 326, 375, 12, 59, "Input"],
Cell[8479, 340, 940, 35, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9456, 380, 148, 4, 34, "Input"],
Cell[9607, 386, 1080, 41, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10724, 432, 148, 4, 34, "Input"],
Cell[10875, 438, 1668, 64, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12580, 507, 89, 2, 34, "Input"],
Cell[12672, 511, 1274, 49, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13983, 565, 89, 2, 34, "Input"],
Cell[14075, 569, 668, 25, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14780, 599, 788, 23, 34, "Input"],
Cell[15571, 624, 19061, 442, 991, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34669, 1071, 682, 22, 32, "Input"],
Cell[35354, 1095, 21688, 461, 691, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57079, 1561, 83, 2, 32, "Input"],
Cell[57165, 1565, 9032, 225, 277, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66234, 1795, 682, 22, 32, "Input"],
Cell[66919, 1819, 20463, 453, 645, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87419, 2277, 87, 2, 32, "Input"],
Cell[87509, 2281, 3947, 105, 131, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91493, 2391, 305, 7, 32, "Input"],
Cell[91801, 2400, 5447, 136, 204, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97285, 2541, 304, 7, 32, "Input"],
Cell[97592, 2550, 3859, 106, 156, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101488, 2661, 627, 18, 32, "Input"],
Cell[102118, 2681, 52811, 1130, 1556, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154966, 3816, 167, 3, 51, "Subtitle"],
Cell[CellGroupData[{
Cell[155158, 3823, 389, 10, 32, "Input"],
Cell[155550, 3835, 6683, 183, 234, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162270, 4023, 527, 17, 32, "Input"],
Cell[162800, 4042, 5532, 141, 177, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[168369, 4188, 179, 4, 32, "Input"],
Cell[168551, 4194, 11067, 305, 397, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179655, 4504, 185, 4, 32, "Input"],
Cell[179843, 4510, 9200, 244, 376, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189080, 4759, 527, 17, 32, "Input"],
Cell[189610, 4778, 5642, 153, 174, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195289, 4936, 183, 4, 32, "Input"],
Cell[195475, 4942, 10207, 285, 344, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

