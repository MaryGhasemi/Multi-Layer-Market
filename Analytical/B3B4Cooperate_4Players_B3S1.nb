(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    112684,       3248]
NotebookOptionsPosition[    109310,       3126]
NotebookOutlinePosition[    109647,       3141]
CellTagsIndexPosition[    109604,       3138]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "First step is to define the demands based on the prices and qualities, \
which follows the \[Theta] definition. B1 has the lowest quality in the \
market and B4 has the highest quality. In this part we assum that B1, B2 & B3 \
buy from S1 and   B4 buys from S2. B3 and B4 Cooperate.\nm here is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and x is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "min"], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.733853708657011*^9, 3.733853737576674*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d1", " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p2", "-", "p1"}], 
    RowBox[{"q2", "-", "q1"}]], "-", "m"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "m"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]]}]], "Output",
 CellChangeTimes->{3.681571468626568*^9, 3.681571620806287*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d2", " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p3", "-", "p2"}], 
    RowBox[{"q3", "-", "q2"}]], "-", 
   FractionBox[
    RowBox[{"p2", "-", "p1"}], 
    RowBox[{"q2", "-", "q1"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p1"}], "+", "p2"}], 
    RowBox[{
     RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]]}]], "Output",
 CellChangeTimes->{3.681571475449699*^9, 3.681571624165123*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d3", " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p4", "-", "p3"}], 
    RowBox[{"q4", "-", "q3"}]], "-", 
   FractionBox[
    RowBox[{"p3", "-", "p2"}], 
    RowBox[{"q3", "-", "q2"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p2"}], "+", "p3"}], 
    RowBox[{
     RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p3"}], "+", "p4"}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]]}]], "Output",
 CellChangeTimes->{3.681571481984848*^9, 3.681571627779395*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d4", " ", "=", " ", 
  RowBox[{"x", "-", 
   FractionBox[
    RowBox[{"p4", "-", "p3"}], 
    RowBox[{"q4", "-", "q3"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p3"}], "+", "p4"}], 
    RowBox[{
     RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", "x"}]], "Output",
 CellChangeTimes->{3.6815714879367657`*^9, 3.681571630986803*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]1", " ", "=", " ", 
  RowBox[{
   RowBox[{"d1", "*", "p1"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r1", "*", 
      FractionBox[
       RowBox[{"q1", "*", "d1"}], "Q1"]}], "+", 
     RowBox[{"c", "*", "d1", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q1", "-", "Q1"}], ")"}], "^", "2"}]}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "m"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p1"}], "+", "p2"}], 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q1", "-", "Q1"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "m"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p1"}], "+", "p2"}], 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "m"}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.681571495488035*^9, 3.681571634977281*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]2", " ", "=", " ", 
  RowBox[{
   RowBox[{"d2", "*", "p2"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r1", "*", 
      FractionBox[
       RowBox[{"q2", "*", "d2"}], "Q1"]}], "+", 
     RowBox[{"c", "*", "d2", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q2", "-", "Q1"}], ")"}], "^", "2"}]}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p2"}], "+", "p3"}], 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p2"}], "+", "p3"}], 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p1"}], "+", "p2"}], 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.68157150303055*^9, 3.681571638376171*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]3", " ", "=", " ", 
  RowBox[{
   RowBox[{"d3", "*", "p3"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r1", "*", 
      FractionBox[
       RowBox[{"q3", "*", "d3"}], "Q1"]}], "+", 
     RowBox[{"c", "*", "d3", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q3", "-", "Q1"}], ")"}], "^", "2"}]}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p3"}], "+", "p4"}], 
      RowBox[{
       RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q3"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p3"}], "+", "p4"}], 
      RowBox[{
       RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p2"}], "+", "p3"}], 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p3"}], "+", "p4"}], 
       RowBox[{
        RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.6815715098812313`*^9, 3.681571642191609*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]4", " ", "=", " ", 
  RowBox[{
   RowBox[{"d4", "*", "p4"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r2", "*", 
      FractionBox[
       RowBox[{"q4", "*", "d4"}], "Q2"]}], "+", 
     RowBox[{"c", "*", "d4", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q4", "-", "Q2"}], ")"}], "^", "2"}]}]}], ")"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p3"}], "+", "p4"}], 
       RowBox[{
        RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", "x"}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p3"}], "+", "p4"}], 
       RowBox[{
        RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", "x"}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q4", " ", "r2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p3"}], "+", "p4"}], 
        RowBox[{
         RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", "x"}], ")"}]}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.681571516799515*^9, 3.6815716459344378`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p1"], "\[CapitalPi]1"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "m"}], "-", 
  FractionBox["p1", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{"q1", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.6815715320245667`*^9, 3.681571650227293*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p2"], "\[CapitalPi]2"}]], "Input",
 CellChangeTimes->{{3.681571544367702*^9, 3.6815715464009323`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p1"}], "+", "p2"}], 
    RowBox[{
     RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
  RowBox[{"p2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.681571548675457*^9, 3.681571655208372*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p3"], 
  RowBox[{"(", 
   RowBox[{"\[CapitalPi]3", "+", "\[CapitalPi]4"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.681571564967141*^9, 3.681571567038466*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p2"}], "+", "p3"}], 
    RowBox[{
     RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", 
  FractionBox["p4", 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p3"}], "+", "p4"}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "-", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "+", 
  RowBox[{"p3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q3"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}], " ", "r1"}], "Q1"], "-", 
  FractionBox[
   RowBox[{"q4", " ", "r2"}], 
   RowBox[{"Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.6815715803374043`*^9, 3.6815716606106853`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p4"], 
  RowBox[{"(", 
   RowBox[{"\[CapitalPi]3", "+", "\[CapitalPi]4"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.681571588758773*^9, 3.681571590872806*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["p3", 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "-", 
  FractionBox["p4", 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p3"}], "+", "p4"}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "-", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Q1"}], "+", "q3"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q3"}], "+", "q4"}]], "-", 
  FractionBox[
   RowBox[{"q3", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"q4", " ", "r2"}], 
   RowBox[{"Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]], "+", "x"}]], "Output",
 CellChangeTimes->{3.6815715971448193`*^9, 3.681571664809461*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"%12", "\[Equal]", "0"}], "&&", 
     RowBox[{"%11", "\[Equal]", "0"}], "&&", 
     RowBox[{"%10", "\[Equal]", "0"}], "&&", 
     RowBox[{"%9", "\[Equal]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"%9", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "p1"], "\[CapitalPi]1"}]}], ",", " ", "...",
     ",", " ", 
    RowBox[{"%12", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "p4"], 
      RowBox[{"(", 
       RowBox[{"\[CapitalPi]3", "+", "\[CapitalPi]4"}], ")"}]}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.681571670404004*^9, 3.681571694039529*^9}, {
  3.6815717254994783`*^9, 3.681571731144578*^9}, {3.733853751697184*^9, 
  3.73385376428937*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["2", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "q2"}], "+", "q3"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["2", 
                  RowBox[{
                   RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                FractionBox["2", 
                 RowBox[{
                  RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["4", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}], "2"]]}], "-", 
                FractionBox[
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], 
                 RowBox[{
                  RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}]}], ")"}]}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "m"}], "+", 
            FractionBox[
             RowBox[{"c", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
             RowBox[{
              RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
            FractionBox[
             RowBox[{"q1", " ", "r1"}], 
             RowBox[{"Q1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["4", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}], "2"]]}], "-", 
                FractionBox[
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], 
                 RowBox[{
                  RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "c"}], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                  FractionBox["1", 
                   RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
               FractionBox[
                RowBox[{"q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r1"}], 
                "Q1"]}], ")"}]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    FractionBox[
                    RowBox[{"c", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"]}], 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], "-", 
                   RowBox[{"c", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q1"}], "+", "q3"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
                   FractionBox[
                    RowBox[{"q3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}], " ", "r1"}], 
                    "Q1"], "-", 
                   FractionBox[
                    RowBox[{"q4", " ", "r2"}], 
                    RowBox[{"Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]]}], ")"}]}], 
                RowBox[{
                 RowBox[{"-", "q3"}], "+", "q4"}]]}], "-", 
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"c", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q1"}], "+", "q3"}], ")"}], "2"]}], 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", 
                  FractionBox[
                   RowBox[{"c", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"]}], 
                   RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]], "-", 
                  FractionBox[
                   RowBox[{"q3", " ", "r1"}], 
                   RowBox[{"Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]], "+", 
                  FractionBox[
                   RowBox[{"q4", " ", "r2"}], 
                   RowBox[{"Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]], "+", "x"}], 
                 ")"}]}], 
               RowBox[{
                RowBox[{"-", "q3"}], "+", "q4"}]]}], 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["12", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]], "+", 
         FractionBox["12", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q1"}], "+", "q2"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]]}], ")"}]}]}]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"m", " ", "q1", " ", "Q1"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["q1", "2"], " ", "Q1"}], "-", 
         RowBox[{"2", " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "2"]}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["Q1", "3"]}], "-", 
         RowBox[{"m", " ", "Q1", " ", "q2"}], "+", 
         RowBox[{"q1", " ", "r1"}]}], "Q1"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["2", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                  FractionBox["2", 
                   RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["4", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}], "2"]]}], "-", 
                  FractionBox[
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], 
                   RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}]}], ")"}]}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "m"}], "+", 
              FractionBox[
               RowBox[{"c", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
               RowBox[{
                RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
              FractionBox[
               RowBox[{"q1", " ", "r1"}], 
               RowBox[{"Q1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]]}], ")"}]}], "+", 
           
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox["4", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}], "2"]]}], "-", 
                  FractionBox[
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["2", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], 
                   RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "c"}], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
                 FractionBox[
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r1"}], 
                  "Q1"]}], ")"}]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"c", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"]}], 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], "-", 
                    RowBox[{"c", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q1"}], "+", "q3"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}]}], "-", 
                    FractionBox[
                    RowBox[{"q3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], ")"}], " ", "r1"}], 
                    "Q1"], "-", 
                    FractionBox[
                    RowBox[{"q4", " ", "r2"}], 
                    RowBox[{"Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]]}], ")"}]}], 
                  RowBox[{
                   RowBox[{"-", "q3"}], "+", "q4"}]]}], "-", 
                FractionBox[
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"c", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q1"}], "+", "q3"}], ")"}], "2"]}], 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]]}], "+", 
                    FractionBox[
                    RowBox[{"c", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"]}], 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}]], "-", 
                    FractionBox[
                    RowBox[{"q3", " ", "r1"}], 
                    RowBox[{"Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]], "+", 
                    FractionBox[
                    RowBox[{"q4", " ", "r2"}], 
                    RowBox[{"Q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]], "+", "x"}], 
                   ")"}]}], 
                 RowBox[{
                  RowBox[{"-", "q3"}], "+", "q4"}]]}], 
               RowBox[{
                RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}]}], ")"}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["12", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]], "+", 
         FractionBox["12", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q1"}], "+", "q2"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}]]}], ")"}]}]}]}], ",", 
    RowBox[{"p3", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"6", " ", "Q1", " ", 
         RowBox[{"(", 
          RowBox[{"q1", "-", "q3"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "6"}], " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "3"]}], "-", 
         RowBox[{"m", " ", "q1", " ", "Q1", " ", "q2"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["q1", "2"], " ", "Q1", " ", "q2"}], "+", 
         RowBox[{"6", " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2"}], "+", 
         RowBox[{"m", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"]}], "-", 
         RowBox[{"2", " ", "c", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"]}], "+", 
         RowBox[{"m", " ", "q1", " ", "Q1", " ", "q3"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["q1", "2"], " ", "Q1", " ", "q3"}], "+", 
         RowBox[{"6", " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "2"], " ", "q3"}], "+", 
         RowBox[{"6", " ", "c", " ", 
          SuperscriptBox["Q1", "3"], " ", "q3"}], "-", 
         RowBox[{"m", " ", "Q1", " ", "q2", " ", "q3"}], "-", 
         RowBox[{"6", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "q3"}], "+", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "q3"}], "-", 
         RowBox[{"4", " ", "c", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"6", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"3", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["q3", "3"]}], "-", 
         RowBox[{"3", " ", "q1", " ", "q2", " ", "r1"}], "-", 
         RowBox[{"3", " ", "q1", " ", "q3", " ", "r1"}], "+", 
         RowBox[{"3", " ", "q2", " ", "q3", " ", "r1"}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["q3", "2"], " ", "r1"}], "+", 
         RowBox[{"4", " ", "q1", " ", "Q1", " ", "q2", " ", "x"}], "-", 
         RowBox[{"Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "x"}], "-", 
         RowBox[{"4", " ", "q1", " ", "Q1", " ", "q3", " ", "x"}], "-", 
         RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "x"}], "+", 
         RowBox[{"3", " ", "Q1", " ", 
          SuperscriptBox["q3", "2"], " ", "x"}]}], ")"}]}]}]}], ",", 
    RowBox[{"p4", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q1", "-", "q3"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "3"], " ", "Q2"}], "-", 
         RowBox[{"m", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["q1", "2"], " ", "Q1", " ", "q2", " ", "Q2"}], "+", 
         RowBox[{"6", " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2"}], "+", 
         RowBox[{"m", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
         RowBox[{"2", " ", "c", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
         RowBox[{"3", " ", "c", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["Q2", "3"]}], "+", 
         RowBox[{"m", " ", "q1", " ", "Q1", " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["q1", "2"], " ", "Q1", " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"3", " ", "c", " ", 
          SuperscriptBox["Q1", "3"], " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"m", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"6", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "q3"}], "+", 
         RowBox[{"3", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "3"], " ", "q3"}], "-", 
         RowBox[{"c", " ", "q1", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"c", " ", "Q1", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"6", " ", "c", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["Q2", "2"], " ", "q4"}], "-", 
         RowBox[{"6", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3", " ", "q4"}], "-", 
         RowBox[{"3", " ", "c", " ", "q1", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q4", "2"]}], "+", 
         RowBox[{"3", " ", "c", " ", "Q1", " ", "Q2", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
         RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
         RowBox[{"3", " ", "q1", " ", "Q1", " ", "q4", " ", "r2"}], "+", 
         RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "+", 
         RowBox[{"4", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", "x"}], 
         "-", 
         RowBox[{"Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "x"}], "-", 
         RowBox[{"q1", " ", "Q1", " ", "Q2", " ", "q3", " ", "x"}], "-", 
         RowBox[{"2", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], 
         "-", 
         RowBox[{"3", " ", "q1", " ", "Q1", " ", "Q2", " ", "q4", " ", "x"}], 
         "+", 
         RowBox[{
         "3", " ", "Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
        ")"}]}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.681571735401061*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U1", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d1", "*", 
         RowBox[{"q1", "/", "Q1"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"d2", "*", 
         RowBox[{"q2", "/", "Q1"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"d3", "*", 
         RowBox[{"q3", "/", "Q1"}]}], ")"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"r1", "-", "k1"}], ")"}]}], "-", 
    RowBox[{"e", "*", 
     RowBox[{"Q1", "^", "2"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "\[Rule]", "%15"}], ",", 
     RowBox[{"p2", "\[Rule]", "%17"}], ",", 
     RowBox[{"p3", "\[Rule]", "%19"}], ",", 
     RowBox[{"p4", "\[Rule]", "%21"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.681572694135771*^9, 3.681572697767394*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "e"}], " ", 
   SuperscriptBox["Q1", "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "k1"}], "+", "r1"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "Q1"], 
      RowBox[{"q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "m"}], "+", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"6", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q3"}], ")"}]}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "q2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", " ", "q1"}], "+", "q2", "-", 
                   RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "q3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"c", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["q1", "2"]}], "+", 
                    RowBox[{"6", " ", 
                    SuperscriptBox["Q1", "2"]}], "-", 
                    RowBox[{"6", " ", "Q1", " ", "q2"}], "+", 
                    RowBox[{"q1", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], " ", "Q1"}], "+", "q2", "-", "q3"}], 
                    ")"}]}], "+", 
                    RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}],
                    "+", 
                   RowBox[{"3", " ", 
                    RowBox[{"(", 
                    RowBox[{"q1", "+", "q2"}], ")"}], " ", "r1"}]}], ")"}]}], 
                "-", 
                RowBox[{"Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "q2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}], " ", "x"}]}], ")"}]}]}], 
            "+", 
            FractionBox[
             RowBox[{
              RowBox[{"m", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q2"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
              RowBox[{"c", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", 
                  SuperscriptBox["Q1", "2"]}], "-", 
                 RowBox[{"6", " ", "Q1", " ", "q2"}], "+", 
                 RowBox[{"q1", " ", 
                  RowBox[{"(", 
                   RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
                 RowBox[{"q2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}],
               "+", 
              RowBox[{"3", " ", "q2", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q3"}], ")"}], " ", "r1"}], "+", 
              RowBox[{"Q1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", "x"}]}], 
             RowBox[{"3", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "q3"}], ")"}]}]]}], ")"}]}]}], ")"}]}]}], 
     "+", 
     RowBox[{
      FractionBox["1", "Q1"], 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{
               FractionBox["1", 
                RowBox[{"6", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "q3"}], ")"}]}]], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"m", " ", "Q1", " ", 
                  RowBox[{"(", 
                   RowBox[{"q1", "-", "q2"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"3", " ", "q1"}], "+", "q2", "-", 
                    RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"q1", "-", "q3"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"c", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["q1", "2"]}], "+", 
                    RowBox[{"6", " ", 
                    SuperscriptBox["Q1", "2"]}], "-", 
                    RowBox[{"6", " ", "Q1", " ", "q2"}], "+", 
                    RowBox[{"q1", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], " ", "Q1"}], "+", "q2", "-", "q3"}], 
                    ")"}]}], "+", 
                    RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}],
                     "+", 
                    RowBox[{"3", " ", 
                    RowBox[{"(", 
                    RowBox[{"q1", "+", "q2"}], ")"}], " ", "r1"}]}], ")"}]}], 
                 "-", 
                 RowBox[{"Q1", " ", 
                  RowBox[{"(", 
                   RowBox[{"q1", "-", "q2"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"q2", "-", "q3"}], ")"}], " ", "x"}]}], ")"}]}]}], 
             "+", 
             FractionBox[
              RowBox[{
               RowBox[{"m", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   SuperscriptBox["Q1", "2"]}], "-", 
                  RowBox[{"6", " ", "Q1", " ", "q2"}], "+", 
                  RowBox[{"q1", " ", 
                   RowBox[{"(", 
                    RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"3", " ", "q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q3"}], ")"}], " ", "r1"}], "+", 
               RowBox[{"Q1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", "x"}]}], 
              RowBox[{"3", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q3"}], ")"}]}]]}], ")"}]}]}], "+", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               RowBox[{"m", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   SuperscriptBox["Q1", "2"]}], "-", 
                  RowBox[{"6", " ", "Q1", " ", "q2"}], "+", 
                  RowBox[{"q1", " ", 
                   RowBox[{"(", 
                    RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"3", " ", "q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q3"}], ")"}], " ", "r1"}], "+", 
               RowBox[{"Q1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}], " ", "x"}]}], 
              RowBox[{"3", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q3"}], ")"}]}]]}], "+", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"6", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q3"}], ")"}]}], ")"}]}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["q1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q2", "-", "q3"}], ")"}]}], "-", 
                  RowBox[{"q3", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"6", " ", 
                    SuperscriptBox["Q1", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q2", "2"]}], "+", 
                    RowBox[{"q2", " ", "q3"}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["q3", "2"]}], "-", 
                    RowBox[{"6", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "+", "q3"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "q1", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q1", "2"]}], "+", 
                    SuperscriptBox["q2", "2"], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "-", 
                    RowBox[{"3", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "+", "q3"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
               "+", 
               RowBox[{"3", " ", "q1", " ", "q2", " ", "r1"}], "+", 
               RowBox[{"3", " ", "q1", " ", "q3", " ", "r1"}], "-", 
               RowBox[{"3", " ", "q2", " ", "q3", " ", "r1"}], "-", 
               RowBox[{"3", " ", 
                SuperscriptBox["q3", "2"], " ", "r1"}], "-", 
               RowBox[{"4", " ", "q1", " ", "Q1", " ", "q2", " ", "x"}], "+", 
               
               RowBox[{"Q1", " ", 
                SuperscriptBox["q2", "2"], " ", "x"}], "+", 
               RowBox[{"4", " ", "q1", " ", "Q1", " ", "q3", " ", "x"}], "+", 
               
               RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "x"}], "-", 
               
               RowBox[{"3", " ", "Q1", " ", 
                SuperscriptBox["q3", "2"], " ", "x"}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], "+", 
     RowBox[{
      FractionBox["1", "Q1"], 
      RowBox[{"q3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{
                RowBox[{"m", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "q2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
                RowBox[{"c", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "q3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", " ", 
                    SuperscriptBox["Q1", "2"]}], "-", 
                   RowBox[{"6", " ", "Q1", " ", "q2"}], "+", 
                   RowBox[{"q1", " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
                   RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q2"}], "+", "q3"}], ")"}]}]}], ")"}]}],
                 "+", 
                RowBox[{"3", " ", "q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "q3"}], ")"}], " ", "r1"}], "+", 
                RowBox[{"Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}], " ", "x"}]}], 
               RowBox[{"3", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q3"}], ")"}]}]]}], "+", 
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"6", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "q3"}], ")"}]}], ")"}]}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "q2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
                RowBox[{"c", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["q1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "-", "q3"}], ")"}]}], "-", 
                   RowBox[{"q3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"6", " ", 
                    SuperscriptBox["Q1", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q2", "2"]}], "+", 
                    RowBox[{"q2", " ", "q3"}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["q3", "2"]}], "-", 
                    RowBox[{"6", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "+", "q3"}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{"2", " ", "q1", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q1", "2"]}], "+", 
                    SuperscriptBox["q2", "2"], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "-", 
                    RowBox[{"3", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "+", "q3"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
                "+", 
                RowBox[{"3", " ", "q1", " ", "q2", " ", "r1"}], "+", 
                RowBox[{"3", " ", "q1", " ", "q3", " ", "r1"}], "-", 
                RowBox[{"3", " ", "q2", " ", "q3", " ", "r1"}], "-", 
                RowBox[{"3", " ", 
                 SuperscriptBox["q3", "2"], " ", "r1"}], "-", 
                RowBox[{"4", " ", "q1", " ", "Q1", " ", "q2", " ", "x"}], "+", 
                RowBox[{"Q1", " ", 
                 SuperscriptBox["q2", "2"], " ", "x"}], "+", 
                RowBox[{"4", " ", "q1", " ", "Q1", " ", "q3", " ", "x"}], "+", 
                RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "x"}], "-", 
                RowBox[{"3", " ", "Q1", " ", 
                 SuperscriptBox["q3", "2"], " ", "x"}]}], ")"}]}]}], 
            ")"}]}]}], "+", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"6", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "q3"}], ")"}]}], ")"}]}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "q2"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
                RowBox[{"c", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["q1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "-", "q3"}], ")"}]}], "-", 
                   RowBox[{"q3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"6", " ", 
                    SuperscriptBox["Q1", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q2", "2"]}], "+", 
                    RowBox[{"q2", " ", "q3"}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["q3", "2"]}], "-", 
                    RowBox[{"6", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "+", "q3"}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{"2", " ", "q1", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q1", "2"]}], "+", 
                    SuperscriptBox["q2", "2"], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "-", 
                    RowBox[{"3", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "+", "q3"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
                "+", 
                RowBox[{"3", " ", "q1", " ", "q2", " ", "r1"}], "+", 
                RowBox[{"3", " ", "q1", " ", "q3", " ", "r1"}], "-", 
                RowBox[{"3", " ", "q2", " ", "q3", " ", "r1"}], "-", 
                RowBox[{"3", " ", 
                 SuperscriptBox["q3", "2"], " ", "r1"}], "-", 
                RowBox[{"4", " ", "q1", " ", "Q1", " ", "q2", " ", "x"}], "+", 
                RowBox[{"Q1", " ", 
                 SuperscriptBox["q2", "2"], " ", "x"}], "+", 
                RowBox[{"4", " ", "q1", " ", "Q1", " ", "q3", " ", "x"}], "+", 
                RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "x"}], "-", 
                RowBox[{"3", " ", "Q1", " ", 
                 SuperscriptBox["q3", "2"], " ", "x"}]}], ")"}]}]}], "+", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q3"}], ")"}]}], ")"}]}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", "Q1", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["q1", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"q2", "-", "q3"}], ")"}]}], "-", 
                  RowBox[{"q3", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q1", "2"]}], "-", 
                    RowBox[{"6", " ", "Q1", " ", "q2"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q2", "2"]}], "+", 
                    RowBox[{"q2", " ", "q3"}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"Q2", "-", "q4"}], ")"}], "2"]}]}], ")"}]}], "+", 
                  
                  RowBox[{"q1", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q1", "2"]}], "-", 
                    RowBox[{"6", " ", "Q1", " ", "q2"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["q2", "2"]}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}], "+", 
                    SuperscriptBox["q3", "2"], "-", 
                    RowBox[{"6", " ", "Q2", " ", "q4"}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["q4", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "-", 
               RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "r1"}], "+", 
               RowBox[{"3", " ", "q1", " ", "Q1", " ", "q4", " ", "r2"}], "-", 
               RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "-", 
               RowBox[{
               "4", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", "x"}], 
               "+", 
               RowBox[{"Q1", " ", 
                SuperscriptBox["q2", "2"], " ", "Q2", " ", "x"}], "+", 
               RowBox[{"q1", " ", "Q1", " ", "Q2", " ", "q3", " ", "x"}], "+", 
               RowBox[{
               "2", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], 
               "+", 
               RowBox[{
               "3", " ", "q1", " ", "Q1", " ", "Q2", " ", "q4", " ", "x"}], 
               "-", 
               RowBox[{
               "3", " ", "Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
              ")"}]}]}], ")"}]}]}], ")"}]}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.681572709350101*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", "%22", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"%22", " ", ":", " ", "U1"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7338537759700403`*^9, 3.733853784058074*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{"q3", "-", "q4"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "e", " ", 
     SuperscriptBox["Q1", "4"], " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}], "+", 
    RowBox[{"r1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "m"}], " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "+", "q2"}], ")"}], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
       RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"q1", "-", "Q1"}], ")"}], "2"], "-", 
             SuperscriptBox["Q2", "2"]}], ")"}], " ", "q3"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["q1", "2"]}], "+", 
             RowBox[{"2", " ", "q1", " ", "Q1"}], "+", 
             RowBox[{"q3", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "Q1"}], "+", 
                RowBox[{"2", " ", "Q2"}], "+", "q3"}], ")"}]}]}], ")"}], " ", 
           "q4"}], "-", 
          RowBox[{"q3", " ", 
           SuperscriptBox["q4", "2"]}]}], ")"}]}], "+", 
       RowBox[{"q1", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
       RowBox[{"q1", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
       RowBox[{"Q2", " ", "q3", " ", "q4", " ", "r1"}], "-", 
       RowBox[{"Q1", " ", "q3", " ", "q4", " ", "r2"}], "+", 
       RowBox[{"Q1", " ", "q2", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}], " ", "x"}]}], ")"}]}], "+", 
    RowBox[{"k1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "+", "q2"}], ")"}], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
       RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}], "+", 
          RowBox[{"q3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["Q1", "2"]}], "+", 
             SuperscriptBox["Q2", "2"], "+", 
             RowBox[{"2", " ", "Q1", " ", "q4"}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "Q2"}], "+", "q3"}], ")"}], " ", "q4"}], 
             "+", 
             SuperscriptBox["q4", "2"]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"q1", " ", "Q2", " ", "q3", " ", "r1"}], "+", 
       RowBox[{"q1", " ", "Q2", " ", "q4", " ", "r1"}], "-", 
       RowBox[{"Q2", " ", "q3", " ", "q4", " ", "r1"}], "+", 
       RowBox[{"Q1", " ", "q3", " ", "q4", " ", "r2"}], "+", 
       RowBox[{"Q1", " ", "q2", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q3"}], "+", "q4"}], ")"}], " ", "x"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.681572715593154*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U2", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"(", 
       RowBox[{"d4", "*", 
        RowBox[{"q4", "/", "Q2"}]}], ")"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"r2", "-", "k2"}], ")"}]}], "-", 
    RowBox[{"e", "*", 
     RowBox[{"Q2", "^", "2"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "\[Rule]", "%15"}], ",", 
     RowBox[{"p2", "\[Rule]", "%17"}], ",", 
     RowBox[{"p3", "\[Rule]", "%19"}], ",", 
     RowBox[{"p4", "\[Rule]", "%21"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.681572740506115*^9, 3.681572743226919*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "e"}], " ", 
   SuperscriptBox["Q2", "2"]}], "+", 
  RowBox[{
   FractionBox["1", "Q2"], 
   RowBox[{"q4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "k2"}], "+", "r2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"x", "-", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"6", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "q3"}], ")"}]}], ")"}]}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"m", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "q2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
             RowBox[{"c", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["q1", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}]}], "-", 
                RowBox[{"q3", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"6", " ", 
                    SuperscriptBox["Q1", "2"]}], "+", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["q2", "2"]}], "+", 
                   RowBox[{"q2", " ", "q3"}], "+", 
                   RowBox[{"3", " ", 
                    SuperscriptBox["q3", "2"]}], "-", 
                   RowBox[{"6", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "+", "q3"}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"2", " ", "q1", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", " ", 
                    SuperscriptBox["Q1", "2"]}], "+", 
                   SuperscriptBox["q2", "2"], "+", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["q3", "2"]}], "-", 
                   RowBox[{"3", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "+", "q3"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
             "+", 
             RowBox[{"3", " ", "q1", " ", "q2", " ", "r1"}], "+", 
             RowBox[{"3", " ", "q1", " ", "q3", " ", "r1"}], "-", 
             RowBox[{"3", " ", "q2", " ", "q3", " ", "r1"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["q3", "2"], " ", "r1"}], "-", 
             RowBox[{"4", " ", "q1", " ", "Q1", " ", "q2", " ", "x"}], "+", 
             RowBox[{"Q1", " ", 
              SuperscriptBox["q2", "2"], " ", "x"}], "+", 
             RowBox[{"4", " ", "q1", " ", "Q1", " ", "q3", " ", "x"}], "+", 
             RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "x"}], "-", 
             RowBox[{"3", " ", "Q1", " ", 
              SuperscriptBox["q3", "2"], " ", "x"}]}], ")"}]}]}], "+", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"6", " ", "Q1", " ", "Q2", " ", 
             RowBox[{"(", 
              RowBox[{"q1", "-", "q3"}], ")"}]}], ")"}]}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", " ", "Q1", " ", 
             RowBox[{"(", 
              RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", 
             RowBox[{"(", 
              RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
            RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "-", "q3"}], ")"}]}], "-", 
               RowBox[{"q3", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   SuperscriptBox["Q1", "2"]}], "-", 
                  RowBox[{"6", " ", "Q1", " ", "q2"}], "+", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["q2", "2"]}], "+", 
                  RowBox[{"q2", " ", "q3"}], "+", 
                  RowBox[{"3", " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"Q2", "-", "q4"}], ")"}], "2"]}]}], ")"}]}], "+", 
               
               RowBox[{"q1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   SuperscriptBox["Q1", "2"]}], "-", 
                  RowBox[{"6", " ", "Q1", " ", "q2"}], "+", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["q2", "2"]}], "+", 
                  RowBox[{"3", " ", 
                   SuperscriptBox["Q2", "2"]}], "+", 
                  SuperscriptBox["q3", "2"], "-", 
                  RowBox[{"6", " ", "Q2", " ", "q4"}], "+", 
                  RowBox[{"3", " ", 
                   SuperscriptBox["q4", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "-", 
            RowBox[{"3", " ", "q2", " ", "Q2", " ", "q3", " ", "r1"}], "+", 
            RowBox[{"3", " ", "q1", " ", "Q1", " ", "q4", " ", "r2"}], "-", 
            RowBox[{"3", " ", "Q1", " ", "q3", " ", "q4", " ", "r2"}], "-", 
            RowBox[{
            "4", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", "x"}], "+", 
            
            RowBox[{"Q1", " ", 
             SuperscriptBox["q2", "2"], " ", "Q2", " ", "x"}], "+", 
            RowBox[{"q1", " ", "Q1", " ", "Q2", " ", "q3", " ", "x"}], "+", 
            RowBox[{
            "2", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
            
            RowBox[{
            "3", " ", "q1", " ", "Q1", " ", "Q2", " ", "q4", " ", "x"}], "-", 
            
            RowBox[{
            "3", " ", "Q1", " ", "Q2", " ", "q3", " ", "q4", " ", "x"}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.681572754310973*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", "%24", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"%24", " ", ":", " ", "U2"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.73385378746627*^9, 3.733853795346367*^9}},
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", "e", " ", "Q1", " ", 
    SuperscriptBox["Q2", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}], "+", 
   RowBox[{"q4", " ", 
    RowBox[{"(", 
     RowBox[{"k2", "-", "r2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q1", "2"], "-", 
         SuperscriptBox["Q2", "2"], "-", 
         RowBox[{"2", " ", "Q1", " ", "q3"}], "+", 
         SuperscriptBox["q3", "2"], "+", 
         RowBox[{"2", " ", "Q2", " ", "q4"}], "-", 
         SuperscriptBox["q4", "2"]}], ")"}]}], "-", 
      RowBox[{"Q1", " ", "q4", " ", "r2"}], "+", 
      RowBox[{"Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q3", " ", "r1"}], "-", 
         RowBox[{"Q1", " ", "q3", " ", "x"}], "+", 
         RowBox[{"Q1", " ", "q4", " ", "x"}]}], ")"}]}]}], ")"}]}]}], 
  RowBox[{"2", " ", "Q1", " ", 
   SuperscriptBox["Q2", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"q3", "-", "q4"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.681572757330386*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "r1"], "%23", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"%23", " ", ":", " ", 
    RowBox[{"Simplify", "[", "U1", "]"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.681572761414082*^9, 3.6815727710400953`*^9}, {
  3.7338538412036247`*^9, 3.7338538428360643`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{"q3", "-", "q4"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "m"}], " ", "Q1", " ", 
     RowBox[{"(", 
      RowBox[{"q1", "+", "q2"}], ")"}], " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
    RowBox[{"k1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "q1"}], " ", "Q2", " ", "q3"}], "+", 
       RowBox[{"q1", " ", "Q2", " ", "q4"}], "-", 
       RowBox[{"Q2", " ", "q3", " ", "q4"}]}], ")"}]}], "+", 
    RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"q1", "-", "Q1"}], ")"}], "2"], "-", 
          SuperscriptBox["Q2", "2"]}], ")"}], " ", "q3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["q1", "2"]}], "+", 
          RowBox[{"2", " ", "q1", " ", "Q1"}], "+", 
          RowBox[{"q3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "Q1"}], "+", 
             RowBox[{"2", " ", "Q2"}], "+", "q3"}], ")"}]}]}], ")"}], " ", 
        "q4"}], "-", 
       RowBox[{"q3", " ", 
        SuperscriptBox["q4", "2"]}]}], ")"}]}], "+", 
    RowBox[{"q1", " ", "Q2", " ", "q3", " ", "r1"}], "-", 
    RowBox[{"q1", " ", "Q2", " ", "q4", " ", "r1"}], "+", 
    RowBox[{"Q2", " ", "q3", " ", "q4", " ", "r1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q1", " ", "Q2", " ", "q3"}], "-", 
       RowBox[{"q1", " ", "Q2", " ", "q4"}], "+", 
       RowBox[{"Q2", " ", "q3", " ", "q4"}]}], ")"}], " ", "r1"}], "-", 
    RowBox[{"Q1", " ", "q3", " ", "q4", " ", "r2"}], "+", 
    RowBox[{"Q1", " ", "q2", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q3", "-", "q4"}], ")"}], " ", "x"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.68157277248104*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "r2"], "%25", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"%25", " ", ":", " ", 
    RowBox[{"Simplify", "[", "U2", "]"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.681572774824202*^9, 3.681572782518524*^9}, {
  3.7338538454518547`*^9, 3.73385385374794*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "Q1"}], " ", 
    SuperscriptBox["q4", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"k2", "-", "r2"}], ")"}]}], "-", 
   RowBox[{"q4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q1", "2"], "-", 
         SuperscriptBox["Q2", "2"], "-", 
         RowBox[{"2", " ", "Q1", " ", "q3"}], "+", 
         SuperscriptBox["q3", "2"], "+", 
         RowBox[{"2", " ", "Q2", " ", "q4"}], "-", 
         SuperscriptBox["q4", "2"]}], ")"}]}], "-", 
      RowBox[{"Q1", " ", "q4", " ", "r2"}], "+", 
      RowBox[{"Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q3", " ", "r1"}], "-", 
         RowBox[{"Q1", " ", "q3", " ", "x"}], "+", 
         RowBox[{"Q1", " ", "q4", " ", "x"}]}], ")"}]}]}], ")"}]}]}], 
  RowBox[{"2", " ", "Q1", " ", 
   SuperscriptBox["Q2", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"q3", "-", "q4"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.681572790335997*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"%26", "\[Equal]", "0"}], "&&", 
     RowBox[{"%27", "\[Equal]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r1", ",", "r2"}], "}"}]}], "]"}], "  ", 
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{"%26", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "r1"], "U1"}]}], ",", " ", 
    RowBox[{"%27", " ", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "r2"], "U2"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6815728445486183`*^9, 3.681572862327755*^9}, {
  3.733853866100561*^9, 3.733853866573805*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"r1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox["q4", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "+", "q2"}], ")"}]}], 
               RowBox[{"2", " ", "Q1"}]]}], "+", 
             FractionBox[
              RowBox[{"k1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "q1"}], " ", "Q2", " ", "q3"}], "+", 
                 RowBox[{"q1", " ", "Q2", " ", "q4"}], "-", 
                 RowBox[{"Q2", " ", "q3", " ", "q4"}]}], ")"}]}], 
              RowBox[{"2", " ", 
               SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q3", "-", "q4"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"c", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"q1", "-", "Q1"}], ")"}], "2"], "-", 
                    SuperscriptBox["Q2", "2"]}], ")"}], " ", "q3"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    SuperscriptBox["q1", "2"]}], "+", 
                    RowBox[{"2", " ", "q1", " ", "Q1"}], "+", 
                    RowBox[{"q3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "Q1"}], "+", 
                    RowBox[{"2", " ", "Q2"}], "+", "q3"}], ")"}]}]}], ")"}], 
                  " ", "q4"}], "-", 
                 RowBox[{"q3", " ", 
                  SuperscriptBox["q4", "2"]}]}], ")"}]}], 
              RowBox[{"2", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q3", "-", "q4"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"q2", " ", "x"}], 
              RowBox[{"2", " ", "Q1"}]]}], ")"}]}], 
          RowBox[{
           SuperscriptBox["Q2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"q3", "-", "q4"}], ")"}]}]], "+", 
         FractionBox[
          RowBox[{"q3", " ", "q4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"k2", " ", 
                SuperscriptBox["q4", "2"]}], 
               RowBox[{"2", " ", 
                SuperscriptBox["Q2", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"q3", "-", "q4"}], ")"}]}]]}], "-", 
             FractionBox[
              RowBox[{"c", " ", "q4", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Q1", "2"], "-", 
                 SuperscriptBox["Q2", "2"], "-", 
                 RowBox[{"2", " ", "Q1", " ", "q3"}], "+", 
                 SuperscriptBox["q3", "2"], "+", 
                 RowBox[{"2", " ", "Q2", " ", "q4"}], "-", 
                 SuperscriptBox["q4", "2"]}], ")"}]}], 
              RowBox[{"2", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q3", "-", "q4"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"q3", " ", "q4", " ", "x"}], 
              RowBox[{"2", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q3", "-", "q4"}], ")"}]}]], "-", 
             FractionBox[
              RowBox[{
               SuperscriptBox["q4", "2"], " ", "x"}], 
              RowBox[{"2", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q3", "-", "q4"}], ")"}]}]]}], ")"}]}], 
          RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
           RowBox[{"(", 
            RowBox[{"q3", "-", "q4"}], ")"}]}]]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"q1", " ", "q3", " ", 
           SuperscriptBox["q4", "2"]}], 
          RowBox[{
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}], "2"]}]], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["q3", "2"], " ", 
           SuperscriptBox["q4", "2"]}], 
          RowBox[{"4", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}], "2"]}]], "-", 
         FractionBox[
          RowBox[{"q1", " ", 
           SuperscriptBox["q4", "3"]}], 
          RowBox[{
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}], "2"]}]], "+", 
         FractionBox[
          RowBox[{"q3", " ", 
           SuperscriptBox["q4", "3"]}], 
          RowBox[{
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox["Q2", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}], "2"]}]]}], ")"}]}]}]}], ",", 
    RowBox[{"r2", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", 
          SuperscriptBox["Q1", "2"], " ", "Q2"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["Q2", "3"]}], "+", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"c", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "-", 
         RowBox[{"k2", " ", "q4"}], "-", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q2", "2"], " ", "q4"}], "+", 
         RowBox[{"c", " ", "Q2", " ", 
          SuperscriptBox["q4", "2"]}], "+", 
         RowBox[{"Q2", " ", "q3", " ", "x"}], "-", 
         RowBox[{"Q2", " ", "q4", " ", "x"}]}], 
        RowBox[{"2", " ", "q4"}]]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Q2", " ", "q3", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox["q4", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"m", " ", 
                  RowBox[{"(", 
                   RowBox[{"q1", "+", "q2"}], ")"}]}], 
                 RowBox[{"2", " ", "Q1"}]]}], "+", 
               FractionBox[
                RowBox[{"k1", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "q1"}], " ", "Q2", " ", "q3"}], "+", 
                   RowBox[{"q1", " ", "Q2", " ", "q4"}], "-", 
                   RowBox[{"Q2", " ", "q3", " ", "q4"}]}], ")"}]}], 
                RowBox[{"2", " ", 
                 SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q3", "-", "q4"}], ")"}]}]], "+", 
               FractionBox[
                RowBox[{"c", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"q1", "-", "Q1"}], ")"}], "2"], "-", 
                    SuperscriptBox["Q2", "2"]}], ")"}], " ", "q3"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    SuperscriptBox["q1", "2"]}], "+", 
                    RowBox[{"2", " ", "q1", " ", "Q1"}], "+", 
                    RowBox[{"q3", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "Q1"}], "+", 
                    RowBox[{"2", " ", "Q2"}], "+", "q3"}], ")"}]}]}], ")"}], 
                    " ", "q4"}], "-", 
                   RowBox[{"q3", " ", 
                    SuperscriptBox["q4", "2"]}]}], ")"}]}], 
                RowBox[{"2", " ", "Q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"q3", "-", "q4"}], ")"}]}]], "+", 
               FractionBox[
                RowBox[{"q2", " ", "x"}], 
                RowBox[{"2", " ", "Q1"}]]}], ")"}]}], 
            RowBox[{
             SuperscriptBox["Q2", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"q3", "-", "q4"}], ")"}]}]], "+", 
           FractionBox[
            RowBox[{"q3", " ", "q4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"k2", " ", 
                  SuperscriptBox["q4", "2"]}], 
                 RowBox[{"2", " ", 
                  SuperscriptBox["Q2", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"q3", "-", "q4"}], ")"}]}]]}], "-", 
               FractionBox[
                RowBox[{"c", " ", "q4", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q1", "2"], "-", 
                   SuperscriptBox["Q2", "2"], "-", 
                   RowBox[{"2", " ", "Q1", " ", "q3"}], "+", 
                   SuperscriptBox["q3", "2"], "+", 
                   RowBox[{"2", " ", "Q2", " ", "q4"}], "-", 
                   SuperscriptBox["q4", "2"]}], ")"}]}], 
                RowBox[{"2", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q3", "-", "q4"}], ")"}]}]], "+", 
               FractionBox[
                RowBox[{"q3", " ", "q4", " ", "x"}], 
                RowBox[{"2", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q3", "-", "q4"}], ")"}]}]], "-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox["q4", "2"], " ", "x"}], 
                RowBox[{"2", " ", "Q2", " ", 
                 RowBox[{"(", 
                  RowBox[{"q3", "-", "q4"}], ")"}]}]]}], ")"}]}], 
            RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
             RowBox[{"(", 
              RowBox[{"q3", "-", "q4"}], ")"}]}]]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", "Q1", " ", "q4", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"q1", " ", "q3", " ", 
             SuperscriptBox["q4", "2"]}], 
            RowBox[{
             SuperscriptBox["Q1", "2"], " ", 
             SuperscriptBox["Q2", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"q3", "-", "q4"}], ")"}], "2"]}]], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["q3", "2"], " ", 
             SuperscriptBox["q4", "2"]}], 
            RowBox[{"4", " ", 
             SuperscriptBox["Q1", "2"], " ", 
             SuperscriptBox["Q2", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"q3", "-", "q4"}], ")"}], "2"]}]], "-", 
           FractionBox[
            RowBox[{"q1", " ", 
             SuperscriptBox["q4", "3"]}], 
            RowBox[{
             SuperscriptBox["Q1", "2"], " ", 
             SuperscriptBox["Q2", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"q3", "-", "q4"}], ")"}], "2"]}]], "+", 
           FractionBox[
            RowBox[{"q3", " ", 
             SuperscriptBox["q4", "3"]}], 
            RowBox[{
             SuperscriptBox["Q1", "2"], " ", 
             SuperscriptBox["Q2", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"q3", "-", "q4"}], ")"}], "2"]}]]}], ")"}]}], 
        ")"}]}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6815728912293262`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%27", "\[Equal]", "0"}], ",", "r2"}], "]"}]], "Input",
 CellChangeTimes->{{3.681573094940167*^9, 3.6815731034455023`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"c", " ", 
       SuperscriptBox["Q1", "3"], " ", "Q2"}], "-", 
      RowBox[{"c", " ", "Q1", " ", 
       SuperscriptBox["Q2", "3"]}], "-", 
      RowBox[{"2", " ", "c", " ", 
       SuperscriptBox["Q1", "2"], " ", "Q2", " ", "q3"}], "+", 
      RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
       SuperscriptBox["q3", "2"]}], "+", 
      RowBox[{"k2", " ", "Q1", " ", "q4"}], "+", 
      RowBox[{"2", " ", "c", " ", "Q1", " ", 
       SuperscriptBox["Q2", "2"], " ", "q4"}], "-", 
      RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
       SuperscriptBox["q4", "2"]}], "+", 
      RowBox[{"Q2", " ", "q3", " ", "r1"}], "-", 
      RowBox[{"Q1", " ", "Q2", " ", "q3", " ", "x"}], "+", 
      RowBox[{"Q1", " ", "Q2", " ", "q4", " ", "x"}]}], 
     RowBox[{"2", " ", "Q1", " ", "q4"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.681573121800506*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q3", "*", 
    RowBox[{"r1", "/", "Q1"}]}], "+", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q3", "-", "Q1"}], ")"}], "^", "2"}]}], "-", 
   RowBox[{"q3", "*", 
    RowBox[{"r2", "/", "Q2"}]}], "-", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q3", "-", "Q2"}], ")"}], "^", "2"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", "%35"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.681573155872161*^9, 3.681573198098441*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q3"}], ")"}], "2"]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q3", " ", "r1"}], "Q1"], "-", 
  FractionBox[
   RowBox[{"q3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k2", " ", "Q1", " ", "q4"}], "+", 
      RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q1", "2"], "-", 
         SuperscriptBox["Q2", "2"], "-", 
         RowBox[{"2", " ", "Q1", " ", "q3"}], "+", 
         SuperscriptBox["q3", "2"], "+", 
         RowBox[{"2", " ", "Q2", " ", "q4"}], "-", 
         SuperscriptBox["q4", "2"]}], ")"}]}], "+", 
      RowBox[{"Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q3", " ", "r1"}], "-", 
         RowBox[{"Q1", " ", "q3", " ", "x"}], "+", 
         RowBox[{"Q1", " ", "q4", " ", "x"}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"2", " ", "Q1", " ", "Q2", " ", "q4"}]]}]], "Output",
 CellChangeTimes->{3.6815732264678783`*^9}]
}, Open  ]],

Cell[TextData[StyleBox["Finding the equatins for price constraints: ", \
"Subtitle"]], "Text",
 CellChangeTimes->{3.733853884621263*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%36", "\[Equal]", "0"}], ",", "r1"}], "]"}]], "Input",
 CellChangeTimes->{{3.681573229604916*^9, 3.681573247683138*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", 
    RowBox[{"-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"Q2", " ", "q3", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", 
          RowBox[{"2", " ", "q4"}]}], ")"}]}]], 
      RowBox[{"Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          SuperscriptBox["Q1", "2"], " ", "Q2", " ", "q3"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["Q2", "3"], " ", "q3"}], "-", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"c", " ", "Q2", " ", 
          SuperscriptBox["q3", "3"]}], "-", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q1", "2"], " ", "Q2", " ", "q4"}], "+", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q2", "3"], " ", "q4"}], "+", 
         RowBox[{"k2", " ", "q3", " ", "q4"}], "+", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", "Q2", " ", "q3", " ", "q4"}], 
         "-", 
         RowBox[{"2", " ", "c", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3", " ", "q4"}], "-", 
         RowBox[{"c", " ", "Q2", " ", "q3", " ", 
          SuperscriptBox["q4", "2"]}], "-", 
         RowBox[{"Q2", " ", 
          SuperscriptBox["q3", "2"], " ", "x"}], "+", 
         RowBox[{"Q2", " ", "q3", " ", "q4", " ", "x"}]}], ")"}]}]}]}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{3.681573252051062*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%26", "\[Equal]", "0"}], ",", "r1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6815733885006313`*^9, 3.681573408724135*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", 
    FractionBox[
     RowBox[{
      FractionBox[
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "+", "q2"}], ")"}]}], 
       RowBox[{"2", " ", "Q1"}]], "-", 
      FractionBox[
       RowBox[{"k1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "q1"}], " ", "Q2", " ", "q3"}], "+", 
          RowBox[{"q1", " ", "Q2", " ", "q4"}], "-", 
          RowBox[{"Q2", " ", "q3", " ", "q4"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"q1", "-", "Q1"}], ")"}], "2"], "-", 
             SuperscriptBox["Q2", "2"]}], ")"}], " ", "q3"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["q1", "2"]}], "+", 
             RowBox[{"2", " ", "q1", " ", "Q1"}], "+", 
             RowBox[{"q3", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "Q1"}], "+", 
                RowBox[{"2", " ", "Q2"}], "+", "q3"}], ")"}]}]}], ")"}], " ", 
           "q4"}], "-", 
          RowBox[{"q3", " ", 
           SuperscriptBox["q4", "2"]}]}], ")"}]}], 
       RowBox[{"2", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{"q3", " ", "q4", " ", "r2"}], 
       RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"q2", " ", "x"}], 
       RowBox[{"2", " ", "Q1"}]]}], 
     RowBox[{
      FractionBox[
       RowBox[{"q1", " ", "q3"}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Q1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"q1", " ", "q4"}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Q1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{"q3", " ", "q4"}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Q1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"q1", " ", "Q2", " ", "q3"}], "-", 
        RowBox[{"q1", " ", "Q2", " ", "q4"}], "+", 
        RowBox[{"Q2", " ", "q3", " ", "q4"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Q1", "2"], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}]}]]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6815734729477243`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q4", "*", 
    RowBox[{"r2", "/", "Q2"}]}], "+", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q4", "-", "Q2"}], ")"}], "^", "2"}]}], "-", 
   RowBox[{"q4", "*", 
    RowBox[{"r1", "/", "Q1"}]}], "-", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q4", "-", "Q1"}], ")"}], "^", "2"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", "%42"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6815734924597187`*^9, 3.681573542506915*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "c"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q4"}], ")"}], "2"]}], "+", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q4"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q4", " ", "r2"}], "Q2"], "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q1", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
       RowBox[{"q3", " ", "q4"}]}], ")"}]}]], 
   RowBox[{"q4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k1", " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q1", " ", 
          RowBox[{"(", 
           RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
         RowBox[{"q3", " ", "q4"}]}], ")"}]}], "+", 
      RowBox[{"Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "+", "q2"}], ")"}], " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
         RowBox[{"c", " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "q1", " ", "Q1", " ", 
             RowBox[{"(", 
              RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["q1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}], "+", 
            RowBox[{"q3", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["Q1", "2"]}], "+", 
               SuperscriptBox["Q2", "2"], "+", 
               RowBox[{"2", " ", "Q1", " ", "q4"}], "-", 
               RowBox[{"2", " ", "Q2", " ", "q4"}], "-", 
               RowBox[{"q3", " ", "q4"}], "+", 
               SuperscriptBox["q4", "2"]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"q3", " ", "q4", " ", "r2"}], "-", 
         RowBox[{"q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
         RowBox[{"q2", " ", "Q2", " ", "q4", " ", "x"}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.681573592528673*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "%43", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "c"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"Q1", "-", "q4"}], ")"}], "2"]}], "+", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"Q2", "-", "q4"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q4", " ", "r2"}], "Q2"], "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q1", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
       RowBox[{"q3", " ", "q4"}]}], ")"}]}]], 
   RowBox[{"q4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k1", " ", "Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q1", " ", 
          RowBox[{"(", 
           RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
         RowBox[{"q3", " ", "q4"}]}], ")"}]}], "+", 
      RowBox[{"Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "+", "q2"}], ")"}], " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
         RowBox[{"c", " ", "Q2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "q1", " ", "Q1", " ", 
             RowBox[{"(", 
              RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["q1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}], "+", 
            RowBox[{"q3", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["Q1", "2"]}], "+", 
               SuperscriptBox["Q2", "2"], "+", 
               RowBox[{"2", " ", "Q1", " ", "q4"}], "-", 
               RowBox[{"2", " ", "Q2", " ", "q4"}], "-", 
               RowBox[{"q3", " ", "q4"}], "+", 
               SuperscriptBox["q4", "2"]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"q3", " ", "q4", " ", "r2"}], "-", 
         RowBox[{"q2", " ", "Q2", " ", "q3", " ", "x"}], "+", 
         RowBox[{"q2", " ", "Q2", " ", "q4", " ", "x"}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.681573595413754*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%44", "\[Equal]", "0"}], ",", "r2"}], "]"}]], "Input",
 CellChangeTimes->{{3.681573600059466*^9, 3.68157361108191*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       FractionBox["q4", "Q2"], "-", 
       FractionBox[
        RowBox[{"q3", " ", 
         SuperscriptBox["q4", "2"]}], 
        RowBox[{"2", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q3", " ", "q4"}]}], ")"}]}]]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Q1", "-", "q4"}], ")"}], "2"]}], "-", 
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Q2", "-", "q4"}], ")"}], "2"]}], "+", 
       FractionBox[
        RowBox[{"k1", " ", "q4"}], 
        RowBox[{"2", " ", "Q1"}]], "+", 
       FractionBox[
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{"q1", "+", "q2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q3", "-", "q4"}], ")"}], " ", "q4"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q3", " ", "q4"}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"c", " ", "q4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "q1", " ", "Q1", " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["q1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q3"}], "+", "q4"}], ")"}]}], "+", 
           RowBox[{"q3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["Q1", "2"]}], "+", 
              SuperscriptBox["Q2", "2"], "+", 
              RowBox[{"2", " ", "Q1", " ", "q4"}], "-", 
              RowBox[{"2", " ", "Q2", " ", "q4"}], "-", 
              RowBox[{"q3", " ", "q4"}], "+", 
              SuperscriptBox["q4", "2"]}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q3", " ", "q4"}]}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"q2", " ", "q3", " ", "q4", " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q3", " ", "q4"}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"q2", " ", 
         SuperscriptBox["q4", "2"], " ", "x"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", 
            RowBox[{"(", 
             RowBox[{"q3", "-", "q4"}], ")"}]}], "+", 
           RowBox[{"q3", " ", "q4"}]}], ")"}]}]]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6815736198907137`*^9}]
}, Open  ]]
},
WindowSize->{1280, 981},
WindowMargins->{{-10, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.4 for Linux x86 (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 603, 14, 77, "Text"],
Cell[CellGroupData[{
Cell[1185, 38, 159, 5, 58, "Input"],
Cell[1347, 45, 245, 8, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1629, 58, 235, 8, 58, "Input"],
Cell[1867, 68, 363, 13, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2267, 86, 235, 8, 58, "Input"],
Cell[2505, 96, 363, 13, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2905, 114, 159, 5, 58, "Input"],
Cell[3067, 121, 252, 8, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3356, 134, 375, 12, 59, "Input"],
Cell[3734, 148, 923, 34, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4694, 187, 375, 12, 59, "Input"],
Cell[5072, 201, 1348, 50, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6457, 256, 375, 12, 59, "Input"],
Cell[6835, 270, 1351, 50, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8223, 325, 375, 12, 59, "Input"],
Cell[8601, 339, 962, 35, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9600, 379, 89, 2, 34, "Input"],
Cell[9692, 383, 664, 24, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10393, 412, 157, 3, 34, "Input"],
Cell[10553, 417, 1296, 49, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11886, 471, 214, 5, 34, "Input"],
Cell[12103, 478, 1736, 65, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13876, 548, 214, 5, 34, "Input"],
Cell[14093, 555, 1109, 41, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15239, 601, 892, 25, 34, "Input"],
Cell[16134, 628, 24257, 617, 1218, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40428, 1250, 848, 26, 32, "Input"],
Cell[41279, 1278, 22937, 549, 801, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64253, 1832, 246, 6, 32, "Input"],
Cell[64502, 1840, 3541, 96, 154, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68080, 1941, 628, 19, 32, "Input"],
Cell[68711, 1962, 6041, 145, 201, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74789, 2112, 244, 6, 32, "Input"],
Cell[75036, 2120, 1149, 33, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76222, 2158, 319, 7, 32, "Input"],
Cell[76544, 2167, 2102, 60, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78683, 2232, 314, 7, 32, "Input"],
Cell[79000, 2241, 1064, 31, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80101, 2277, 624, 18, 32, "Input"],
Cell[80728, 2297, 12038, 312, 504, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92803, 2614, 183, 4, 32, "Input"],
Cell[92989, 2620, 965, 23, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93991, 2648, 527, 17, 32, "Input"],
Cell[94521, 2667, 1171, 35, 57, "Output"]
}, Open  ]],
Cell[95707, 2705, 136, 2, 43, "Text"],
Cell[CellGroupData[{
Cell[95868, 2711, 181, 4, 32, "Input"],
Cell[96052, 2717, 1474, 37, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97563, 2759, 221, 5, 55, "Input"],
Cell[97787, 2766, 2970, 88, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100794, 2859, 529, 17, 32, "Input"],
Cell[101326, 2878, 2270, 67, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103633, 2950, 84, 2, 32, "Input"],
Cell[103720, 2954, 2226, 65, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105983, 3024, 180, 4, 32, "Input"],
Cell[106166, 3030, 3128, 93, 125, "Output"]
}, Open  ]]
}
]
*)

