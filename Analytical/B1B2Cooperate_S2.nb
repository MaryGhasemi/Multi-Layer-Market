(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    120477,       3670]
NotebookOptionsPosition[    115893,       3506]
NotebookOutlinePosition[    116231,       3521]
CellTagsIndexPosition[    116188,       3518]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "First step is to define the demands based on the prices and qualities, \
which follows the \[Theta] definition. B1 has the lowest quality in the \
market and B3 has the highest quality. In this part we assum that B2 buys \
from S2. B1 & B2 Cooperate\nm here is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "max"], TraditionalForm]]],
 " and x is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", "min"], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.733852732733931*^9, 3.733852736805244*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D1", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p2", "-", "p1"}], 
    RowBox[{"q2", "-", "q1"}]], "-", "m"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "m"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]]}]], "Output",
 CellChangeTimes->{3.672501284690241*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D2", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"p3", "-", "p2"}], 
    RowBox[{"q3", "-", "q2"}]], "-", 
   FractionBox[
    RowBox[{"p2", "-", "p1"}], 
    RowBox[{"q2", "-", "q1"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p1"}], "+", "p2"}], 
    RowBox[{
     RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]]}]], "Output",
 CellChangeTimes->{3.672501347516034*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D3", "=", " ", 
  RowBox[{"x", "-", " ", 
   FractionBox[
    RowBox[{"p3", "-", "p2"}], 
    RowBox[{"q3", "-", "q2"}]]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p2"}], "+", "p3"}], 
    RowBox[{
     RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", "x"}]], "Output",
 CellChangeTimes->{3.67250135403028*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]1", "=", " ", 
  RowBox[{
   RowBox[{"D1", "*", "p1"}], "-", 
   RowBox[{
    RowBox[{"q1", "/", "Q1"}], "*", "D1", "*", "r1"}], "-", 
   RowBox[{"c", "*", "D1", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "^", "2"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "m"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p1"}], "+", "p2"}], 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q1", "-", "Q1"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "m"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p1"}], "+", "p2"}], 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "m"}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], ")"}], " ", "r1"}], 
   "Q1"]}]], "Output",
 CellChangeTimes->{3.67250136120542*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]2", "=", " ", 
  RowBox[{
   RowBox[{"D2", "*", "p2"}], "-", 
   RowBox[{
    RowBox[{"q2", "/", "Q2"}], "*", "D2", "*", "r2"}], "-", 
   RowBox[{"c", "*", "D2", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q2"}], ")"}], "^", "2"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p2"}], "+", "p3"}], 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q2", "-", "Q2"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", "p2"}], 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p2"}], "+", "p3"}], 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p1"}], "+", "p2"}], 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r2"}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.6725013672093773`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPi]3", "=", " ", 
  RowBox[{
   RowBox[{"D3", "*", "p3"}], "-", 
   RowBox[{
    RowBox[{"q3", "/", "Q2"}], "*", "D3", "*", "r2"}], "-", 
   RowBox[{"c", "*", "D3", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q3", "-", "Q2"}], ")"}], "^", "2"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", "x"}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p2"}], "+", "p3"}], 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", "x"}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q3", " ", "r2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "p2"}], "+", "p3"}], 
        RowBox[{
         RowBox[{"-", "q2"}], "+", "q3"}]]}], "+", "x"}], ")"}]}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.6725013766531076`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p1"], 
  RowBox[{"(", 
   RowBox[{"\[CapitalPi]1", "+", "\[CapitalPi]2"}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "m"}], "-", 
  FractionBox["p1", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox["p2", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{"q1", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"q2", " ", "r2"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}]]}]], "Output",
 CellChangeTimes->{3.6725018878999033`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"-", "m"}], "-", 
   FractionBox["p1", 
    RowBox[{
     RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
   FractionBox["p2", 
    RowBox[{
     RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p1"}], "+", "p2"}], 
    RowBox[{
     RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
   FractionBox[
    RowBox[{"c", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
    RowBox[{
     RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
   FractionBox[
    RowBox[{"c", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], 
    RowBox[{
     RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
   FractionBox[
    RowBox[{"q1", " ", "r1"}], 
    RowBox[{"Q1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{"q2", " ", "r2"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}]]}], 
  "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"Q1", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "p1"}], "-", 
      RowBox[{"2", " ", "p2"}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], "-", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"q1", "-", "Q1", "+", "q2", "-", "Q2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"q1", "-", "Q1", "-", "q2", "+", "Q2"}], ")"}]}]}], ")"}]}], 
   "-", 
   RowBox[{"q1", " ", "Q2", " ", "r1"}], "+", 
   RowBox[{"Q1", " ", "q2", " ", "r2"}]}], 
  RowBox[{"Q1", " ", 
   RowBox[{"(", 
    RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]]], "Output",
 CellChangeTimes->{3.6725019204735537`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p2"], 
  RowBox[{"(", 
   RowBox[{"\[CapitalPi]1", "+", "\[CapitalPi]2"}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["p1", 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p1"}], "+", "p2"}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "-", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q1"}], "+", "q2"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
  RowBox[{"p2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q2", "-", "Q2"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q1", " ", "r1"}], 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"-", "q1"}], "+", "q2"}]]}], "-", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}], " ", "r2"}], 
   "Q2"]}]], "Output",
 CellChangeTimes->{3.672501899067212*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%8", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q3"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "p2", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q1", "-", "q3"}], ")"}]}], "+", 
    RowBox[{"Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], "+", 
       RowBox[{"2", " ", "p1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}], "+", 
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "q1"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"q2", "-", "Q2"}], ")"}], "2"], "+", 
             RowBox[{"2", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", "q3"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["q1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["Q1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q2", "-", "Q2"}], ")"}], "2"], " ", "q3"}]}], ")"}]}]}],
       ")"}]}], "+", 
    RowBox[{"q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "-", "q3"}], ")"}], " ", "r1"}], "+", 
    RowBox[{"Q1", " ", "q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q3"}], ")"}], " ", "r2"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.672501915768608*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "p3"], "\[CapitalPi]3"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["p3", 
    RowBox[{
     RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "p2"}], "+", "p3"}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
  FractionBox[
   RowBox[{"q3", " ", "r2"}], 
   RowBox[{"Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", "x"}]], "Output",
 CellChangeTimes->{3.672501906610689*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["p3", 
     RowBox[{
      RowBox[{"-", "q2"}], "+", "q3"}]]}], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "p2"}], "+", "p3"}], 
    RowBox[{
     RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
   FractionBox[
    RowBox[{"c", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "Q2"}], "+", "q3"}], ")"}], "2"]}], 
    RowBox[{
     RowBox[{"-", "q2"}], "+", "q3"}]], "+", 
   FractionBox[
    RowBox[{"q3", " ", "r2"}], 
    RowBox[{"Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "q2"}], "+", "q3"}], ")"}]}]], "+", "x"}], "]"}]], "Input",\

 NumberMarks->False],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"p2", " ", "Q2"}], "-", 
    RowBox[{"2", " ", "p3", " ", "Q2"}], "+", 
    RowBox[{"c", " ", 
     SuperscriptBox["Q2", "3"]}], "-", 
    RowBox[{"2", " ", "c", " ", 
     SuperscriptBox["Q2", "2"], " ", "q3"}], "+", 
    RowBox[{"c", " ", "Q2", " ", 
     SuperscriptBox["q3", "2"]}], "+", 
    RowBox[{"q3", " ", "r2"}], "-", 
    RowBox[{"q2", " ", "Q2", " ", "x"}], "+", 
    RowBox[{"Q2", " ", "q3", " ", "x"}]}], 
   RowBox[{
    RowBox[{"q2", " ", "Q2"}], "-", 
    RowBox[{"Q2", " ", "q3"}]}]]}]], "Output",
 CellChangeTimes->{3.6725019266055603`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"%10", "\[Equal]", "0"}], "&&", 
     RowBox[{"%11", "\[Equal]", "0"}], "&&", 
     RowBox[{"%12", "\[Equal]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"%10", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "p1"], 
      RowBox[{"(", 
       RowBox[{"\[CapitalPi]1", "+", "\[CapitalPi]2"}], ")"}]}]}], ",", " ", "...",
     ",", " ", 
    RowBox[{"%12", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "p3"], "\[CapitalPi]3"}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.6725019322070923`*^9, 3.6725019877029343`*^9}, {
  3.733852751309773*^9, 3.7338527674622717`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"q1", "-", "q2"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"q2", " ", "Q2"}], "-", 
                 RowBox[{"Q2", " ", "q3"}]}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"4", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q3"}], ")"}]}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"q1", "-", "q2"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"q2", " ", "Q2"}], "-", 
                 RowBox[{"Q2", " ", "q3"}]}], ")"}]}]]}], ")"}]}], " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"m", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
             RowBox[{"q1", "-", "q2"}]], "-", 
            FractionBox[
             RowBox[{"c", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "Q1", "+", "q2", "-", "Q2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "Q1", "-", "q2", "+", "Q2"}], ")"}]}], 
             RowBox[{"q1", "-", "q2"}]], "-", 
            FractionBox[
             RowBox[{"q1", " ", "r1"}], 
             RowBox[{"Q1", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "q2"}], ")"}]}]], "+", 
            FractionBox[
             RowBox[{"q2", " ", "r2"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}]}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{"c", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "q1"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"q2", "-", "Q2"}], ")"}], "2"], "+", 
                    RowBox[{"2", " ", "Q1", " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "-", "q3"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["q1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["Q1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"q2", "-", "Q2"}], ")"}], "2"], " ", "q3"}]}], 
                    ")"}]}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"q1", "-", "q2"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"q2", "-", "q3"}], ")"}]}]], "+", 
                 FractionBox[
                  RowBox[{"q1", " ", "r1"}], 
                  RowBox[{"Q1", " ", 
                   RowBox[{"(", 
                    RowBox[{"q1", "-", "q2"}], ")"}]}]], "+", 
                 FractionBox[
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "q1"}], "+", "q3"}], ")"}], " ", "r2"}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", 
                   RowBox[{"(", 
                    RowBox[{"q2", "-", "q3"}], ")"}]}]]}], ")"}]}], 
              RowBox[{
               RowBox[{"q2", " ", "Q2"}], "-", 
               RowBox[{"Q2", " ", "q3"}]}]], "-", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{"c", " ", 
                    SuperscriptBox["Q2", "3"]}], 
                   RowBox[{
                    RowBox[{"q2", " ", "Q2"}], "-", 
                    RowBox[{"Q2", " ", "q3"}]}]]}], "+", 
                 FractionBox[
                  RowBox[{"2", " ", "c", " ", 
                   SuperscriptBox["Q2", "2"], " ", "q3"}], 
                  RowBox[{
                   RowBox[{"q2", " ", "Q2"}], "-", 
                   RowBox[{"Q2", " ", "q3"}]}]], "-", 
                 FractionBox[
                  RowBox[{"c", " ", "Q2", " ", 
                   SuperscriptBox["q3", "2"]}], 
                  RowBox[{
                   RowBox[{"q2", " ", "Q2"}], "-", 
                   RowBox[{"Q2", " ", "q3"}]}]], "-", 
                 FractionBox[
                  RowBox[{"q3", " ", "r2"}], 
                  RowBox[{
                   RowBox[{"q2", " ", "Q2"}], "-", 
                   RowBox[{"Q2", " ", "q3"}]}]], "+", 
                 FractionBox[
                  RowBox[{"q2", " ", "Q2", " ", "x"}], 
                  RowBox[{
                   RowBox[{"q2", " ", "Q2"}], "-", 
                   RowBox[{"Q2", " ", "q3"}]}]], "-", 
                 FractionBox[
                  RowBox[{"Q2", " ", "q3", " ", "x"}], 
                  RowBox[{
                   RowBox[{"q2", " ", "Q2"}], "-", 
                   RowBox[{"Q2", " ", "q3"}]}]]}], ")"}]}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"q1", "-", "q2"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}]]}], ")"}]}]}]}], ")"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"6", " ", "q1", " ", "Q2"}], 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"q1", "-", "q2"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"q2", " ", "Q2"}], "-", 
              RowBox[{"Q2", " ", "q3"}]}], ")"}]}]]}], "+", 
         FractionBox[
          RowBox[{"6", " ", "q2", " ", "Q2"}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q1", "-", "q2"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q2", " ", "Q2"}], "-", 
             RowBox[{"Q2", " ", "q3"}]}], ")"}]}]]}], ")"}]}]}]}], ",", 
    RowBox[{"p2", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "m", " ", "q2", " ", "Q2"}], "-", 
        RowBox[{"2", " ", "c", " ", 
         SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
        RowBox[{"4", " ", "c", " ", "q2", " ", 
         SuperscriptBox["Q2", "2"]}], "-", 
        RowBox[{"3", " ", "c", " ", 
         SuperscriptBox["Q2", "3"]}], "+", 
        RowBox[{"2", " ", "m", " ", "Q2", " ", "q3"}], "+", 
        RowBox[{"2", " ", "c", " ", 
         SuperscriptBox["Q2", "2"], " ", "q3"}], "-", 
        RowBox[{"c", " ", "Q2", " ", 
         SuperscriptBox["q3", "2"]}], "-", 
        RowBox[{"2", " ", "q2", " ", "r2"}], "-", 
        RowBox[{"q3", " ", "r2"}], "+", 
        RowBox[{"q2", " ", "Q2", " ", "x"}], "-", 
        RowBox[{"Q2", " ", "q3", " ", "x"}]}], 
       RowBox[{"3", " ", "Q2"}]]}]}], ",", 
    RowBox[{"p3", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "m"}], " ", "q2", " ", "Q2"}], "-", 
        RowBox[{"c", " ", 
         SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
        RowBox[{"2", " ", "c", " ", "q2", " ", 
         SuperscriptBox["Q2", "2"]}], "-", 
        RowBox[{"3", " ", "c", " ", 
         SuperscriptBox["Q2", "3"]}], "+", 
        RowBox[{"m", " ", "Q2", " ", "q3"}], "+", 
        RowBox[{"4", " ", "c", " ", 
         SuperscriptBox["Q2", "2"], " ", "q3"}], "-", 
        RowBox[{"2", " ", "c", " ", "Q2", " ", 
         SuperscriptBox["q3", "2"]}], "-", 
        RowBox[{"q2", " ", "r2"}], "-", 
        RowBox[{"2", " ", "q3", " ", "r2"}], "+", 
        RowBox[{"2", " ", "q2", " ", "Q2", " ", "x"}], "-", 
        RowBox[{"2", " ", "Q2", " ", "q3", " ", "x"}]}], 
       RowBox[{"3", " ", "Q2"}]]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.672501989837241*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%14", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "q1"}], "+", "q2", "-", 
      RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
   RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], "+", 
      SuperscriptBox["q2", "2"], "-", 
      RowBox[{"2", " ", "q2", " ", "Q2"}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["Q2", "2"]}], "-", 
      RowBox[{"4", " ", "Q2", " ", "q3"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
   RowBox[{"3", " ", "q1", " ", "Q2", " ", "r1"}], "+", 
   RowBox[{"Q1", " ", "q2", " ", "r2"}], "+", 
   RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
   RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
  RowBox[{"6", " ", "Q1", " ", "Q2"}]]], "Output",
 CellChangeTimes->{3.6725020076615477`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "m", " ", "q2", " ", "Q2"}], "-", 
     RowBox[{"2", " ", "c", " ", 
      SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
     RowBox[{"4", " ", "c", " ", "q2", " ", 
      SuperscriptBox["Q2", "2"]}], "-", 
     RowBox[{"3", " ", "c", " ", 
      SuperscriptBox["Q2", "3"]}], "+", 
     RowBox[{"2", " ", "m", " ", "Q2", " ", "q3"}], "+", 
     RowBox[{"2", " ", "c", " ", 
      SuperscriptBox["Q2", "2"], " ", "q3"}], "-", 
     RowBox[{"c", " ", "Q2", " ", 
      SuperscriptBox["q3", "2"]}], "-", 
     RowBox[{"2", " ", "q2", " ", "r2"}], "-", 
     RowBox[{"q3", " ", "r2"}], "+", 
     RowBox[{"q2", " ", "Q2", " ", "x"}], "-", 
     RowBox[{"Q2", " ", "q3", " ", "x"}]}], 
    RowBox[{"3", " ", "Q2"}]]}], "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", "m", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
   RowBox[{"c", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["q2", "2"]}], "-", 
      RowBox[{"4", " ", "q2", " ", "Q2"}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["Q2", "2"]}], "-", 
      RowBox[{"2", " ", "Q2", " ", "q3"}], "+", 
      SuperscriptBox["q3", "2"]}], ")"}]}], "+", 
   RowBox[{"2", " ", "q2", " ", "r2"}], "+", 
   RowBox[{"q3", " ", "r2"}], "-", 
   RowBox[{"q2", " ", "Q2", " ", "x"}], "+", 
   RowBox[{"Q2", " ", "q3", " ", "x"}]}], 
  RowBox[{"3", " ", "Q2"}]]], "Output",
 CellChangeTimes->{3.67250202761583*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "m"}], " ", "q2", " ", "Q2"}], "-", 
     RowBox[{"c", " ", 
      SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
     RowBox[{"2", " ", "c", " ", "q2", " ", 
      SuperscriptBox["Q2", "2"]}], "-", 
     RowBox[{"3", " ", "c", " ", 
      SuperscriptBox["Q2", "3"]}], "+", 
     RowBox[{"m", " ", "Q2", " ", "q3"}], "+", 
     RowBox[{"4", " ", "c", " ", 
      SuperscriptBox["Q2", "2"], " ", "q3"}], "-", 
     RowBox[{"2", " ", "c", " ", "Q2", " ", 
      SuperscriptBox["q3", "2"]}], "-", 
     RowBox[{"q2", " ", "r2"}], "-", 
     RowBox[{"2", " ", "q3", " ", "r2"}], "+", 
     RowBox[{"2", " ", "q2", " ", "Q2", " ", "x"}], "-", 
     RowBox[{"2", " ", "Q2", " ", "q3", " ", "x"}]}], 
    RowBox[{"3", " ", "Q2"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.672502100335155*^9, 3.672502108808506*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"m", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
   RowBox[{"c", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["q2", "2"], "-", 
      RowBox[{"2", " ", "q2", " ", "Q2"}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["Q2", "2"]}], "-", 
      RowBox[{"4", " ", "Q2", " ", "q3"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
   RowBox[{"q2", " ", "r2"}], "+", 
   RowBox[{"2", " ", "q3", " ", "r2"}], "-", 
   RowBox[{"2", " ", "q2", " ", "Q2", " ", "x"}], "+", 
   RowBox[{"2", " ", "Q2", " ", "q3", " ", "x"}]}], 
  RowBox[{"3", " ", "Q2"}]]], "Output",
 CellChangeTimes->{3.672502110914082*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U1", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"D1", "*", 
       RowBox[{"q1", "/", "Q1"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"r1", "-", "k1"}], ")"}]}], "-", 
    RowBox[{"e", "*", 
     RowBox[{"Q1", "^", "2"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "->", 
      FractionBox[
       RowBox[{
        RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1"}], "+", "q2", "-", 
           RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
        RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], "+", 
           SuperscriptBox["q2", "2"], "-", 
           RowBox[{"2", " ", "q2", " ", "Q2"}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["Q2", "2"]}], "-", 
           RowBox[{"4", " ", "Q2", " ", "q3"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
        RowBox[{"3", " ", "q1", " ", "Q2", " ", "r1"}], "+", 
        RowBox[{"Q1", " ", "q2", " ", "r2"}], "+", 
        RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
        RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
       RowBox[{"6", " ", "Q1", " ", "Q2"}]]}], ",", " ", 
     RowBox[{"p2", "->", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "m", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"c", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["q2", "2"]}], "-", 
           RowBox[{"4", " ", "q2", " ", "Q2"}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["Q2", "2"]}], "-", 
           RowBox[{"2", " ", "Q2", " ", "q3"}], "+", 
           SuperscriptBox["q3", "2"]}], ")"}]}], "+", 
        RowBox[{"2", " ", "q2", " ", "r2"}], "+", 
        RowBox[{"q3", " ", "r2"}], "-", 
        RowBox[{"q2", " ", "Q2", " ", "x"}], "+", 
        RowBox[{"Q2", " ", "q3", " ", "x"}]}], 
       RowBox[{"3", " ", "Q2"}]]}], ",", 
     RowBox[{"p3", "->", 
      FractionBox[
       RowBox[{
        RowBox[{"m", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"c", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q2", "2"], "-", 
           RowBox[{"2", " ", "q2", " ", "Q2"}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["Q2", "2"]}], "-", 
           RowBox[{"4", " ", "Q2", " ", "q3"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
        RowBox[{"q2", " ", "r2"}], "+", 
        RowBox[{"2", " ", "q3", " ", "r2"}], "-", 
        RowBox[{"2", " ", "q2", " ", "Q2", " ", "x"}], "+", 
        RowBox[{"2", " ", "Q2", " ", "q3", " ", "x"}]}], 
       RowBox[{"3", " ", "Q2"}]]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.672502134532578*^9, 3.672502183807722*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "e"}], " ", 
   SuperscriptBox["Q1", "2"]}], "+", 
  RowBox[{
   FractionBox["1", "Q1"], 
   RowBox[{"q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "k1"}], "+", "r1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "m"}], "+", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", "m", " ", "Q2", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
           RowBox[{"c", " ", "Q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["q2", "2"]}], "-", 
              RowBox[{"4", " ", "q2", " ", "Q2"}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["Q2", "2"]}], "-", 
              RowBox[{"2", " ", "Q2", " ", "q3"}], "+", 
              SuperscriptBox["q3", "2"]}], ")"}]}], "+", 
           RowBox[{"2", " ", "q2", " ", "r2"}], "+", 
           RowBox[{"q3", " ", "r2"}], "-", 
           RowBox[{"q2", " ", "Q2", " ", "x"}], "+", 
           RowBox[{"Q2", " ", "q3", " ", "x"}]}], 
          RowBox[{"3", " ", "Q2"}]], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"6", " ", "Q1", " ", "Q2"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", " ", "q1"}], "+", "q2", "-", 
               RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
            RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], "+", 
               SuperscriptBox["q2", "2"], "-", 
               RowBox[{"2", " ", "q2", " ", "Q2"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["Q2", "2"]}], "-", 
               RowBox[{"4", " ", "Q2", " ", "q3"}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
            RowBox[{"3", " ", "q1", " ", "Q2", " ", "r1"}], "+", 
            RowBox[{"Q1", " ", "q2", " ", "r2"}], "+", 
            RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
            RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.6725021860031347`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%20", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SuperscriptBox["Q1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "e", " ", 
        SuperscriptBox["Q1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], "+", 
       RowBox[{"q1", " ", "r1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], "+", 
          RowBox[{"c", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "Q1", "+", "q2", "-", "Q2"}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "Q1", "-", "q2", "+", "Q2"}], ")"}]}], 
          "+", 
          RowBox[{"q1", " ", "r1"}]}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{"q1", " ", "Q1", " ", "q2", " ", "r1", " ", "r2"}], "+", 
    RowBox[{"k1", " ", "q1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}], "-", 
       RowBox[{"c", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q1"}], "+", "Q1", "+", "q2", "-", "Q2"}], ")"}], " ", 
        "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q1"}], "+", "Q1", "-", "q2", "+", "Q2"}], ")"}]}], 
       "-", 
       RowBox[{"q1", " ", "Q2", " ", "r1"}], "+", 
       RowBox[{"Q1", " ", "q2", " ", "r2"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.672502189885468*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U2", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"D2", "*", 
         RowBox[{"q2", "/", "Q2"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"D3", "*", 
         RowBox[{"q3", "/", "Q2"}]}], ")"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"r2", "-", "k2"}], ")"}]}], "-", 
    RowBox[{"e", "*", 
     RowBox[{"Q2", "^", "2"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p1", "->", 
      FractionBox[
       RowBox[{
        RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "q1"}], "+", "q2", "-", 
           RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
        RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], "+", 
           SuperscriptBox["q2", "2"], "-", 
           RowBox[{"2", " ", "q2", " ", "Q2"}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["Q2", "2"]}], "-", 
           RowBox[{"4", " ", "Q2", " ", "q3"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
        RowBox[{"3", " ", "q1", " ", "Q2", " ", "r1"}], "+", 
        RowBox[{"Q1", " ", "q2", " ", "r2"}], "+", 
        RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
        RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
       RowBox[{"6", " ", "Q1", " ", "Q2"}]]}], ",", " ", 
     RowBox[{"p2", "->", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "m", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"c", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["q2", "2"]}], "-", 
           RowBox[{"4", " ", "q2", " ", "Q2"}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["Q2", "2"]}], "-", 
           RowBox[{"2", " ", "Q2", " ", "q3"}], "+", 
           SuperscriptBox["q3", "2"]}], ")"}]}], "+", 
        RowBox[{"2", " ", "q2", " ", "r2"}], "+", 
        RowBox[{"q3", " ", "r2"}], "-", 
        RowBox[{"q2", " ", "Q2", " ", "x"}], "+", 
        RowBox[{"Q2", " ", "q3", " ", "x"}]}], 
       RowBox[{"3", " ", "Q2"}]]}], ",", 
     RowBox[{"p3", "->", 
      FractionBox[
       RowBox[{
        RowBox[{"m", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"c", " ", "Q2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q2", "2"], "-", 
           RowBox[{"2", " ", "q2", " ", "Q2"}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["Q2", "2"]}], "-", 
           RowBox[{"4", " ", "Q2", " ", "q3"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
        RowBox[{"q2", " ", "r2"}], "+", 
        RowBox[{"2", " ", "q3", " ", "r2"}], "-", 
        RowBox[{"2", " ", "q2", " ", "Q2", " ", "x"}], "+", 
        RowBox[{"2", " ", "Q2", " ", "q3", " ", "x"}]}], 
       RowBox[{"3", " ", "Q2"}]]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.672502206462413*^9, 3.6725022162691717`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "e"}], " ", 
   SuperscriptBox["Q2", "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "k2"}], "+", "r2"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"q3", " ", 
       RowBox[{"(", 
        RowBox[{"x", "-", 
         FractionBox[
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{"2", " ", "m", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
              RowBox[{"c", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox["q2", "2"]}], "-", 
                 RowBox[{"4", " ", "q2", " ", "Q2"}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["Q2", "2"]}], "-", 
                 RowBox[{"2", " ", "Q2", " ", "q3"}], "+", 
                 SuperscriptBox["q3", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "q2", " ", "r2"}], "+", 
              RowBox[{"q3", " ", "r2"}], "-", 
              RowBox[{"q2", " ", "Q2", " ", "x"}], "+", 
              RowBox[{"Q2", " ", "q3", " ", "x"}]}], 
             RowBox[{"3", " ", "Q2"}]]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"m", " ", "Q2", " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
             RowBox[{"c", " ", "Q2", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["q2", "2"], "-", 
                RowBox[{"2", " ", "q2", " ", "Q2"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["Q2", "2"]}], "-", 
                RowBox[{"4", " ", "Q2", " ", "q3"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
             RowBox[{"q2", " ", "r2"}], "+", 
             RowBox[{"2", " ", "q3", " ", "r2"}], "-", 
             RowBox[{"2", " ", "q2", " ", "Q2", " ", "x"}], "+", 
             RowBox[{"2", " ", "Q2", " ", "q3", " ", "x"}]}], 
            RowBox[{"3", " ", "Q2"}]]}], 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}]]}], ")"}]}], "Q2"], "+", 
     RowBox[{
      FractionBox["1", "Q2"], 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{"2", " ", "m", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
              RowBox[{"c", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox["q2", "2"]}], "-", 
                 RowBox[{"4", " ", "q2", " ", "Q2"}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["Q2", "2"]}], "-", 
                 RowBox[{"2", " ", "Q2", " ", "q3"}], "+", 
                 SuperscriptBox["q3", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "q2", " ", "r2"}], "+", 
              RowBox[{"q3", " ", "r2"}], "-", 
              RowBox[{"q2", " ", "Q2", " ", "x"}], "+", 
              RowBox[{"Q2", " ", "q3", " ", "x"}]}], 
             RowBox[{"3", " ", "Q2"}]]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"m", " ", "Q2", " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
             RowBox[{"c", " ", "Q2", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["q2", "2"], "-", 
                RowBox[{"2", " ", "q2", " ", "Q2"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["Q2", "2"]}], "-", 
                RowBox[{"4", " ", "Q2", " ", "q3"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
             RowBox[{"q2", " ", "r2"}], "+", 
             RowBox[{"2", " ", "q3", " ", "r2"}], "-", 
             RowBox[{"2", " ", "q2", " ", "Q2", " ", "x"}], "+", 
             RowBox[{"2", " ", "Q2", " ", "q3", " ", "x"}]}], 
            RowBox[{"3", " ", "Q2"}]]}], 
          RowBox[{
           RowBox[{"-", "q2"}], "+", "q3"}]], "-", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"2", " ", "m", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
              RowBox[{"c", " ", "Q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox["q2", "2"]}], "-", 
                 RowBox[{"4", " ", "q2", " ", "Q2"}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["Q2", "2"]}], "-", 
                 RowBox[{"2", " ", "Q2", " ", "q3"}], "+", 
                 SuperscriptBox["q3", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "q2", " ", "r2"}], "+", 
              RowBox[{"q3", " ", "r2"}], "-", 
              RowBox[{"q2", " ", "Q2", " ", "x"}], "+", 
              RowBox[{"Q2", " ", "q3", " ", "x"}]}], 
             RowBox[{"3", " ", "Q2"}]], "-", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"6", " ", "Q1", " ", "Q2"}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "q1"}], "+", "q2", "-", 
                  RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
               RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], "+", 
                  SuperscriptBox["q2", "2"], "-", 
                  RowBox[{"2", " ", "q2", " ", "Q2"}], "+", 
                  RowBox[{"3", " ", 
                   SuperscriptBox["Q2", "2"]}], "-", 
                  RowBox[{"4", " ", "Q2", " ", "q3"}], "+", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
               RowBox[{"3", " ", "q1", " ", "Q2", " ", "r1"}], "+", 
               RowBox[{"Q1", " ", "q2", " ", "r2"}], "+", 
               RowBox[{"2", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
               RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "q2"}], "+", "q3"}], ")"}], " ", "x"}]}], 
              ")"}]}]}], ")"}]}]}], ")"}]}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.672502256158836*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%22", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"6", " ", "Q1", " ", 
    RowBox[{"(", 
     RowBox[{"q1", "-", "q2"}], ")"}], " ", 
    SuperscriptBox["Q2", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"6", " ", "e", " ", "Q1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
     SuperscriptBox["Q2", "4"]}], "+", 
    RowBox[{"k2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}], "+", 
       RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "q2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", 
              SuperscriptBox["q1", "2"]}], "+", 
             RowBox[{"6", " ", "q1", " ", "Q1"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["Q1", "2"]}], "+", 
             RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
             SuperscriptBox["q2", "2"], "-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], 
             "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["Q2", "2"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", "q3"}], 
          "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}], " ", 
           SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
       RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "-", 
       RowBox[{"2", " ", "q1", " ", "Q1", " ", "q2", " ", "r2"}], "-", 
       RowBox[{"Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "r2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "Q1", " ", "q3", " ", "r2"}], "-", 
       RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "-", 
       RowBox[{"2", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}]}], ")"}]}], "+", 
    RowBox[{"r2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "m"}], " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}], "+", 
       RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", 
              SuperscriptBox["q1", "2"]}], "+", 
             RowBox[{"6", " ", "q1", " ", "Q1"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["Q1", "2"]}], "+", 
             RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
             SuperscriptBox["q2", "2"], "-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], 
             "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["Q2", "2"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", "q3"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
           SuperscriptBox["q3", "2"]}]}], ")"}]}], "-", 
       RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
       RowBox[{"2", " ", "q1", " ", "Q1", " ", "q2", " ", "r2"}], "+", 
       RowBox[{"Q1", " ", 
        SuperscriptBox["q2", "2"], " ", "r2"}], "-", 
       RowBox[{"2", " ", "q1", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
       RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
       RowBox[{"2", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.67250226260211*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "r1"], "%21", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"%21", " ", ":", " ", 
    RowBox[{"Simplify", "[", "U1", "]"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.672502281278363*^9, 3.6725022871191673`*^9}, {
  3.7338528086552467`*^9, 3.733852813463499*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "k1"}], " ", 
    SuperscriptBox["q1", "2"], " ", "Q2"}], "+", 
   RowBox[{"Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "r1"}], "+", 
      RowBox[{"q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], "+", 
         RowBox[{"c", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "q1"}], "+", "Q1", "+", "q2", "-", "Q2"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "q1"}], "+", "Q1", "-", "q2", "+", "Q2"}], ")"}]}], 
         "+", 
         RowBox[{"q1", " ", "r1"}]}], ")"}]}]}], ")"}]}], "-", 
   RowBox[{"q1", " ", "Q1", " ", "q2", " ", "r2"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["Q1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]]], "Output",
 CellChangeTimes->{3.6725022884027777`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[PartialD]", "r2"], "%23", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"%23", " ", ":", " ", 
    RowBox[{"Simplify", "[", "U2", "]"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6725022977113447`*^9, 3.672502298674654*^9}, {
  3.733852815567572*^9, 3.733852824663765*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"6", " ", "Q1", " ", 
    RowBox[{"(", 
     RowBox[{"q1", "-", "q2"}], ")"}], " ", 
    SuperscriptBox["Q2", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "m"}], " ", "Q1", " ", 
     RowBox[{"(", 
      RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "+", 
       RowBox[{"2", " ", "q3"}]}], ")"}]}], "+", 
    RowBox[{"k2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q1", " ", "Q1", " ", "q2"}], "-", 
       RowBox[{"Q1", " ", 
        SuperscriptBox["q2", "2"]}], "+", 
       RowBox[{"2", " ", "q1", " ", "Q1", " ", "q3"}], "-", 
       RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3"}]}], ")"}]}], "+", 
    RowBox[{"c", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           SuperscriptBox["q1", "2"]}], "+", 
          RowBox[{"6", " ", "q1", " ", "Q1"}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["Q1", "2"]}], "+", 
          RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
          SuperscriptBox["q2", "2"], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["Q2", "2"]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", "q3"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
        SuperscriptBox["q3", "2"]}]}], ")"}]}], "-", 
    RowBox[{"3", " ", "q1", " ", "q2", " ", "Q2", " ", "r1"}], "+", 
    RowBox[{"2", " ", "q1", " ", "Q1", " ", "q2", " ", "r2"}], "+", 
    RowBox[{"Q1", " ", 
     SuperscriptBox["q2", "2"], " ", "r2"}], "-", 
    RowBox[{"2", " ", "q1", " ", "Q1", " ", "q3", " ", "r2"}], "+", 
    RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3", " ", "r2"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "Q1", " ", "q2"}], "+", 
       RowBox[{"Q1", " ", 
        SuperscriptBox["q2", "2"]}], "-", 
       RowBox[{"2", " ", "q1", " ", "Q1", " ", "q3"}], "+", 
       RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3"}]}], ")"}], " ", "r2"}], 
    "+", 
    RowBox[{"2", " ", "Q1", " ", 
     RowBox[{"(", 
      RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{"q2", "+", 
       RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.672502303077362*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"%24", "\[Equal]", "0"}], "&&", 
     RowBox[{"%25", "\[Equal]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r1", ",", "r2"}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"%24", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "r1"], "U1"}]}], ",", " ", 
    RowBox[{"%25", ":", " ", 
     RowBox[{
      SubscriptBox["\[PartialD]", "r2"], "U2"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.672502310197101*^9, 3.672502331806472*^9}, {
  3.7338528360804243`*^9, 3.733852843968286*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"r1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"k1", " ", 
                SuperscriptBox["q1", "2"]}], 
               RowBox[{"2", " ", 
                SuperscriptBox["Q1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"q1", "-", "q2"}], ")"}]}]]}], "+", 
             FractionBox[
              RowBox[{"m", " ", "q1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
              RowBox[{"2", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q2"}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{"c", " ", "q1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "q1"}], "+", "Q1", "+", "q2", "-", "Q2"}], 
                ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "q1"}], "+", "Q1", "-", "q2", "+", "Q2"}], 
                ")"}]}], 
              RowBox[{"2", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q2"}], ")"}]}]]}], ")"}]}], " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"q1", " ", "q2"}], 
             RowBox[{"3", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "q2"}], ")"}], " ", 
              SuperscriptBox["Q2", "2"]}]], "+", 
            FractionBox[
             SuperscriptBox["q2", "2"], 
             RowBox[{"6", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "q2"}], ")"}], " ", 
              SuperscriptBox["Q2", "2"]}]], "-", 
            FractionBox[
             RowBox[{"q1", " ", "q3"}], 
             RowBox[{"3", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "q2"}], ")"}], " ", 
              SuperscriptBox["Q2", "2"]}]], "+", 
            FractionBox[
             RowBox[{"q2", " ", "q3"}], 
             RowBox[{"3", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "q2"}], ")"}], " ", 
              SuperscriptBox["Q2", "2"]}]], "+", 
            FractionBox[
             RowBox[{
              RowBox[{"2", " ", "q1", " ", "Q1", " ", "q2"}], "+", 
              RowBox[{"Q1", " ", 
               SuperscriptBox["q2", "2"]}], "-", 
              RowBox[{"2", " ", "q1", " ", "Q1", " ", "q3"}], "+", 
              RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3"}]}], 
             RowBox[{"6", " ", "Q1", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "q2"}], ")"}], " ", 
              SuperscriptBox["Q2", "2"]}]]}], ")"}]}], "-", 
         FractionBox[
          RowBox[{"q1", " ", "q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{"q2", "+", 
                  RowBox[{"2", " ", "q3"}]}], ")"}]}], 
               RowBox[{"6", " ", "Q2"}]]}], "+", 
             FractionBox[
              RowBox[{"k2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "q1", " ", "Q1", " ", "q2"}], "-", 
                 
                 RowBox[{"Q1", " ", 
                  SuperscriptBox["q2", "2"]}], "+", 
                 RowBox[{"2", " ", "q1", " ", "Q1", " ", "q3"}], "-", 
                 RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3"}]}], ")"}]}], 
              RowBox[{"6", " ", "Q1", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q2"}], ")"}], " ", 
               SuperscriptBox["Q2", "2"]}]], "+", 
             FractionBox[
              RowBox[{"c", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"q2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "3"}], " ", 
                    SuperscriptBox["q1", "2"]}], "+", 
                    RowBox[{"6", " ", "q1", " ", "Q1"}], "-", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q1", "2"]}], "+", 
                    RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
                    SuperscriptBox["q2", "2"], "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}],
                     "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["Q2", "2"]}]}], ")"}]}], "+", 
                 RowBox[{"4", " ", 
                  RowBox[{"(", 
                   RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", "q3"}], 
                 "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
                  SuperscriptBox["q3", "2"]}]}], ")"}]}], 
              RowBox[{"6", " ", 
               RowBox[{"(", 
                RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"q2", "+", 
                 RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}], 
              RowBox[{"3", " ", "Q2"}]]}], ")"}]}], 
          RowBox[{"2", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", 
            SuperscriptBox["q1", "3"], " ", "q2"}], 
           RowBox[{"3", " ", 
            SuperscriptBox["Q1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"q1", "-", "q2"}], ")"}], "2"], " ", 
            SuperscriptBox["Q2", "2"]}]]}], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["q1", "2"], " ", 
           SuperscriptBox["q2", "2"]}], 
          RowBox[{"12", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q1", "-", "q2"}], ")"}], "2"], " ", 
           SuperscriptBox["Q2", "2"]}]], "+", 
         FractionBox[
          RowBox[{"2", " ", 
           SuperscriptBox["q1", "3"], " ", "q3"}], 
          RowBox[{"3", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q1", "-", "q2"}], ")"}], "2"], " ", 
           SuperscriptBox["Q2", "2"]}]], "-", 
         FractionBox[
          RowBox[{"2", " ", 
           SuperscriptBox["q1", "2"], " ", "q2", " ", "q3"}], 
          RowBox[{"3", " ", 
           SuperscriptBox["Q1", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"q1", "-", "q2"}], ")"}], "2"], " ", 
           SuperscriptBox["Q2", "2"]}]]}], ")"}]}]}]}], ",", 
    RowBox[{"r2", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"Q1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"8", " ", "q1", " ", "q2"}], "+", 
           SuperscriptBox["q2", "2"], "-", 
           RowBox[{"8", " ", "q1", " ", "q3"}], "+", 
           RowBox[{"8", " ", "q2", " ", "q3"}]}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", "k2", " ", "q1", " ", "Q1", " ", "q2"}], 
         "-", 
         RowBox[{"2", " ", "k2", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"]}], "-", 
         RowBox[{"3", " ", "k1", " ", "q1", " ", "q2", " ", "Q2"}], "-", 
         RowBox[{"5", " ", "m", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2"}], 
         "-", 
         RowBox[{"3", " ", "c", " ", 
          SuperscriptBox["q1", "2"], " ", "Q1", " ", "q2", " ", "Q2"}], "+", 
         RowBox[{"6", " ", "c", " ", "q1", " ", 
          SuperscriptBox["Q1", "2"], " ", "q2", " ", "Q2"}], "-", 
         RowBox[{"3", " ", "c", " ", 
          SuperscriptBox["Q1", "3"], " ", "q2", " ", "Q2"}], "+", 
         RowBox[{"5", " ", "m", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
         RowBox[{"4", " ", "c", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2"}], "-", 
         RowBox[{"c", " ", "Q1", " ", 
          SuperscriptBox["q2", "3"], " ", "Q2"}], "-", 
         RowBox[{"8", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"]}], "+", 
         RowBox[{"2", " ", "c", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["Q2", "2"]}], "+", 
         RowBox[{"3", " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "3"]}], "+", 
         RowBox[{"4", " ", "k2", " ", "q1", " ", "Q1", " ", "q3"}], "-", 
         RowBox[{"4", " ", "k2", " ", "Q1", " ", "q2", " ", "q3"}], "-", 
         RowBox[{"4", " ", "m", " ", "q1", " ", "Q1", " ", "Q2", " ", "q3"}], 
         "+", 
         RowBox[{"4", " ", "m", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3"}], 
         "+", 
         RowBox[{"8", " ", "c", " ", "q1", " ", "Q1", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "-", 
         RowBox[{"8", " ", "c", " ", "Q1", " ", "q2", " ", 
          SuperscriptBox["Q2", "2"], " ", "q3"}], "-", 
         RowBox[{"4", " ", "c", " ", "q1", " ", "Q1", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"4", " ", "c", " ", "Q1", " ", "q2", " ", "Q2", " ", 
          SuperscriptBox["q3", "2"]}], "+", 
         RowBox[{"4", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2", " ", "x"}], 
         "-", 
         RowBox[{"4", " ", "Q1", " ", 
          SuperscriptBox["q2", "2"], " ", "Q2", " ", "x"}], "+", 
         RowBox[{"8", " ", "q1", " ", "Q1", " ", "Q2", " ", "q3", " ", "x"}], 
         "-", 
         RowBox[{
         "8", " ", "Q1", " ", "q2", " ", "Q2", " ", "q3", " ", "x"}]}], 
        ")"}]}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.672502373370845*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%27", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"q1", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "q1", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "+", 
         RowBox[{"8", " ", "q3"}]}], ")"}]}]}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"k2", " ", "Q1", " ", "q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "k1", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "q1", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "+", 
             RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", 
                 SuperscriptBox["q1", "3"]}], "+", 
                RowBox[{
                 SuperscriptBox["q1", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"8", " ", "Q1"}], "+", "q2"}], ")"}]}], "+", 
                RowBox[{"q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q1", "2"], "+", 
                   SuperscriptBox["q2", "2"], "-", 
                   RowBox[{"2", " ", "q2", " ", "Q2"}], "-", 
                   SuperscriptBox["Q2", "2"]}], ")"}]}], "+", 
                RowBox[{"2", " ", "q1", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    SuperscriptBox["Q1", "2"]}], "-", 
                   RowBox[{"Q1", " ", "q2"}], "+", 
                   SuperscriptBox["q2", "2"], "-", 
                   RowBox[{"2", " ", "q2", " ", "Q2"}], "+", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["Q2", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "q2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"q1", "-", "Q1"}], ")"}], "2"], "-", 
                SuperscriptBox["q2", "2"], "+", 
                RowBox[{"q2", " ", "Q2"}], "-", 
                SuperscriptBox["Q2", "2"]}], ")"}], " ", "q3"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "q2"}], ")"}], " ", "q2", " ", 
              SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
          RowBox[{"m", " ", 
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "q1", " ", 
              RowBox[{"(", 
               RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
             RowBox[{"3", " ", "q2", " ", 
              RowBox[{"(", 
               RowBox[{"q2", "+", 
                RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}], " ", "q2", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "+", 
             RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6725023944239483`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%29", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "q1", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "+", 
         RowBox[{"8", " ", "q3"}]}], ")"}]}]}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "k2", " ", "Q1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "k1", " ", "q1", " ", "q2"}], "+", 
       RowBox[{"Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m", " ", 
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"5", " ", "q2"}], "+", 
             RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              SuperscriptBox["q1", "2"], " ", "q2"}], "+", 
             RowBox[{"q1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "6"}], " ", "Q1", " ", "q2"}], "-", 
                RowBox[{"4", " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", "q3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", 
                   RowBox[{"2", " ", "Q2"}], "+", "q3"}], ")"}]}]}], ")"}]}], 
             "+", 
             RowBox[{"q2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", " ", 
                 SuperscriptBox["Q1", "2"]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"q2", "+", "Q2", "-", 
                   RowBox[{"2", " ", "q3"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"q2", "-", 
                   RowBox[{"3", " ", "Q2"}], "+", 
                   RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
          "-", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "+", 
             RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.672502411830923*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Finding the equations for price constraints\
\>", "Subtitle",
 CellChangeTimes->{{3.733852865705515*^9, 3.733852868585143*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%24", "\[Equal]", "0"}], ",", "r1"}], "]"}]], "Input",
 CellChangeTimes->{{3.6725032400110493`*^9, 3.672503246431888*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["Q1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"q1", "-", "q2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"k1", " ", 
          SuperscriptBox["q1", "2"]}], 
         RowBox[{"2", " ", 
          SuperscriptBox["Q1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q2"}], ")"}]}]], "-", 
        FractionBox[
         RowBox[{"m", " ", "q1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
         RowBox[{"2", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q2"}], ")"}]}]], "-", 
        FractionBox[
         RowBox[{"c", " ", "q1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "q1"}], "+", "Q1", "+", "q2", "-", "Q2"}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "q1"}], "+", "Q1", "-", "q2", "+", "Q2"}], ")"}]}], 
         RowBox[{"2", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q2"}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{"q1", " ", "q2", " ", "r2"}], 
         RowBox[{"2", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]]}], ")"}]}], 
     SuperscriptBox["q1", "2"]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6725032755851517`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  FractionBox[
   RowBox[{
    SuperscriptBox["Q1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"q1", "-", "q2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"k1", " ", 
        SuperscriptBox["q1", "2"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Q1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"m", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q1"}], "+", "q2"}], ")"}]}], 
       RowBox[{"2", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{"c", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q1"}], "+", "Q1", "+", "q2", "-", "Q2"}], ")"}], " ", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "q1"}], "+", "Q1", "-", "q2", "+", "Q2"}], ")"}]}], 
       RowBox[{"2", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{"q1", " ", "q2", " ", "r2"}], 
       RowBox[{"2", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]]}], ")"}]}], 
   SuperscriptBox["q1", "2"]], "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"k1", " ", "q1", " ", "Q2"}], "+", 
   RowBox[{"Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}], "-", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"q1", "-", "Q1", "+", "q2", "-", "Q2"}], ")"}], " ", "Q2", 
       " ", 
       RowBox[{"(", 
        RowBox[{"q1", "-", "Q1", "-", "q2", "+", "Q2"}], ")"}]}], "+", 
      RowBox[{"q2", " ", "r2"}]}], ")"}]}]}], 
  RowBox[{"2", " ", "q1", " ", "Q2"}]]], "Output",
 CellChangeTimes->{3.672503286067873*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q2", "*", 
    RowBox[{"r2", "/", "Q2"}]}], "+", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q2"}], ")"}], "^", "2"}]}], "-", 
   RowBox[{"q2", "*", 
    RowBox[{"r1", "/", "Q1"}]}], "-", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q2", "-", "Q1"}], ")"}], "^", "2"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{"r1", "->", 
    FractionBox[
     RowBox[{
      RowBox[{"k1", " ", "q1", " ", "Q2"}], "+", 
      RowBox[{"Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "Q1", "+", "q2", "-", "Q2"}], ")"}], " ", "Q2", 
          " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "Q1", "-", "q2", "+", "Q2"}], ")"}]}], "+", 
         RowBox[{"q2", " ", "r2"}]}], ")"}]}]}], 
     RowBox[{"2", " ", "q1", " ", "Q2"}]]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.672503315202937*^9, 3.6725033272070436`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "c"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Q1"}], "+", "q2"}], ")"}], "2"]}], "+", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q2", "-", "Q2"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q2", " ", "r2"}], "Q2"], "-", 
  FractionBox[
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k1", " ", "q1", " ", "Q2"}], "+", 
      RowBox[{"Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}], "-", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "Q1", "+", "q2", "-", "Q2"}], ")"}], " ", "Q2", 
          " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "Q1", "-", "q2", "+", "Q2"}], ")"}]}], "+", 
         RowBox[{"q2", " ", "r2"}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"2", " ", "q1", " ", "Q1", " ", "Q2"}]]}]], "Output",
 CellChangeTimes->{3.672503329408822*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%34", "\[Equal]", "0"}], ",", "r2"}], "]"}]], "Input",
 CellChangeTimes->{{3.672503335599229*^9, 3.672503343775633*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"Q1", " ", "q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "q1"}], "+", "q2"}], ")"}]}]], 
     RowBox[{"Q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "c", " ", "q1", " ", 
         SuperscriptBox["Q1", "3"]}], "-", 
        RowBox[{"k1", " ", "q1", " ", "q2"}], "-", 
        RowBox[{"m", " ", "q1", " ", "Q1", " ", "q2"}], "+", 
        RowBox[{"c", " ", 
         SuperscriptBox["q1", "2"], " ", "Q1", " ", "q2"}], "+", 
        RowBox[{"2", " ", "c", " ", "q1", " ", 
         SuperscriptBox["Q1", "2"], " ", "q2"}], "+", 
        RowBox[{"c", " ", 
         SuperscriptBox["Q1", "3"], " ", "q2"}], "+", 
        RowBox[{"m", " ", "Q1", " ", 
         SuperscriptBox["q2", "2"]}], "-", 
        RowBox[{"c", " ", "Q1", " ", 
         SuperscriptBox["q2", "3"]}], "-", 
        RowBox[{"4", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2"}], 
        "+", 
        RowBox[{"2", " ", "c", " ", "Q1", " ", 
         SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
        RowBox[{"2", " ", "c", " ", "q1", " ", "Q1", " ", 
         SuperscriptBox["Q2", "2"]}], "-", 
        RowBox[{"c", " ", "Q1", " ", "q2", " ", 
         SuperscriptBox["Q2", "2"]}]}], ")"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.67250334507202*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"Q1", " ", "q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q1"}], "+", "q2"}], ")"}]}]], 
   RowBox[{"Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "c", " ", "q1", " ", 
       SuperscriptBox["Q1", "3"]}], "-", 
      RowBox[{"k1", " ", "q1", " ", "q2"}], "-", 
      RowBox[{"m", " ", "q1", " ", "Q1", " ", "q2"}], "+", 
      RowBox[{"c", " ", 
       SuperscriptBox["q1", "2"], " ", "Q1", " ", "q2"}], "+", 
      RowBox[{"2", " ", "c", " ", "q1", " ", 
       SuperscriptBox["Q1", "2"], " ", "q2"}], "+", 
      RowBox[{"c", " ", 
       SuperscriptBox["Q1", "3"], " ", "q2"}], "+", 
      RowBox[{"m", " ", "Q1", " ", 
       SuperscriptBox["q2", "2"]}], "-", 
      RowBox[{"c", " ", "Q1", " ", 
       SuperscriptBox["q2", "3"]}], "-", 
      RowBox[{"4", " ", "c", " ", "q1", " ", "Q1", " ", "q2", " ", "Q2"}], 
      "+", 
      RowBox[{"2", " ", "c", " ", "Q1", " ", 
       SuperscriptBox["q2", "2"], " ", "Q2"}], "+", 
      RowBox[{"2", " ", "c", " ", "q1", " ", "Q1", " ", 
       SuperscriptBox["Q2", "2"]}], "-", 
      RowBox[{"c", " ", "Q1", " ", "q2", " ", 
       SuperscriptBox["Q2", "2"]}]}], ")"}]}]}], "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{"Q2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q1"}], " ", 
         RowBox[{"(", 
          RowBox[{"k1", "+", 
           RowBox[{"m", " ", "Q1"}]}], ")"}]}], "+", 
        RowBox[{"m", " ", "Q1", " ", "q2"}]}], ")"}]}], "+", 
     RowBox[{"c", " ", "Q1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q1", "2"], " ", "q2"}], "+", 
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{"Q1", "+", "q2", "-", "Q2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"Q1", "-", "q2", "+", "Q2"}], ")"}]}], "+", 
        RowBox[{"2", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["Q1", "2"]}], "+", 
           RowBox[{"Q1", " ", "q2"}], "-", 
           RowBox[{"2", " ", "q2", " ", "Q2"}], "+", 
           SuperscriptBox["Q2", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"Q1", " ", "q2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "q1"}], "+", "q2"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.672503355249673*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%25", "\[Equal]", "0"}], ",", "r2"}], "]"}]], "Input",
 CellChangeTimes->{{3.6725033842865973`*^9, 3.672503400016947*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r2", "\[Rule]", 
    FractionBox[
     RowBox[{
      FractionBox[
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}], 
       RowBox[{"6", " ", "Q2"}]], "-", 
      FractionBox[
       RowBox[{"k2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "q1", " ", "Q1", " ", "q2"}], "-", 
          RowBox[{"Q1", " ", 
           SuperscriptBox["q2", "2"]}], "+", 
          RowBox[{"2", " ", "q1", " ", "Q1", " ", "q3"}], "-", 
          RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3"}]}], ")"}]}], 
       RowBox[{"6", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        SuperscriptBox["Q2", "2"]}]], "-", 
      FractionBox[
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", 
              SuperscriptBox["q1", "2"]}], "+", 
             RowBox[{"6", " ", "q1", " ", "Q1"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["Q1", "2"]}], "+", 
             RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
             SuperscriptBox["q2", "2"], "-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], 
             "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["Q2", "2"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2", " ", "q3"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
           SuperscriptBox["q3", "2"]}]}], ")"}]}], 
       RowBox[{"6", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], "+", 
      FractionBox[
       RowBox[{"q1", " ", "q2", " ", "r1"}], 
       RowBox[{"2", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", "Q2"}]], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}], 
       RowBox[{"3", " ", "Q2"}]]}], 
     RowBox[{
      FractionBox[
       RowBox[{"q1", " ", "q2"}], 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        SuperscriptBox["Q2", "2"]}]], "+", 
      FractionBox[
       SuperscriptBox["q2", "2"], 
       RowBox[{"6", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        SuperscriptBox["Q2", "2"]}]], "-", 
      FractionBox[
       RowBox[{"q1", " ", "q3"}], 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        SuperscriptBox["Q2", "2"]}]], "+", 
      FractionBox[
       RowBox[{"q2", " ", "q3"}], 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        SuperscriptBox["Q2", "2"]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "q1", " ", "Q1", " ", "q2"}], "+", 
        RowBox[{"Q1", " ", 
         SuperscriptBox["q2", "2"]}], "-", 
        RowBox[{"2", " ", "q1", " ", "Q1", " ", "q3"}], "+", 
        RowBox[{"2", " ", "Q1", " ", "q2", " ", "q3"}]}], 
       RowBox[{"6", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        SuperscriptBox["Q2", "2"]}]]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.672503402354505*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%39", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "Q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "q1", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "+", 
         RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"k2", " ", "Q1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}], "+", 
       RowBox[{"c", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "q2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", 
              SuperscriptBox["q1", "2"]}], "+", 
             RowBox[{"6", " ", "q1", " ", "Q1"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["Q1", "2"]}], "+", 
             RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
             SuperscriptBox["q2", "2"], "-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], 
             "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["Q2", "2"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", "q3"}], 
          "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}], " ", 
           SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
       RowBox[{"3", " ", "q1", " ", "q2", " ", "r1"}], "-", 
       RowBox[{"2", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{"q1", "-", "q2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.67250341377887*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q1", "*", 
    RowBox[{"r1", "/", "Q1"}]}], "+", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q1"}], ")"}], "^", "2"}]}], "-", 
   RowBox[{"q1", "*", 
    RowBox[{"r2", "/", "Q2"}]}], "-", 
   RowBox[{"c", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q1", "-", "Q2"}], ")"}], "^", "2"}]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{"r2", "->", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", "Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "q1", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
         RowBox[{"q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "+", 
            RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k2", " ", "Q1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "q1", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
          RowBox[{"q2", " ", 
           RowBox[{"(", 
            RowBox[{"q2", "+", 
             RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"Q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "+", 
             RowBox[{"2", " ", "q3"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "q2"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "3"}], " ", 
                 SuperscriptBox["q1", "2"]}], "+", 
                RowBox[{"6", " ", "q1", " ", "Q1"}], "-", 
                RowBox[{"3", " ", 
                 SuperscriptBox["Q1", "2"]}], "+", 
                RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
                SuperscriptBox["q2", "2"], "-", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], 
                "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["Q2", "2"]}]}], ")"}]}], "+", 
             RowBox[{"4", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
              "q3"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"q1", "-", "q2"}], ")"}], " ", 
              SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
          RowBox[{"3", " ", "q1", " ", "q2", " ", "r1"}], "-", 
          RowBox[{"2", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{"q1", "-", "q2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"q2", "+", 
             RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}]}], ")"}]}]}], 
      ")"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.672503431502714*^9, 3.672503444451193*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q1", "-", "Q2"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q1", " ", "r1"}], "Q1"], "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]], 
   RowBox[{"q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k2", " ", "Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "q1", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
         RowBox[{"q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "+", 
            RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"q2", "+", 
            RowBox[{"2", " ", "q3"}]}], ")"}]}], "+", 
         RowBox[{"c", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", 
                SuperscriptBox["q1", "2"]}], "+", 
               RowBox[{"6", " ", "q1", " ", "Q1"}], "-", 
               RowBox[{"3", " ", 
                SuperscriptBox["Q1", "2"]}], "+", 
               RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
               SuperscriptBox["q2", "2"], "-", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], 
               "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["Q2", "2"]}]}], ")"}]}], "+", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
             "q3"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"q1", "-", "q2"}], ")"}], " ", 
             SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
         RowBox[{"3", " ", "q1", " ", "q2", " ", "r1"}], "-", 
         RowBox[{"2", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"q2", "+", 
            RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.672503447392723*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%41", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q1", "-", "Q2"}], ")"}], "2"]}], "+", 
  FractionBox[
   RowBox[{"q1", " ", "r1"}], "Q1"], "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "Q1", " ", "Q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{"q2", "+", 
          RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]], 
   RowBox[{"q1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k2", " ", "Q1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "q1", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
         RowBox[{"q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "+", 
            RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"Q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"q2", "+", 
            RowBox[{"2", " ", "q3"}]}], ")"}]}], "+", 
         RowBox[{"c", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", 
                SuperscriptBox["q1", "2"]}], "+", 
               RowBox[{"6", " ", "q1", " ", "Q1"}], "-", 
               RowBox[{"3", " ", 
                SuperscriptBox["Q1", "2"]}], "+", 
               RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
               SuperscriptBox["q2", "2"], "-", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], 
               "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["Q2", "2"]}]}], ")"}]}], "+", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", 
             "q3"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"q1", "-", "q2"}], ")"}], " ", 
             SuperscriptBox["q3", "2"]}]}], ")"}]}], "+", 
         RowBox[{"3", " ", "q1", " ", "q2", " ", "r1"}], "-", 
         RowBox[{"2", " ", "Q1", " ", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"q2", "+", 
            RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.6725034535438766`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%42", "\[Equal]", "0"}], ",", "r1"}], "]"}]], "Input",
 CellChangeTimes->{{3.6725034565170507`*^9, 3.672503465227009*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r1", "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       FractionBox["q1", "Q1"], "-", 
       FractionBox[
        RowBox[{"3", " ", 
         SuperscriptBox["q1", "2"], " ", "q2"}], 
        RowBox[{"2", " ", "Q1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "+", 
              RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], "+", 
       RowBox[{"c", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"q1", "-", "Q2"}], ")"}], "2"]}], "+", 
       FractionBox[
        RowBox[{"k2", " ", "q1"}], 
        RowBox[{"2", " ", "Q2"}]], "+", 
       FractionBox[
        RowBox[{"m", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{"q1", "-", "q2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "+", 
           RowBox[{"2", " ", "q3"}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "+", 
              RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"c", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "q2"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", 
               SuperscriptBox["q1", "2"]}], "+", 
              RowBox[{"6", " ", "q1", " ", "Q1"}], "-", 
              RowBox[{"3", " ", 
               SuperscriptBox["Q1", "2"]}], "+", 
              RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
              SuperscriptBox["q2", "2"], "-", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], 
              "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["Q2", "2"]}]}], ")"}]}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", "q3"}],
            "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"q1", "-", "q2"}], ")"}], " ", 
            SuperscriptBox["q3", "2"]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{"q2", "+", 
              RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{"q1", " ", 
         RowBox[{"(", 
          RowBox[{"q1", "-", "q2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "+", 
           RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}], 
        RowBox[{
         RowBox[{"2", " ", "q1", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
         RowBox[{"q2", " ", 
          RowBox[{"(", 
           RowBox[{"q2", "+", 
            RowBox[{"2", " ", "q3"}]}], ")"}]}]}]]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.672503468702965*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    FractionBox["q1", "Q1"], "-", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["q1", "2"], " ", "q2"}], 
     RowBox[{"2", " ", "Q1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "+", 
           RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "c"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], "+", 
    RowBox[{"c", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"q1", "-", "Q2"}], ")"}], "2"]}], "+", 
    FractionBox[
     RowBox[{"k2", " ", "q1"}], 
     RowBox[{"2", " ", "Q2"}]], "+", 
    FractionBox[
     RowBox[{"m", " ", "q1", " ", 
      RowBox[{"(", 
       RowBox[{"q1", "-", "q2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"q2", "+", 
        RowBox[{"2", " ", "q3"}]}], ")"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "+", 
           RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"c", " ", "q1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", 
            SuperscriptBox["q1", "2"]}], "+", 
           RowBox[{"6", " ", "q1", " ", "Q1"}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["Q1", "2"]}], "+", 
           RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
           SuperscriptBox["q2", "2"], "-", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], "+", 
           
           RowBox[{"3", " ", 
            SuperscriptBox["Q2", "2"]}]}], ")"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", "q3"}], 
        "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"q1", "-", "q2"}], ")"}], " ", 
         SuperscriptBox["q3", "2"]}]}], ")"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "+", 
           RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"q1", " ", 
      RowBox[{"(", 
       RowBox[{"q1", "-", "q2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"q2", "+", 
        RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}], 
     RowBox[{
      RowBox[{"2", " ", "q1", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "+", 
         RowBox[{"2", " ", "q3"}]}], ")"}]}]}]]}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    FractionBox["q1", "Q1"], "-", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["q1", "2"], " ", "q2"}], 
     RowBox[{"2", " ", "Q1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "+", 
           RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "c"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"q1", "-", "Q1"}], ")"}], "2"]}], "+", 
    RowBox[{"c", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"q1", "-", "Q2"}], ")"}], "2"]}], "+", 
    FractionBox[
     RowBox[{"k2", " ", "q1"}], 
     RowBox[{"2", " ", "Q2"}]], "+", 
    FractionBox[
     RowBox[{"m", " ", "q1", " ", 
      RowBox[{"(", 
       RowBox[{"q1", "-", "q2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"q2", "+", 
        RowBox[{"2", " ", "q3"}]}], ")"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "+", 
           RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"c", " ", "q1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", 
            SuperscriptBox["q1", "2"]}], "+", 
           RowBox[{"6", " ", "q1", " ", "Q1"}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["Q1", "2"]}], "+", 
           RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
           SuperscriptBox["q2", "2"], "-", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "q1"}], "+", "q2"}], ")"}], " ", "Q2"}], "+", 
           
           RowBox[{"3", " ", 
            SuperscriptBox["Q2", "2"]}]}], ")"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", "Q2", " ", "q3"}], 
        "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"q1", "-", "q2"}], ")"}], " ", 
         SuperscriptBox["q3", "2"]}]}], ")"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "+", 
           RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"q1", " ", 
      RowBox[{"(", 
       RowBox[{"q1", "-", "q2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"q2", "+", 
        RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}], 
     RowBox[{
      RowBox[{"2", " ", "q1", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "+", 
         RowBox[{"2", " ", "q3"}]}], ")"}]}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6725034830220757`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%44", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"q1", " ", "Q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q1", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "-", 
         RowBox[{"4", " ", "q3"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "q2", " ", 
       RowBox[{"(", 
        RowBox[{"q2", "+", 
         RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}]], 
  RowBox[{"Q1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"k2", " ", "q1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "-", "q3"}], ")"}]}], "+", 
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{"q2", "+", 
           RowBox[{"2", " ", "q3"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"Q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{"q1", "-", "q2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "+", 
           RowBox[{"2", " ", "q3"}]}], ")"}]}], "+", 
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", 
               SuperscriptBox["q1", "3"]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["q1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"Q1", "-", "q2", "-", 
                 RowBox[{"2", " ", "Q2"}]}], ")"}]}], "-", 
              RowBox[{"q1", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Q1", "2"], "-", 
                 RowBox[{"4", " ", "Q1", " ", "q2"}], "+", 
                 SuperscriptBox["q2", "2"], "+", 
                 RowBox[{"2", " ", "q2", " ", "Q2"}], "-", 
                 SuperscriptBox["Q2", "2"]}], ")"}]}], "+", 
              RowBox[{"2", " ", "q2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  SuperscriptBox["Q1", "2"]}], "+", 
                 SuperscriptBox["Q2", "2"]}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q1"}], "+", "q2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "q1", " ", "Q1"}], "-", 
              SuperscriptBox["Q1", "2"], "-", 
              RowBox[{"q1", " ", "Q2"}], "+", 
              SuperscriptBox["Q2", "2"]}], ")"}], " ", "q3"}], "+", 
           RowBox[{"2", " ", "q1", " ", 
            RowBox[{"(", 
             RowBox[{"q1", "-", "q2"}], ")"}], " ", 
            SuperscriptBox["q3", "2"]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", "q1", " ", 
         RowBox[{"(", 
          RowBox[{"q1", "-", "q2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q2", "+", 
           RowBox[{"2", " ", "q3"}]}], ")"}], " ", "x"}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.672503487439535*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 962},
WindowMargins->{{Automatic, -10}, {-10, Automatic}},
FrontEndVersion->"10.4 for Linux x86 (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 537, 13, 77, "Text"],
Cell[CellGroupData[{
Cell[1119, 37, 154, 5, 58, "Input"],
Cell[1276, 44, 223, 8, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1536, 57, 230, 8, 58, "Input"],
Cell[1769, 67, 341, 13, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2147, 85, 159, 5, 58, "Input"],
Cell[2309, 92, 227, 8, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2573, 105, 303, 9, 32, "Input"],
Cell[2879, 116, 900, 34, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3816, 155, 303, 9, 32, "Input"],
Cell[4122, 166, 1307, 49, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5466, 220, 303, 9, 32, "Input"],
Cell[5772, 231, 940, 35, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6749, 271, 148, 4, 34, "Input"],
Cell[6900, 277, 1059, 40, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7996, 322, 1115, 42, 62, "Input"],
Cell[9114, 366, 762, 23, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9913, 394, 148, 4, 34, "Input"],
Cell[10064, 400, 1646, 63, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11747, 468, 87, 2, 32, "Input"],
Cell[11837, 472, 1877, 58, 104, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13751, 535, 89, 2, 34, "Input"],
Cell[13843, 539, 666, 25, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14546, 569, 704, 27, 62, "Input"],
Cell[15253, 598, 628, 18, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15918, 621, 793, 23, 34, "Input"],
Cell[16714, 646, 9425, 244, 471, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26176, 895, 88, 2, 32, "Input"],
Cell[26267, 899, 1091, 30, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27395, 934, 882, 23, 62, "Input"],
Cell[28280, 959, 745, 21, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29062, 985, 927, 23, 62, "Input"],
Cell[29992, 1010, 756, 21, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30785, 1036, 3259, 86, 242, "Input"],
Cell[34047, 1124, 2764, 73, 163, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36848, 1202, 88, 2, 32, "Input"],
Cell[36939, 1206, 1784, 52, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38760, 1263, 3410, 91, 242, "Input"],
Cell[42173, 1356, 6956, 169, 455, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49166, 1530, 88, 2, 32, "Input"],
Cell[49257, 1534, 4499, 118, 156, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53793, 1657, 317, 7, 32, "Input"],
Cell[54113, 1666, 1074, 33, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55224, 1704, 315, 7, 32, "Input"],
Cell[55542, 1713, 2734, 74, 106, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58313, 1792, 617, 18, 32, "Input"],
Cell[58933, 1812, 10260, 251, 405, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69230, 2068, 88, 2, 32, "Input"],
Cell[69321, 2072, 3953, 107, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73311, 2184, 88, 2, 32, "Input"],
Cell[73402, 2188, 2640, 77, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76079, 2270, 138, 4, 81, "Subtitle"],
Cell[CellGroupData[{
Cell[76242, 2278, 183, 4, 32, "Input"],
Cell[76428, 2284, 1504, 44, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77969, 2333, 1362, 42, 78, "Input"],
Cell[79334, 2377, 615, 18, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79986, 2400, 1118, 34, 59, "Input"],
Cell[81107, 2436, 1056, 33, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82200, 2474, 181, 4, 32, "Input"],
Cell[82384, 2480, 1469, 37, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83890, 2522, 1344, 35, 118, "Input"],
Cell[85237, 2559, 1217, 37, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86491, 2601, 183, 4, 32, "Input"],
Cell[86677, 2607, 3707, 106, 121, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90421, 2718, 88, 2, 32, "Input"],
Cell[90512, 2722, 2457, 73, 104, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93006, 2800, 3125, 89, 165, "Input"],
Cell[96134, 2891, 2919, 85, 104, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99090, 2981, 88, 2, 32, "Input"],
Cell[99181, 2985, 2921, 85, 104, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102139, 3075, 183, 4, 32, "Input"],
Cell[102325, 3081, 3733, 110, 174, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106095, 3196, 3296, 105, 201, "Input"],
Cell[109394, 3303, 3341, 106, 125, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112772, 3414, 88, 2, 32, "Input"],
Cell[112863, 3418, 3002, 84, 105, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

